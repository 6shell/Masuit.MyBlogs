(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[615],{13986:function(e,t,o){"use strict";var r=o(13719),n=o.n(r),a=o(27454),s=o.n(a),i=o(76661),l=o(57695);const c=n().create({baseURL:i.c.baseURL,timeout:i.c.timeOut});c.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=s().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),c.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&l.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return l.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:l.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:l.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:l.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:l.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:l.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:l.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:l.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:l.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:l.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:l.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=c},42634:function(){},59386:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return k}});var r=o(74061),n=o(57695),a=o(43992),s=o(13986);const i={class:"merge-edit-container"},l={class:"q-mt-md"};var c=(0,r.defineComponent)({__name:"edit",setup(e){const t=(0,r.ref)(null),o=(0,a.useRouter)(),c=(0,a.useRoute)(),u=(0,r.ref)(!1),p=(0,r.ref)({Id:"",Title:"",Content:""}),d=async()=>{u.value=!0;const e=c.query.id;if(!e)return void n.oR.error("缺少合并ID参数",{autoClose:2e3,position:"top-center"});const t=await s.A.get(`/merge/${e}`);t?.Data&&(p.value=t.Data),u.value=!1},m=async()=>{if(!p.value.Title.trim())return void n.oR.error("请输入文章标题",{autoClose:2e3,position:"top-center"});if(!p.value.Content.trim())return void n.oR.error("请输入文章内容",{autoClose:2e3,position:"top-center"});u.value=!0;const e=await s.A.post("/merge",p.value);n.oR.success(e?.Message||"合并成功",{autoClose:2e3,position:"top-center"}),o.push("/posts/merge")};(0,r.onMounted)(async()=>{await d(),document.querySelector(".q-page-container").addEventListener("scroll",C)}),(0,r.onBeforeUnmount)(()=>{v&&clearTimeout(v),document.querySelector(".q-page-container").removeEventListener("scroll",C)});let v=null,f=!1;const C=()=>{v&&clearTimeout(v),v=setTimeout(()=>{b()},100)},b=()=>{if(null==t.value?.$el)return;const e=t.value.$el.querySelector(".edui-editor-toolbarbox");if(e){const o=t.value.$el.getBoundingClientRect(),r=o.top<84&&o.bottom>300;if(r&&!f){const o=t.value.$el.offsetWidth;e.style.cssText=`\n          position: fixed !important;\n          top: 84px !important;\n          z-index: 1000 !important;\n          width: ${o}px !important;\n          transition: all 0.5s ease !important;\n        `,f=!0}else!r&&f&&(e.style.cssText="\n          position: static !important;\n          top: auto !important;\n          z-index: auto !important;\n          width: auto !important;\n          transition: all 0.5s ease !important;\n        ",f=!1)}};return(e,o)=>{const n=(0,r.resolveComponent)("q-input"),a=(0,r.resolveComponent)("vue-ueditor-wrap"),s=(0,r.resolveComponent)("q-btn"),c=(0,r.resolveComponent)("q-spinner"),d=(0,r.resolveComponent)("q-inner-loading");return(0,r.openBlock)(),(0,r.createElementBlock)("div",i,[o[3]||(o[3]=(0,r.createElementVNode)("div",{class:"text-h5"},"编辑并合并文章",-1)),(0,r.createVNode)(n,{modelValue:p.value.Title,"onUpdate:modelValue":o[0]||(o[0]=e=>p.value.Title=e),label:"文章标题",outlined:"",dense:"",rules:[e=>!!e||"请输入文章标题"],"lazy-rules":""},null,8,["modelValue","rules"]),(0,r.createElementVNode)("div",null,[o[2]||(o[2]=(0,r.createElementVNode)("label",{class:"text-subtitle2 q-mb-sm block"},"文章内容：",-1)),(0,r.createVNode)(a,{ref_key:"editor",ref:t,modelValue:p.value.Content,"onUpdate:modelValue":o[1]||(o[1]=e=>p.value.Content=e)},null,8,["modelValue"])]),(0,r.createElementVNode)("div",l,[(0,r.createVNode)(s,{type:"submit",color:"primary",label:"确认合并",loading:u.value,size:"lg",onClick:m},null,8,["loading"])]),(0,r.createVNode)(d,{showing:u.value},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(c,{color:"primary",size:"100px"})]),_:1},8,["showing"])])}}}),u=o(1317),p=o(38622),d=o(20407),m=o(49010),v=o(25485),f=o(66284),C=o(22110),b=o.n(C);const g=(0,u.A)(c,[["__scopeId","data-v-b2248412"]]);var k=g;b()(c,"components",{QInput:p.A,QBtn:d.A,QInnerLoading:m.A,QSpinner:v.A,QPageContainer:f.A})}}]);
(self["webpackChunk"]=self["webpackChunk"]||[]).push([[473],{253:function(){},3986:function(e,t,o){"use strict";var a=o(3719),r=o.n(a),l=o(7454),s=o.n(l),i=o(6661),n=o(7695);const c=r().create({baseURL:i.c.baseURL,timeout:i.c.timeOut});c.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=s().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),c.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&n.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return n.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:n.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:n.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:n.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:n.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:n.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:n.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:n.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:n.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:n.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:n.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=c},4916:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return T}});var a=o(4061),r=o(7695),l=o(3508),s=o.n(l),i=o(3986);const n={class:"merge-list-container"},c=["href"],d=["href"],u={class:"column q-gutter-xs"},p=["href"],m={style:{width:"400px"}},f={class:"text-h6"},w={class:"q-mt-md flex justify-center items-center"},h={class:"q-ml-sm text-caption"};var V=(0,a.defineComponent)({__name:"list",setup(e){const t=(0,a.ref)(!1),o=(0,a.ref)([]),l=(0,a.ref)(""),V=(0,a.ref)({page:1,rowsPerPage:10,total:0}),C=(0,a.ref)(null),g=e=>s()(e).format("YYYY-MM-DD HH:mm:ss"),v=e=>{const t={0:"warning",1:"positive",2:"negative",3:"negative"};return t[e]||"grey"},N=e=>{const t={0:"待合并",1:"已合并",2:"已拒绝",3:"已被标记为恶意修改"};return t[e]||"未知"},x=async()=>{t.value=!0;const e={page:V.value.page,size:V.value.rowsPerPage,kw:l.value||""},a=await i.A.get("/merge",{params:e});a&&(o.value=a.Data||[],V.value.total=a.TotalCount||0),t.value=!1},b=async e=>{const t=await i.A.post(`/merge/${e.Id}`);r.oR.success(t?.Message||"合并成功",{autoClose:2e3,position:"top-center"}),await x()},k=(0,a.ref)(""),_=async e=>{const t=await i.A.post(`/merge/reject/${e.Id}`,{reason:k.value});r.oR.success(t?.Message||"已拒绝合并",{autoClose:2e3,position:"top-center"}),await x()},y=async e=>{const t=await i.A.post(`/merge/block/${e.Id}`);r.oR.success(t?.Message||"已标记为恶意修改",{autoClose:2e3,position:"top-center"}),await x()},P=async e=>{const t=await i.A.post("/system/AddToBlackList",{ip:e});r.oR.success(t?.Message||"已加入黑名单",{autoClose:2e3,position:"top-center"})};return(0,a.onMounted)(()=>{x()}),(e,r)=>{const s=(0,a.resolveComponent)("q-btn"),i=(0,a.resolveComponent)("q-input"),A=(0,a.resolveComponent)("vxe-column"),q=(0,a.resolveComponent)("router-link"),R=(0,a.resolveComponent)("q-tooltip"),E=(0,a.resolveComponent)("q-icon"),D=(0,a.resolveComponent)("q-card-section"),M=(0,a.resolveComponent)("q-card-actions"),S=(0,a.resolveComponent)("q-card"),T=(0,a.resolveComponent)("q-popup-proxy"),I=(0,a.resolveComponent)("q-chip"),z=(0,a.resolveComponent)("q-btn-group"),Q=(0,a.resolveComponent)("vxe-table"),$=(0,a.resolveComponent)("q-pagination"),B=(0,a.resolveComponent)("q-select"),O=(0,a.resolveDirective)("close-popup");return(0,a.openBlock)(),(0,a.createElementBlock)("div",n,[(0,a.createVNode)(i,{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=e=>l.value=e),outlined:"",dense:"",placeholder:"全局搜索",class:"q-mb-md"},{append:(0,a.withCtx)(()=>[(0,a.createVNode)(s,{color:"info",icon:"search",onClick:x,loading:t.value,label:"搜索"},null,8,["loading"])]),_:1},8,["modelValue"]),(0,a.createVNode)(Q,{ref_key:"tableRef",ref:C,data:o.value,loading:t.value,stripe:"",border:""},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(A,{field:"PostTitle",title:"原标题","min-width":"200",fixed:"left"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("a",{href:`/${e.PostId}`,target:"_blank",class:"text-primary"},(0,a.toDisplayString)(e.PostTitle),9,c)]),_:1}),(0,a.createVNode)(A,{field:"Title",title:"新标题","min-width":"200"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(q,{to:`/merge/compare?id=${e.Id}`,target:"_blank",class:"text-primary"},{default:(0,a.withCtx)(()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.Title),1)]),_:2},1032,["to"])]),_:1}),(0,a.createVNode)(A,{field:"Modifier",title:"修改人",width:"120"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("a",{href:`/author/${e.Modifier}`,target:"_blank",class:"text-primary"},(0,a.toDisplayString)(e.Modifier),9,d)]),_:1}),(0,a.createVNode)(A,{field:"ModifierEmail",title:"修改人邮箱",width:"180"}),(0,a.createVNode)(A,{field:"SubmitTime",title:"提交时间",width:"160"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createTextVNode)((0,a.toDisplayString)(g(e.SubmitTime)),1)]),_:1}),(0,a.createVNode)(A,{field:"IP",title:"IP",width:"200"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("div",u,[(0,a.createElementVNode)("a",{href:`/tools/ip/${e.IP}`,target:"_blank",class:"text-primary"},(0,a.toDisplayString)(e.IP),9,p),(0,a.createVNode)(s,{color:"negative",icon:"block",dense:"",flat:"",size:"sm"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(R,{class:"bg-red"},{default:(0,a.withCtx)(()=>[...r[4]||(r[4]=[(0,a.createTextVNode)("添加到黑名单",-1)])]),_:1}),(0,a.createVNode)(T,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(S,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(D,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(E,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),r[5]||(r[5]=(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("div",{class:"text-h6"},"确认操作"),(0,a.createElementVNode)("div",{class:"text-subtitle2"},"此操作将标记该用户IP为黑名单，是否继续？")],-1))]),_:1}),(0,a.createVNode)(M,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(s,{flat:"",label:"确认",color:"negative",onClick:t=>P(e.IP)},null,8,["onClick"]),[[O]]),(0,a.withDirectives)((0,a.createVNode)(s,{flat:"",label:"取消",color:"primary"},null,512),[[O]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:1}),(0,a.createVNode)(A,{field:"MergeState",title:"状态",width:"100"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(I,{color:v(e.MergeState),"text-color":"white",label:N(e.MergeState),dense:""},null,8,["color","label"])]),_:1}),(0,a.createVNode)(A,{title:"操作",width:"230",fixed:"right"},{default:(0,a.withCtx)(({row:e})=>[0===e.MergeState?((0,a.openBlock)(),(0,a.createBlock)(z,{key:0},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(s,{size:"sm",color:"info",label:"对比",dense:"",to:`/posts/merge/compare?id=${e.Id}`},null,8,["to"]),(0,a.createVNode)(s,{size:"sm",color:"positive",label:"直接合并",dense:""},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(T,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(S,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(D,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(E,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),r[6]||(r[6]=(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("div",{class:"text-h6"},"确认操作"),(0,a.createElementVNode)("div",{class:"text-subtitle2"},"此操作将直接合并该修改，是否继续？")],-1))]),_:1}),(0,a.createVNode)(M,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(s,{flat:"",label:"确认",color:"negative",onClick:t=>b(e)},null,8,["onClick"]),[[O]]),(0,a.withDirectives)((0,a.createVNode)(s,{flat:"",label:"取消",color:"primary"},null,512),[[O]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,a.createVNode)(s,{size:"sm",color:"info",label:"编辑并合并",dense:"",to:`/posts/merge/edit?id=${e.Id}`},null,8,["to"]),(0,a.createVNode)(s,{size:"sm",color:"negative",label:"拒绝",dense:""},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(T,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(S,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(D,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",m,[(0,a.createElementVNode)("div",f,[(0,a.createVNode)(E,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),r[7]||(r[7]=(0,a.createTextVNode)("拒绝合并理由：",-1))]),(0,a.createVNode)(i,{dense:"",autogrow:"",outlined:"",modelValue:k.value,"onUpdate:modelValue":r[1]||(r[1]=e=>k.value=e),placeholder:"请填写拒绝理由"},null,8,["modelValue"])])]),_:1}),(0,a.createVNode)(M,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(s,{flat:"",label:"确认",disabled:!k.value,color:"negative",onClick:t=>_(e)},null,8,["disabled","onClick"]),[[O]]),(0,a.withDirectives)((0,a.createVNode)(s,{flat:"",label:"取消",color:"primary"},null,512),[[O]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,a.createVNode)(s,{size:"sm",color:"warning",label:"标记恶意",dense:""},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(T,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(S,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(D,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(E,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),r[8]||(r[8]=(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("div",{class:"text-h6"},"确认操作"),(0,a.createElementVNode)("div",{class:"text-subtitle2"},"此操作将标记该修改为恶意修改，是否继续？")],-1))]),_:1}),(0,a.createVNode)(M,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(s,{flat:"",label:"确认",color:"negative",onClick:t=>y(e)},null,8,["onClick"]),[[O]]),(0,a.withDirectives)((0,a.createVNode)(s,{flat:"",label:"取消",color:"primary"},null,512),[[O]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(0,a.createCommentVNode)("",!0)]),_:1})]),_:1},8,["data","loading"]),(0,a.createElementVNode)("div",w,[(0,a.createVNode)($,{modelValue:V.value.page,"onUpdate:modelValue":[r[2]||(r[2]=e=>V.value.page=e),x],max:Math.ceil(V.value.total/V.value.rowsPerPage),"max-pages":6,"boundary-numbers":""},null,8,["modelValue","max"]),(0,a.createVNode)(B,{modelValue:V.value.rowsPerPage,"onUpdate:modelValue":[r[3]||(r[3]=e=>V.value.rowsPerPage=e),x],options:[10,15,20,30,50,100,200],dense:"",outlined:"",class:"q-ml-md",style:{width:"80px"}},null,8,["modelValue"]),(0,a.createElementVNode)("span",h," 共 "+(0,a.toDisplayString)(V.value.total)+" 条 ",1)])])}}}),C=o(1317),g=o(8622),v=o(407),N=o(6997),x=o(4854),b=o(3663),k=o(7180),_=o(4503),y=o(1248),P=o(7491),A=o(7877),q=o(4183),R=o(975),E=o(515),D=o(2110),M=o.n(D);const S=(0,C.A)(V,[["__scopeId","data-v-541ca20f"]]);var T=S;M()(V,"components",{QInput:g.A,QBtn:v.A,QTooltip:N.A,QPopupProxy:x.A,QCard:b.A,QCardSection:k.A,QIcon:_.A,QCardActions:y.A,QChip:P.A,QBtnGroup:A.A,QPagination:q.A,QSelect:R.A}),M()(V,"directives",{ClosePopup:E.A})}}]);
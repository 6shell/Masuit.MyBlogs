(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[383],{13986:function(e,t,o){"use strict";var r=o(13719),a=o.n(r),n=o(27454),s=o.n(n),i=o(76661),l=o(57695);const c=a().create({baseURL:i.c.baseURL,timeout:i.c.timeOut});c.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=s().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),c.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&l.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return l.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:l.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:l.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:l.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:l.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:l.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:l.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:l.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:l.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:l.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:l.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=c},42634:function(){},81930:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return g}});var r=o(74061),a=o(43992),n=o(57695),s=o(13986);const i={class:"misc-write-page"},l={class:"row q-gutter-md justify-end"};var c=(0,r.defineComponent)({__name:"write",setup(e){const t=(0,a.useRoute)(),o=(0,a.useRouter)(),c=(0,r.ref)(),u=(0,r.ref)(!1),d=(0,r.ref)({Title:"",Content:""}),p=async e=>{u.value=!0;const t=await s.A.get(`/misc/get/${e}`);t?.Success&&t.Data?d.value=t.Data:n.oR.error("获取杂项数据失败",{autoClose:2e3,position:"top-center"}),u.value=!1},m=async()=>{if(!d.value.Title||!d.value.Content)return void n.oR.error("请填写完整信息",{autoClose:2e3,position:"top-center"});u.value=!0;const e=d.value.Id?"/misc/edit":"/misc/write",t=d.value.Id?d.value:{Title:d.value.Title,Content:d.value.Content},r=await s.A.post(e,t);r?.Success?(n.oR.success(r.Message||"操作成功",{autoClose:2e3,position:"top-center"}),o.push("/misc/list")):n.oR.error(r?.Message||"操作失败",{autoClose:2e3,position:"top-center"}),u.value=!1},v=()=>{o.push("/misc/list")};(0,r.onMounted)(()=>{const e=t.query.id;e&&p(Number(e));const o=document.querySelector(".q-page-container");o&&o.addEventListener("scroll",b)}),(0,r.onUnmounted)(()=>{C&&clearTimeout(C),document.querySelector(".q-page-container").removeEventListener("scroll",b)});let C=null,f=!1;const b=()=>{C&&clearTimeout(C),C=setTimeout(()=>{R()},100)},R=()=>{if(null==c.value?.$el)return;const e=c.value.$el.querySelector(".edui-editor-toolbarbox");if(e){const t=c.value.$el.getBoundingClientRect(),o=t.top<84&&t.bottom>300;if(o&&!f){const t=c.value.$el.offsetWidth;e.style.cssText=`\n          position: fixed !important;\n          top: 84px !important;\n          z-index: 1000 !important;\n          width: ${t}px !important;\n          transition: all 0.5s ease !important;\n        `,f=!0}else!o&&f&&(e.style.cssText="\n          position: static !important;\n          top: auto !important;\n          z-index: auto !important;\n          width: auto !important;\n          transition: all 0.5s ease !important;\n        ",f=!1)}};return(e,t)=>{const o=(0,r.resolveComponent)("q-input"),a=(0,r.resolveComponent)("vue-ueditor-wrap"),n=(0,r.resolveComponent)("q-btn"),s=(0,r.resolveComponent)("q-card-section"),p=(0,r.resolveComponent)("q-card"),C=(0,r.resolveComponent)("q-form");return(0,r.openBlock)(),(0,r.createElementBlock)("div",i,[(0,r.createVNode)(C,{onSubmit:m},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(p,{flat:"",bordered:""},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(s,null,{default:(0,r.withCtx)(()=>[t[3]||(t[3]=(0,r.createElementVNode)("div",{class:"text-h6"},"杂项标题",-1)),(0,r.createVNode)(o,{dense:"",modelValue:d.value.Title,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value.Title=e),placeholder:"请输入杂项标题",outlined:"",required:"",rules:[e=>!!e||"请输入杂项标题"]},null,8,["modelValue","rules"]),t[4]||(t[4]=(0,r.createElementVNode)("div",{class:"text-h6"},"杂项内容",-1)),(0,r.createVNode)(a,{ref_key:"editorRef",ref:c,modelValue:d.value.Content,"onUpdate:modelValue":t[1]||(t[1]=e=>d.value.Content=e)},null,8,["modelValue"]),(0,r.createElementVNode)("div",l,[(0,r.createVNode)(n,{type:"submit",color:"primary",icon:"send",loading:u.value,disable:!d.value.Title||!d.value.Content},{default:(0,r.withCtx)(()=>[(0,r.createTextVNode)((0,r.toDisplayString)(d.value.Id?"更新杂项":"发布杂项"),1)]),_:1},8,["loading","disable"]),(0,r.createVNode)(n,{color:"grey",icon:"arrow_back",onClick:v,outline:""},{default:(0,r.withCtx)(()=>[...t[2]||(t[2]=[(0,r.createTextVNode)(" 返回列表 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})])}}}),u=o(1317),d=o(93483),p=o(63663),m=o(17180),v=o(38622),C=o(20407),f=o(66284),b=o(22110),R=o.n(b);const k=(0,u.A)(c,[["__scopeId","data-v-6a416b66"]]);var g=k;R()(c,"components",{QForm:d.A,QCard:p.A,QCardSection:m.A,QInput:v.A,QBtn:C.A,QPageContainer:f.A})}}]);
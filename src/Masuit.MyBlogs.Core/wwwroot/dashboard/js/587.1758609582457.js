(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[587],{13986:function(e,t,o){"use strict";var l=o(74413),a=o(27454),n=o.n(a),s=o(76661),i=o(57695);const r=l.A.create({baseURL:s.c.baseURL,timeout:s.c.timeOut});r.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=n().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),r.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&i.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return i.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:i.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:i.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:i.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:i.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:i.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:i.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:i.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:i.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:i.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:i.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=r},42634:function(){},57894:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return ce}});var l=o(74220),a=o(46732),n=o(97700),s=o(75220),i=o(13986);class r{static async getCategories(){const e=await i.A.get("/category/getcategories");return e}static async getTags(){const e=await i.A.get("/post/gettag");return e}static async getSeminars(){const e=await i.A.get("/seminar/getall");return e}static async writePost(e){const t=await i.A.post("/Post/write",e);return t}static async editPost(e){const t=await i.A.post("/Post/edit",e);return t}static async editPost(e){const t=await i.A.post("/Post/edit",e);return t}static async getPost(e){const t=await i.A.get(`/post/get/${e}`);return t}static async uploadWord(e){const t=new FormData;t.append("upload",e);const o=await i.A.post("/Upload/UploadWord",t,{headers:{"Content-Type":"multipart/form-data"}});return o}static async getRegions(e="Regions"){const t=await i.A.get(`/post/GetRegions?name=${e}`);return t}}var u=o(57695),d=o(64485);const c={key:0},p={key:1,class:"write-blog-container"},m={key:0,class:"text-h6"},v={key:1,class:"text-h6"},b={class:"row"},g={class:"row items-center"},f={key:0,class:"row items-center"},k={key:0},w={class:"row q-gutter-md"},y={class:"col"},C={class:"col"},h={class:"row q-mb-md"},V={class:"col"},R={class:"col"},F={class:"col"},L={class:"col"},x={class:"row"},A={class:"col-3"},_={class:"col-3"},q={class:"col"},D={class:"row items-center"},U={key:0,class:"col-3"},I={style:{"font-size":"14px"}},P={style:{"min-height":"420px"}},S={class:"row",style:{"min-width":"600px"}},M={class:"row q-gutter-md"},Q={class:"col"},E={key:0,class:"col"},T={key:1,class:"col"},N={class:"row items-start"};var K=(0,l.pM)({__name:"write",setup(e){const t=(0,d.k)(),o=(0,s.lq)(),i=(0,s.rd)(),K=(0,a.KR)(null),W=(0,a.KR)(null),O=(0,a.KR)(o.query.id>0),X=(0,a.Kh)({Id:o.query.id?Number(o.query.id):0,Title:"",Author:"",Email:"",Content:"",ProtectContent:"",ProtectContentMode:0,ProtectContentRegions:"",ProtectContentLimitMode:1,ProtectPassword:"",CategoryId:1,Labels:[],Keyword:"",Seminars:[],DisableCopy:!1,DisableComment:!1,schedule:!1,timespan:"",Redirect:"",IsNsfw:!1,ExpireAt:"",LimitMode:0,Regions:"",ExceptRegions:"",Reserve:!0}),$=(0,a.KR)(!1),Y=(0,a.KR)(!0),z=(0,a.KR)(!1),j=(0,a.KR)(!1),H=(0,a.KR)(!1),B=(0,a.KR)(null);let J=null;const G=(0,a.KR)([]),Z=(0,a.KR)([]),ee=(0,a.KR)([]),te=(0,a.KR)([]),oe=(0,a.KR)([]),le=(0,a.KR)([]),ae=(0,a.KR)([]),ne=(0,a.KR)([]),se=(0,a.KR)([]),ie=(0,a.KR)([]),re=[{label:"无加密",value:0},{label:"评论可见",value:1},{label:"地区可见",value:2},{label:"授权可见",value:3},{label:"密码可见",value:4},{label:"仅搜索引擎可见",value:5}],ue=[{label:"不限",value:0},{label:"指定地区可见",value:1},{label:"指定地区不可见",value:2},{label:"指定地区可见但排除在内的这些地区",value:3},{label:"指定地区不可见但排除在内的这些地区",value:4},{label:"仅搜索引擎可见",value:5}],de=async()=>{try{const e=await r.getCategories();e.Success&&(G.value=pe(e.Data)||[],Z.value=G.value)}catch(e){console.error("加载分类失败:",e),u.oR.error("加载分类失败",{position:"top-center",autoClose:3e3})}},ce=(e,t)=>{t(()=>{if(""===e)Z.value=G.value;else{const t=e.toLowerCase();Z.value=G.value.filter(e=>e.Name.toLowerCase().indexOf(t)>-1)}})},pe=(e,t="")=>{const o=[];for(const l of e){const e=t?`${t}/${l.Name}`:l.Name;if(o.push({...l,Name:e,OriginalName:l.Name}),l.Children&&l.Children.length>0){const t=pe(l.Children,e);o.push(...t)}}return o},me=async()=>{try{const e=await r.getTags();e.Success&&(ee.value=e.Data||[],te.value=ee.value)}catch(e){console.error("加载标签失败:",e),u.oR.error("加载标签失败",{position:"top-center",autoClose:3e3})}},ve=(e,t)=>{t(""!==e?()=>{const t=e?.toLowerCase();te.value=ee.value.filter(e=>e?.toLowerCase().indexOf(t)>-1)}:()=>{te.value=ee.value})},be=(e,t)=>{const o=ee.value.find(t=>t.TagName===e);if(!o&&e.length>0){const o={Id:Date.now(),TagName:e};ee.value.push(o),te.value=ee.value,t(e)}},ge=async()=>{const e=await r.getSeminars();e.Success&&(oe.value=e.Data||[],le.value=oe.value)},fe=(e,t)=>{t(()=>{if(""===e)le.value=oe.value;else{const t=e.toLowerCase();le.value=oe.value.filter(e=>e.Title.toLowerCase().indexOf(t)>-1)}})},ke=async()=>{let e=await r.getRegions();e.Success&&(ae.value=e.Data||[],ne.value=ae.value),e=await r.getRegions("ExceptRegions"),e.Success&&(se.value=e.Data||[])},we=(e,t)=>{t(""!==e?()=>{const t=e?.toLowerCase();ne.value=ae.value.filter(e=>e?.toLowerCase().indexOf(t)>-1)}:()=>{ne.value=ae.value})},ye=(e,t)=>{const o=ae.value.find(t=>t===e);!o&&e.length>0&&(ae.value.push(e),ne.value=ae.value,t(e))},Ce=(e,t)=>{t(""!==e?()=>{const t=e?.toLowerCase();ie.value=se.value.filter(e=>e?.toLowerCase().indexOf(t)>-1)}:()=>{ie.value=se.value})},he=(e,t)=>{const o=se.value.find(t=>t===e);!o&&e.length>0&&(se.value.push(e),ie.value=se.value,t(e))},Ve=()=>{j.value=!0},Re=e=>{B.value=e},Fe=async()=>{if(B.value){z.value=!0;try{const e=await r.uploadWord(B.value);e.Success?(X.Title=e.Data?.Title||X.Title,X.Content=e.Data?.Content||"",u.oR.success("Word文档上传成功",{position:"top-center",autoClose:3e3}),j.value=!1,B.value=null):u.oR.error(e.Message||"Word文档上传失败",{position:"top-center",autoClose:3e3})}catch(e){console.error("上传Word文档失败:",e),u.oR.error("上传失败，请重试",{position:"top-center",autoClose:3e3})}finally{z.value=!1}}else u.oR.error("请选择要上传的Word文档",{position:"top-center",autoClose:3e3})},Le=async()=>{if(!X.Title||X.Title.trim().length<2)u.oR.error("文章标题至少需要2个字符",{position:"top-center",autoClose:3e3});else if(!X.Content||X.Content.length<20)u.oR.error("文章内容至少需要20个字符",{position:"top-center",autoClose:3e3});else{if(X.schedule&&X.timespan){const e=new Date(X.timespan),t=new Date;if(e<=t)return void u.oR.error("定时发表时间必须大于当前时间",{position:"top-center",autoClose:3e3})}else if(X.schedule&&!X.timespan)return void u.oR.error("请选择定时发表时间",{position:"top-center",autoClose:3e3});$.value=!0;try{X.Label=X.Labels.join(",");const e=O.value?await r.editPost(X):await r.writePost(X);e.Success?(u.oR.success("文章发布成功",{position:"top-center",autoClose:3e3}),localStorage.removeItem("write-post-draft:"+X.Id),clearInterval(J),i.push("/posts/list")):u.oR.error(e.Message||"文章发布失败",{position:"top-center",autoClose:3e3})}catch(e){console.error("提交文章失败:",e),u.oR.error("提交失败，请重试",{position:"top-center",autoClose:3e3})}finally{$.value=!1}}},xe=()=>{const e=localStorage.getItem("write-post-draft:"+X.Id);if(e){const t=JSON.parse(e);Object.assign(X,t)}Ae(),H.value=!1},Ae=()=>{J=setInterval(()=>{const e={...X};localStorage.setItem("write-post-draft:"+X.Id,JSON.stringify(e))},5e3)},_e=e=>{const t=new Date,o=new Date(e);return o>=new Date(t.getFullYear(),t.getMonth(),t.getDate())},qe=(e,t)=>{const o=new Date,l=new Date(o.getFullYear(),o.getMonth(),o.getDate());if(!X.timespan)return!0;const a=X.timespan.split(" ")[0];if(!a)return!0;const n=new Date(a);if(n.getTime()!==l.getTime())return!0;const s=o.getHours(),i=o.getMinutes();return void 0!==t?e>s||e===s&&t>i:e>=s},De=async()=>{const e=new URLSearchParams(window.location.search),t=o.query.refer||o.query.id||e.get("refer");if(t){const e=await r.getPost(parseInt(t));if(e.Success&&e.Data){const t=e.Data;t.Id=o.query.id||0,t.Labels=t.Label?.split(",")||[],Object.assign(X,t)}}};(0,l.sV)(async()=>{const e=await t.getUserInfo();X.Author=e.NickName,X.Email=e.Email,await Promise.all([de(),me(),ge(),De(),ke()]),H.value=JSON.parse(localStorage.getItem("write-post-draft:"+X.Id))?.Content?.length>0,H.value||Ae(),document.querySelector(".q-page-container").addEventListener("scroll",Se),Y.value=!1}),(0,l.hi)(()=>{J&&clearInterval(J),Ue&&clearTimeout(Ue),document.querySelector(".q-page-container")?.removeEventListener("scroll",Se)});let Ue=null,Ie=!1,Pe=!1;const Se=()=>{Ue&&clearTimeout(Ue),Ue=setTimeout(()=>{Me()},100)},Me=()=>{if(K.value?.$el){const e=K.value.$el.querySelector(".edui-editor-toolbarbox");if(e){const t=K.value.$el.getBoundingClientRect(),o=t.top<84&&t.bottom>300;if(o&&!Ie){const t=K.value.$el.offsetWidth;e.style.cssText=`\n          position: fixed !important;\n          top: 84px !important;\n          z-index: 1000 !important;\n          width: ${t}px !important;\n          transition: all 0.5s ease !important;\n        `,Ie=!0}else!o&&Ie&&(e.style.cssText="\n          position: static !important;\n          top: auto !important;\n          z-index: auto !important;\n          width: auto !important;\n          transition: all 0.5s ease !important;\n        ",Ie=!1)}}if(W.value?.$el){const e=W.value.$el.querySelector(".edui-editor-toolbarbox");if(e){const t=W.value.$el.getBoundingClientRect(),o=t.top<84&&t.bottom>300;if(o&&!Pe){const t=W.value.$el.offsetWidth;e.style.cssText=`\n          position: fixed !important;\n          top: 84px !important;\n          z-index: 1000 !important;\n          width: ${t}px !important;\n          transition: all 0.2s ease !important;\n        `,Pe=!0}else!o&&Pe&&(e.style.cssText="\n          position: static !important;\n          top: auto !important;\n          z-index: auto !important;\n          width: auto !important;\n          transition: all 0.2s ease !important;\n        ",Pe=!1)}}};return(e,t)=>{const s=(0,l.g2)("q-spinner"),i=(0,l.g2)("q-inner-loading"),r=(0,l.g2)("q-btn"),u=(0,l.g2)("q-input"),d=(0,l.g2)("vue-ueditor-wrap"),J=(0,l.g2)("q-card-section"),G=(0,l.g2)("q-card"),ee=(0,l.g2)("q-select"),oe=(0,l.g2)("q-item-section"),ae=(0,l.g2)("q-item"),se=(0,l.g2)("q-date"),de=(0,l.g2)("q-popup-proxy"),pe=(0,l.g2)("q-icon"),me=(0,l.g2)("q-checkbox"),ge=(0,l.g2)("q-time"),ke=(0,l.g2)("q-file"),De=(0,l.g2)("q-card-actions"),Ue=(0,l.g2)("q-dialog"),Ie=(0,l.gN)("close-popup");return Y.value?((0,l.uX)(),(0,l.CE)("div",c,[(0,l.bF)(i,{showing:Y.value},{default:(0,l.k6)(()=>[(0,l.bF)(s,{color:"primary",size:"100px"})]),_:1},8,["showing"])])):((0,l.uX)(),(0,l.CE)("div",p,[(0,a.R1)(o).query.id?((0,l.uX)(),(0,l.CE)("div",m,"编辑ID："+(0,n.v_)(X.Id),1)):(0,l.Q3)("",!0),(0,a.R1)(o).query.refer?((0,l.uX)(),(0,l.CE)("div",v,"复制来源ID："+(0,n.v_)((0,a.R1)(o).query.refer),1)):(0,l.Q3)("",!0),(0,l.Lk)("div",b,[(0,l.bF)(u,{autogrow:"",class:"col",modelValue:X.Title,"onUpdate:modelValue":t[0]||(t[0]=e=>X.Title=e),label:"文章标题",outlined:"",required:"",rules:[e=>!!e||"请输入文章标题",e=>e.length>=2||"标题至少2个字符",e=>e.length<=128||"标题最多128个字符"]},{append:(0,l.k6)(()=>[(0,l.bF)(r,{dense:"",size:"lg",color:"info",label:"上传Word文档",onClick:Ve,class:"full-width",icon:"upload","no-caps":""})]),_:1},8,["modelValue","rules"])]),(0,l.bF)(G,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,l.k6)(()=>[(0,l.bF)(J,null,{default:(0,l.k6)(()=>[t[35]||(t[35]=(0,l.Lk)("div",{class:"text-h6"},"文章内容：",-1)),(0,l.bF)(d,{ref_key:"editor",ref:K,modelValue:X.Content,"onUpdate:modelValue":t[1]||(t[1]=e=>X.Content=e),config:{initialFrameHeight:500}},null,8,["modelValue"])]),_:1})]),_:1}),(0,l.bF)(G,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,l.k6)(()=>[(0,l.bF)(J,null,{default:(0,l.k6)(()=>[(0,l.Lk)("div",g,[(0,l.bF)(ee,{dense:"",modelValue:X.ProtectContentMode,"onUpdate:modelValue":t[2]||(t[2]=e=>X.ProtectContentMode=e),options:re,label:"加密模式",outlined:"",style:{"min-width":"200px"},"map-options":"","emit-value":""},{before:(0,l.k6)(()=>[...t[36]||(t[36]=[(0,l.Lk)("div",{class:"text-h6"},"文章加密",-1)])]),_:1},8,["modelValue"]),2===X.ProtectContentMode?((0,l.uX)(),(0,l.CE)("div",f,[(0,l.bF)(u,{autogrow:"",dense:"",modelValue:X.ProtectContentRegions,"onUpdate:modelValue":t[4]||(t[4]=e=>X.ProtectContentRegions=e),label:"可见地区",placeholder:"竖线分隔，支持国家、地区、城市、运营商、ASN",style:{width:"450px"},outlined:""},{append:(0,l.k6)(()=>[(0,l.bF)(ee,{dense:"",borderless:"",modelValue:X.ProtectContentLimitMode,"onUpdate:modelValue":t[3]||(t[3]=e=>X.ProtectContentLimitMode=e),options:[{label:"以内",value:1},{label:"以外",value:2}],"emit-value":"","map-options":""},null,8,["modelValue"])]),_:1},8,["modelValue"])])):(0,l.Q3)("",!0),4===X.ProtectContentMode?((0,l.uX)(),(0,l.Wv)(u,{key:1,autogrow:"",dense:"",modelValue:X.ProtectPassword,"onUpdate:modelValue":t[5]||(t[5]=e=>X.ProtectPassword=e),label:"访问密码",type:"password",outlined:""},null,8,["modelValue"])):(0,l.Q3)("",!0)]),X.ProtectContentMode>0?((0,l.uX)(),(0,l.CE)("div",k,[(0,l.bF)(d,{ref_key:"protectContentEditor",ref:W,modelValue:X.ProtectContent,"onUpdate:modelValue":t[6]||(t[6]=e=>X.ProtectContent=e),config:{initialFrameHeight:300}},null,8,["modelValue"])])):(0,l.Q3)("",!0)]),_:1})]),_:1}),(0,l.bF)(G,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,l.k6)(()=>[(0,l.bF)(J,null,{default:(0,l.k6)(()=>[t[37]||(t[37]=(0,l.Lk)("div",{class:"text-h6"},"作者信息",-1)),(0,l.Lk)("div",w,[(0,l.Lk)("div",y,[(0,l.bF)(u,{autogrow:"",dense:"",modelValue:X.Author,"onUpdate:modelValue":t[7]||(t[7]=e=>X.Author=e),label:"作者",outlined:"",rules:[e=>!!e||"请输入作者",e=>e.length<=20||"作者名最多20个字符"]},null,8,["modelValue","rules"])]),(0,l.Lk)("div",C,[(0,l.bF)(u,{autogrow:"",dense:"",modelValue:X.Email,"onUpdate:modelValue":t[8]||(t[8]=e=>X.Email=e),label:"邮箱",type:"email",outlined:"",rules:[e=>!!e||"请输入邮箱",e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||"邮箱格式不正确"]},null,8,["modelValue","rules"])])])]),_:1})]),_:1}),(0,l.bF)(G,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,l.k6)(()=>[(0,l.bF)(J,null,{default:(0,l.k6)(()=>[t[40]||(t[40]=(0,l.Lk)("div",{class:"text-h6"},"文章设置",-1)),(0,l.Lk)("div",h,[(0,l.Lk)("div",V,[(0,l.bF)(ee,{dense:"",modelValue:X.CategoryId,"onUpdate:modelValue":t[9]||(t[9]=e=>X.CategoryId=e),options:Z.value,label:"分类",outlined:"","option-label":"Name","option-value":"Id","emit-value":"","map-options":"","use-input":"","input-debounce":"300",onFilter:ce},{"no-option":(0,l.k6)(()=>[(0,l.bF)(ae,null,{default:(0,l.k6)(()=>[(0,l.bF)(oe,{class:"text-grey"},{default:(0,l.k6)(()=>[...t[38]||(t[38]=[(0,l.eW)(" 没有找到匹配的分类 ",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),(0,l.Lk)("div",R,[(0,l.bF)(ee,{dense:"",modelValue:X.Seminars,"onUpdate:modelValue":t[10]||(t[10]=e=>X.Seminars=e),options:le.value,label:"专题",outlined:"",multiple:"","use-chips":"","option-label":"Title","option-value":"Id","map-options":"","emit-value":"","use-input":"","input-debounce":"300",onFilter:fe,clearable:""},{"no-option":(0,l.k6)(()=>[(0,l.bF)(ae,null,{default:(0,l.k6)(()=>[(0,l.bF)(oe,{class:"text-grey"},{default:(0,l.k6)(()=>[...t[39]||(t[39]=[(0,l.eW)(" 没有找到匹配的专题 ",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),(0,l.Lk)("div",F,[(0,l.bF)(ee,{dense:"",modelValue:X.Labels,"onUpdate:modelValue":t[11]||(t[11]=e=>X.Labels=e),options:te.value,label:"标签",outlined:"",multiple:"","use-chips":"","use-input":"","new-value-mode":"add-unique","input-debounce":"0",onFilter:ve,onNewValue:be},null,8,["modelValue","options"])]),(0,l.Lk)("div",L,[(0,l.bF)(u,{autogrow:"",dense:"",modelValue:X.Keyword,"onUpdate:modelValue":t[12]||(t[12]=e=>X.Keyword=e),label:"文章关键词",outlined:"",hint:"多个关键词用逗号分隔"},null,8,["modelValue"])])]),(0,l.Lk)("div",x,[(0,l.Lk)("div",A,[(0,l.bF)(u,{dense:"",autogrow:"",modelValue:X.Redirect,"onUpdate:modelValue":t[13]||(t[13]=e=>X.Redirect=e),label:"跳转到第三方链接",placeholder:"https://baidu.com 留空不跳转",outlined:"",hint:"当跳转第三方链接时，文章内容不宜过多"},null,8,["modelValue"])]),(0,l.Lk)("div",_,[(0,l.bF)(u,{dense:"",modelValue:X.ExpireAt,"onUpdate:modelValue":t[16]||(t[16]=e=>X.ExpireAt=e),label:"过期时间",outlined:"",readonly:""},{append:(0,l.k6)(()=>[(0,l.bF)(pe,{name:"event",class:"cursor-pointer"},{default:(0,l.k6)(()=>[(0,l.bF)(de,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(se,{modelValue:X.ExpireAt,"onUpdate:modelValue":t[14]||(t[14]=e=>X.ExpireAt=e),options:_e,mask:"YYYY-MM-DD"},null,8,["modelValue"]),[[Ie]])]),_:1})]),_:1}),X.ExpireAt?((0,l.uX)(),(0,l.Wv)(r,{key:0,round:"",flat:"",icon:"clear",onClick:t[15]||(t[15]=e=>X.ExpireAt="")})):(0,l.Q3)("",!0)]),_:1},8,["modelValue"])]),(0,l.Lk)("div",q,[(0,l.Lk)("div",D,[(0,l.bF)(me,{modelValue:X.IsNsfw,"onUpdate:modelValue":t[17]||(t[17]=e=>X.IsNsfw=e),label:"标记为不安全的内容"},null,8,["modelValue"]),O.value?((0,l.uX)(),(0,l.Wv)(me,{key:0,modelValue:X.Reserve,"onUpdate:modelValue":t[18]||(t[18]=e=>X.Reserve=e),label:"保留历史版本"},null,8,["modelValue"])):(0,l.Q3)("",!0),(0,l.bF)(me,{modelValue:X.DisableCopy,"onUpdate:modelValue":t[19]||(t[19]=e=>X.DisableCopy=e),label:"禁止转载"},null,8,["modelValue"]),(0,l.bF)(me,{modelValue:X.DisableComment,"onUpdate:modelValue":t[20]||(t[20]=e=>X.DisableComment=e),label:"禁止评论"},null,8,["modelValue"]),O.value||X.schedule?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(me,{key:1,modelValue:X.schedule,"onUpdate:modelValue":t[21]||(t[21]=e=>X.schedule=e),label:"定时发表"},null,8,["modelValue"]))])]),X.schedule?((0,l.uX)(),(0,l.CE)("div",U,[(0,l.bF)(u,{dense:"",modelValue:X.timespan,"onUpdate:modelValue":t[26]||(t[26]=e=>X.timespan=e),label:"计划发表时间",outlined:"",readonly:""},{prepend:(0,l.k6)(()=>[(0,l.Lk)("span",I,[O.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(me,{key:0,modelValue:X.schedule,"onUpdate:modelValue":t[22]||(t[22]=e=>X.schedule=e),label:"定时发表"},null,8,["modelValue"]))])]),append:(0,l.k6)(()=>[(0,l.bF)(pe,{name:"event",class:"cursor-pointer"},{default:(0,l.k6)(()=>[(0,l.bF)(de,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.k6)(()=>[(0,l.Lk)("div",P,[(0,l.Lk)("div",S,[(0,l.bF)(se,{modelValue:X.timespan,"onUpdate:modelValue":t[23]||(t[23]=e=>X.timespan=e),mask:"YYYY-MM-DD HH:mm",options:_e},null,8,["modelValue"]),X.timespan?((0,l.uX)(),(0,l.Wv)(ge,{key:0,modelValue:X.timespan,"onUpdate:modelValue":t[24]||(t[24]=e=>X.timespan=e),mask:"YYYY-MM-DD HH:mm",options:qe},null,8,["modelValue"])):(0,l.Q3)("",!0)]),X.timespan?(0,l.bo)(((0,l.uX)(),(0,l.Wv)(r,{key:0,color:"primary",label:"确认"},null,512)),[[Ie]]):(0,l.Q3)("",!0)])]),_:1})]),_:1}),X.timespan?((0,l.uX)(),(0,l.Wv)(r,{key:0,round:"",flat:"",icon:"clear",onClick:t[25]||(t[25]=e=>X.timespan="")})):(0,l.Q3)("",!0)]),_:1},8,["modelValue"])])):(0,l.Q3)("",!0)])]),_:1})]),_:1}),(0,l.bF)(G,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,l.k6)(()=>[(0,l.bF)(J,null,{default:(0,l.k6)(()=>[t[41]||(t[41]=(0,l.Lk)("div",{class:"text-h6"},"按地区投放",-1)),(0,l.Lk)("div",M,[(0,l.Lk)("div",Q,[(0,l.bF)(ee,{dense:"",modelValue:X.LimitMode,"onUpdate:modelValue":t[27]||(t[27]=e=>X.LimitMode=e),options:ue,label:"投放模式",outlined:"","map-options":"","emit-value":""},null,8,["modelValue"])]),X.LimitMode>0&&X.LimitMode<5?((0,l.uX)(),(0,l.CE)("div",E,[(0,l.bF)(ee,{dense:"",modelValue:X.Regions,"onUpdate:modelValue":t[29]||(t[29]=e=>X.Regions=e),options:ne.value,label:X.LimitMode%2===1?"可见地区":"不可见地区","label-color":X.LimitMode%2===1?"":"red",outlined:"","use-input":"","new-value-mode":"add-unique","input-debounce":"0",onFilter:we,onNewValue:ye,hint:"竖线分隔，如：江苏|苏州|移动|AS2333|DMIT，支持地区、运营商、ASN、机房名称"},{append:(0,l.k6)(()=>[X.Regions?((0,l.uX)(),(0,l.Wv)(r,{key:0,round:"",flat:"",icon:"clear",onClick:t[28]||(t[28]=e=>X.Regions=null)})):(0,l.Q3)("",!0)]),_:1},8,["modelValue","options","label","label-color"])])):(0,l.Q3)("",!0),3===X.LimitMode||4===X.LimitMode?((0,l.uX)(),(0,l.CE)("div",T,[(0,l.bF)(ee,{dense:"",modelValue:X.ExceptRegions,"onUpdate:modelValue":t[31]||(t[31]=e=>X.ExceptRegions=e),options:ie.value,label:"排除地区",outlined:"","use-input":"","new-value-mode":"add-unique","input-debounce":"0",onFilter:Ce,onNewValue:he,hint:"竖线分隔，如：江苏|苏州|移动|AS2333|DMIT，支持地区、运营商、ASN、机房名称"},{append:(0,l.k6)(()=>[X.ExceptRegions?((0,l.uX)(),(0,l.Wv)(r,{key:0,round:"",flat:"",icon:"clear",onClick:t[30]||(t[30]=e=>X.ExceptRegions=null)})):(0,l.Q3)("",!0)]),_:1},8,["modelValue","options"])])):(0,l.Q3)("",!0),(0,l.Lk)("div",N,[(0,l.bF)(r,{icon:"send",type:"submit",color:"primary",label:"发布文章",loading:$.value,onClick:Le},null,8,["loading"])])])]),_:1})]),_:1}),(0,l.bF)(Ue,{modelValue:j.value,"onUpdate:modelValue":t[33]||(t[33]=e=>j.value=e)},{default:(0,l.k6)(()=>[(0,l.bF)(G,{style:{"min-width":"400px"}},{default:(0,l.k6)(()=>[(0,l.bF)(J,null,{default:(0,l.k6)(()=>[...t[42]||(t[42]=[(0,l.Lk)("div",{class:"text-h6"},"上传Word文档",-1),(0,l.Lk)("div",{class:"text-caption text-orange"},"注意：重复上传将会覆盖之前上传的内容！",-1)])]),_:1}),(0,l.bF)(J,null,{default:(0,l.k6)(()=>[(0,l.bF)(ke,{modelValue:B.value,"onUpdate:modelValue":t[32]||(t[32]=e=>B.value=e),label:"选择Word文档",outlined:"",accept:".doc,.docx",onInput:Re},{prepend:(0,l.k6)(()=>[(0,l.bF)(pe,{name:"attach_file"})]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(De,{align:"right"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(r,{flat:"",label:"取消",color:"grey"},null,512),[[Ie]]),(0,l.bF)(r,{label:"上传",color:"primary",onClick:Fe,loading:z.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,l.bF)(Ue,{modelValue:H.value,"onUpdate:modelValue":t[34]||(t[34]=e=>H.value=e)},{default:(0,l.k6)(()=>[(0,l.bF)(G,{style:{"min-width":"400px"}},{default:(0,l.k6)(()=>[(0,l.bF)(J,null,{default:(0,l.k6)(()=>[...t[43]||(t[43]=[(0,l.Lk)("div",{class:"text-h6"},"检测到草稿",-1),(0,l.Lk)("div",{class:"text-caption text-orange"},"检查到上次有未提交的草稿，是否加载？",-1)])]),_:1}),(0,l.bF)(De,{align:"right"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(r,{flat:"",label:"取消",color:"grey",onClick:Ae},null,512),[[Ie]]),(0,l.bF)(r,{label:"加载",color:"primary",onClick:xe})]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,l.bF)(i,{showing:$.value},{default:(0,l.k6)(()=>[(0,l.bF)(s,{color:"primary",size:"100px"})]),_:1},8,["showing"])]))}}}),W=o(1317),O=o(49010),X=o(25485),$=o(38622),Y=o(20407),z=o(63663),j=o(17180),H=o(40975),B=o(93359),J=o(91484),G=o(64503),Z=o(34854),ee=o(9341),te=o(78495),oe=o(37139),le=o(51375),ae=o(61929),ne=o(71248),se=o(66284),ie=o(60515),re=o(22110),ue=o.n(re);const de=(0,W.A)(K,[["__scopeId","data-v-0123f2d2"]]);var ce=de;ue()(K,"components",{QInnerLoading:O.A,QSpinner:X.A,QInput:$.A,QBtn:Y.A,QCard:z.A,QCardSection:j.A,QSelect:H.A,QItem:B.A,QItemSection:J.A,QIcon:G.A,QPopupProxy:Z.A,QDate:ee.A,QCheckbox:te.A,QTime:oe.A,QDialog:le.A,QFile:ae.A,QCardActions:ne.A,QPageContainer:se.A}),ue()(K,"directives",{ClosePopup:ie.A})},64485:function(e,t,o){"use strict";o.d(t,{k:function(){return i}});var l=o(13986),a=o(76661),n=o(10810),s=o(46732);const i=(0,n.nY)("user",()=>{const e=(0,s.KR)(),t=(0,s.KR)(!1),o=async()=>{if(e.value)return e.value;try{const o=await l.A.get("/passport/getuserinfo");if(o.Data)return e.value=o.Data,t.value=!0,o.Data;window.location.href=a.A.baseURL+"/passport/login?redirect="+encodeURIComponent(window.location.pathname)}catch(o){throw console.error("获取用户信息失败:",o),e.value=null,t.value=!1,o}},n=o=>{e.value=o,t.value=!0},i=()=>{e.value=null,t.value=!1},r=()=>t.value&&null!==e.value;return{getUserInfo:o,setUserInfo:n,clearUserInfo:i,checkLoginStatus:r}})}}]);
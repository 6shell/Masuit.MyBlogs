(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[97],{13986:function(e,t,l){"use strict";var a=l(13719),o=l.n(a),r=l(27454),n=l.n(r),s=l(76661),c=l(57695);const d=o().create({baseURL:s.c.baseURL,timeout:s.c.timeOut});d.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=n().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),d.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&c.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return c.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:c.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:c.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:c.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:c.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:c.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:c.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:c.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:c.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:c.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:c.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=d},42634:function(){},54172:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return ye}});var a=l(74061),o=l(57695),r=l(13986),n=l(23508),s=l.n(n),c=(l(26960),l(243));const d={class:"firewall-page"},i={class:"row q-mb-md"},u={class:"col text-right"},m={class:"text-h6"},v={class:"row q-mb-md"},p={class:"col"},V={class:"col"},g={class:"col"},N={class:"col"},h={class:"row q-mb-md"},f={class:"col"},C={key:0,class:"col"},w={key:1,class:"col"},b={key:0,class:"text-negative text-caption"},x={key:2,class:"col"},y={key:3,class:"col"},k={key:4,class:"col"},E={class:"row q-gutter-md q-mb-md"},A={class:"col"},R={class:"col"},_={class:"row q-gutter-md q-mb-md"},I={class:"col"},q={class:"col"},P={class:"row q-gutter-md q-mb-md"},U={class:"col"},B={class:"q-mb-md"},T={class:"q-mb-md"},D={class:"text-h6 q-mb-md"},S={key:0,class:"text-center q-pa-md text-grey-6"},M={key:1},L={class:"row q-gutter-md q-mb-md items-center"},Q={class:"col-auto"},O={class:"col-auto"},K={class:"col-auto"},H={class:"col-4 text-right"},j=["href"],F=["href"],z=["href"],W={class:"row items-center justify-between q-mb-md"},Y={class:"col-auto"},J={class:"text-body2 text-grey-7"},$={class:"col-auto justify-center q-mt-md"},G={class:"col-auto"},Z={class:"text-h6 q-mb-md"},X=["href"],ee={class:"text-h6"},te={class:"headers-content"};var le=(0,a.defineComponent)({__name:"firewall",setup(e){const t=(0,a.ref)({}),l=(0,a.ref)([]),n=(0,a.ref)([]),le=(0,a.ref)(0),ae=(0,a.ref)(!1),oe=(0,a.ref)(!1),re=(0,a.ref)(!1),ne=(0,a.ref)(!1),se=(0,a.ref)(1),ce=(0,a.ref)(10),de=[{label:"10条/页",value:10},{label:"20条/页",value:20},{label:"50条/页",value:50},{label:"100条/页",value:100},{label:"200条/页",value:200}],ie=(0,a.ref)(!1),ue=(0,a.ref)(""),me=(0,a.ref)(""),ve=(0,a.ref)(""),pe=(0,a.ref)(!1),Ve=(0,a.ref)(!1),ge=(0,a.ref)(""),Ne=(0,a.ref)(),he=(0,a.ref)();let fe=null,Ce=null;const we=[{label:"无",value:""},{label:"JS挑战",value:"JSChallenge"},{label:"验证码挑战",value:"CaptchaChallenge"},{label:"CloudflareTurnstile",value:"CloudflareTurnstileChallenge"}],be=[{label:"所有地区",value:"All"},{label:"在以下地区：",value:"Region"}],xe=[{label:"以内",value:"1"},{label:"以外",value:"2"}],ye=(0,a.ref)(!1),ke=(0,a.computed)({get:()=>"true"===t.value.FirewallEnabled,set:e=>{e?t.value.FirewallEnabled="true":ye.value=!0}}),Ee=(0,a.computed)(()=>{const e=l.value.filter(e=>e.IP?.includes(Re.value)||e.RequestUrl?.includes(Re.value)||e.Referer?.includes(Re.value)||e.UserAgent?.includes(Re.value)||e.Remark?.includes(Re.value));return ne.value?e.reduce((e,t)=>{const l=e.find(e=>e.IP===t.IP);return l||e.push(t),e},[]):e}),Ae=(0,a.computed)(()=>Math.ceil(Ee.value.length/ce.value)),Re=(0,a.ref)(""),_e=(0,a.computed)(()=>{const e=(se.value-1)*ce.value,t=e+ce.value;return Ee.value.slice(e,t)}),Ie=async()=>{try{const e=await r.A.get("/system/getsettings");if(e?.Success&&e.Data){const l={};e.Data.forEach(e=>{l[e.Name]=e.Value}),t.value=l,await(0,a.nextTick)(),fe&&fe.setValue(t.value.AccessDenyTips||""),Ce&&Ce.setValue(t.value.UserAgentBlockedMsg||"")}}catch(e){o.oR.error("获取系统设置失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading settings:",e)}},qe=async()=>{oe.value=!0;try{const e=await r.A.get("/system/InterceptLog");e?.Success&&e.Data&&(l.value=e.Data.list||[],le.value=e.Data.interceptCount||0,n.value=e.Data.ranking||[])}catch(e){o.oR.error("加载拦截日志失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading logs:",e)}finally{oe.value=!1}},Pe=async()=>{re.value=!0;const e=await r.A.get("/system/clearInterceptLog");e?.Success?(o.oR.success("拦截日志已清空",{autoClose:2e3,position:"top-center"}),qe()):o.oR.error(e?.Message||"清空失败",{autoClose:2e3,position:"top-center"}),re.value=!1},Ue=e=>{se.value=e},Be=e=>{ce.value=e,se.value=1},Te=()=>{se.value=1},De=async()=>{ae.value=!0;try{fe&&(t.value.AccessDenyTips=fe.getValue()),Ce&&(t.value.UserAgentBlockedMsg=Ce.getValue());const e=await r.A.post("/system/save",Object.keys(t.value).map(e=>({Name:e,Value:t.value[e]})));e?.Success?o.oR.success(e.Message||"保存成功",{autoClose:2e3,position:"top-center"}):o.oR.error(e?.Message||"保存失败",{autoClose:2e3,position:"top-center"})}catch(e){o.oR.error("保存失败",{autoClose:2e3,position:"top-center"}),console.error("Error saving settings:",e)}finally{ae.value=!1}},Se=async()=>{try{const e=await r.A.get("/system/IpBlackList");e?.Success&&e.Data&&(ue.value="IP黑名单",me.value="编辑全局IP黑名单",ve.value=e.Data,ie.value=!0)}catch(e){o.oR.error("获取IP黑名单失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading IP blacklist:",e)}},Me=async()=>{try{const e=await r.A.get("/system/GetIPRangeBlackList");e?.Success&&(ue.value="IP地址段黑名单",me.value="编辑IP地址段黑名单",ve.value=e.Data,ie.value=!0)}catch(e){o.oR.error("获取IP地址段黑名单失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading IP range blacklist:",e)}},Le=async()=>{try{const e=await r.A.get("/system/IpWhiteList");e?.Success&&(ue.value="IP白名单",me.value="编辑IP白名单",ve.value=e.Data,ie.value=!0)}catch(e){o.oR.error("获取IP白名单失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading IP whitelist:",e)}},Qe=async()=>{pe.value=!0;try{let e="";"IP黑名单"===ue.value?e="/system/SetIpBlackList":"IP地址段黑名单"===ue.value?e="/system/SetIPRangeBlackList":"IP白名单"===ue.value&&(e="/system/SetIpWhiteList");const t=await r.A.post(e,{content:ve.value});t?.Success?(o.oR.success("保存成功",{autoClose:2e3,position:"top-center"}),Oe()):o.oR.error(t?.Message||"保存失败",{autoClose:2e3,position:"top-center"})}catch(e){o.oR.error("保存失败",{autoClose:2e3,position:"top-center"}),console.error("Error saving IP list:",e)}finally{pe.value=!1}},Oe=()=>{ie.value=!1,ue.value="",me.value="",ve.value=""},Ke=async e=>{const t=await r.A.post("/system/AddToWhiteList",{ip:e});o.oR.success(t?.Message||"已加入白名单",{autoClose:2e3,position:"top-center"})},He=async e=>{const t=await r.A.post("/system/AddToBlackList",{ip:e});o.oR.success(t?.Message||"已加入黑名单",{autoClose:2e3,position:"top-center"})},je=e=>{try{ge.value=JSON.stringify(JSON.parse(e),null,2)}catch{ge.value=e}Ve.value=!0},Fe=e=>s()(e).format("MM-DD HH:mm"),ze=e=>s()(e).format("YYYY-MM-DD HH:mm:ss"),We=async()=>{await(0,a.nextTick)(),Ne.value&&(fe=c.EN.create(Ne.value,{value:t.value.AccessDenyTips||"",language:"html",theme:"vs",minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on"})),he.value&&(Ce=c.EN.create(he.value,{value:t.value.UserAgentBlockedMsg||"",language:"html",theme:"vs",minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on"}))};return(0,a.onMounted)(async()=>{await Ie(),await qe(),setTimeout(We,100)}),(0,a.onUnmounted)(()=>{fe&&fe.dispose(),Ce&&Ce.dispose()}),(e,o)=>{const r=(0,a.resolveComponent)("q-btn"),s=(0,a.resolveComponent)("q-btn-group"),c=(0,a.resolveComponent)("q-toggle"),fe=(0,a.resolveComponent)("q-input"),Ce=(0,a.resolveComponent)("q-select"),Ie=(0,a.resolveComponent)("q-card-section"),We=(0,a.resolveComponent)("q-card"),Ye=(0,a.resolveComponent)("q-icon"),Je=(0,a.resolveComponent)("q-chip"),$e=(0,a.resolveComponent)("q-card-actions"),Ge=(0,a.resolveComponent)("q-popup-proxy"),Ze=(0,a.resolveComponent)("q-tooltip"),Xe=(0,a.resolveComponent)("vxe-column"),et=(0,a.resolveComponent)("vxe-table"),tt=(0,a.resolveComponent)("q-pagination"),lt=(0,a.resolveComponent)("q-badge"),at=(0,a.resolveComponent)("q-space"),ot=(0,a.resolveComponent)("q-dialog"),rt=(0,a.resolveDirective)("close-popup");return(0,a.openBlock)(),(0,a.createElementBlock)("div",d,[(0,a.createElementVNode)("div",i,[o[27]||(o[27]=(0,a.createElementVNode)("div",{class:"col"},[(0,a.createElementVNode)("div",{class:"text-h6"},"防火墙策略配置")],-1)),(0,a.createElementVNode)("div",u,[(0,a.createVNode)(s,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(r,{color:"negative",icon:"block",label:"编辑全局IP黑名单",onClick:Se}),(0,a.createVNode)(r,{color:"warning",icon:"warning",label:"编辑IP地址段黑名单",onClick:Me}),(0,a.createVNode)(r,{color:"positive",icon:"security",label:"编辑IP白名单",onClick:Le}),(0,a.createVNode)(r,{color:"primary",icon:"save",label:"保存配置",onClick:De,loading:ae.value},null,8,["loading"])]),_:1})])]),(0,a.createVNode)(We,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ie,null,{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",m,[(0,a.createVNode)(c,{modelValue:ke.value,"onUpdate:modelValue":o[0]||(o[0]=e=>ke.value=e),label:"防火墙状态",color:"primary"},null,8,["modelValue"])]),(0,a.createElementVNode)("div",v,[(0,a.createElementVNode)("div",p,[(0,a.createVNode)(fe,{modelValue:t.value.LimitIPFrequency,"onUpdate:modelValue":o[1]||(o[1]=e=>t.value.LimitIPFrequency=e),modelModifiers:{number:!0},type:"number",dense:"",outlined:"",prefix:"单IP访问频次：每",suffix:"秒内"},null,8,["modelValue"])]),(0,a.createElementVNode)("div",V,[(0,a.createVNode)(fe,{modelValue:t.value.LimitIPRequestTimes,"onUpdate:modelValue":o[2]||(o[2]=e=>t.value.LimitIPRequestTimes=e),modelModifiers:{number:!0},type:"number",dense:"",outlined:"",prefix:"最大请求",suffix:"次"},null,8,["modelValue"])]),(0,a.createElementVNode)("div",g,[(0,a.createVNode)(fe,{modelValue:t.value.BanIPTimespan,"onUpdate:modelValue":o[3]||(o[3]=e=>t.value.BanIPTimespan=e),modelModifiers:{number:!0},type:"number",dense:"",outlined:"",prefix:"冻结该IP",suffix:"分钟"},null,8,["modelValue"])]),(0,a.createElementVNode)("div",N,[(0,a.createVNode)(fe,{modelValue:t.value.LimitIPInterceptTimes,"onUpdate:modelValue":o[4]||(o[4]=e=>t.value.LimitIPInterceptTimes=e),modelModifiers:{number:!0},type:"number",dense:"",outlined:"",prefix:"拦截次数达到",suffix:"次，上报防火墙永久冻结该IP"},null,8,["modelValue"])])]),(0,a.createElementVNode)("div",h,[(0,a.createElementVNode)("div",f,[(0,a.createVNode)(Ce,{modelValue:t.value.ChallengeMode,"onUpdate:modelValue":o[5]||(o[5]=e=>t.value.ChallengeMode=e),options:we,label:"挑战模式",dense:"",outlined:"","emit-value":"","map-options":""},null,8,["modelValue"])]),"CloudflareTurnstileChallenge"===t.value.ChallengeMode?((0,a.openBlock)(),(0,a.createElementBlock)("div",C,[(0,a.createVNode)(fe,{autogrow:"",modelValue:t.value.TurnstileClientKey,"onUpdate:modelValue":o[6]||(o[6]=e=>t.value.TurnstileClientKey=e),label:"Cloudflare客户端公钥",placeholder:"0x4AAAAAAAAu4dr4wC-ZVpPT",dense:"",outlined:""},null,8,["modelValue"])])):(0,a.createCommentVNode)("",!0),"CloudflareTurnstileChallenge"===t.value.ChallengeMode?((0,a.openBlock)(),(0,a.createElementBlock)("div",w,[(0,a.createVNode)(fe,{autogrow:"",modelValue:t.value.TurnstileSecretKey,"onUpdate:modelValue":o[7]||(o[7]=e=>t.value.TurnstileSecretKey=e),label:"Cloudflare服务端密钥",placeholder:"0x4AAAAAAAAu4eDk4a2NvM91-OoOptBYl5Y",dense:"",outlined:""},null,8,["modelValue"]),t.value.TurnstileSecretKey&&t.value.TurnstileClientKey?(0,a.createCommentVNode)("",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",b,[...o[28]||(o[28]=[(0,a.createTextVNode)(" 温馨提示：请先到 ",-1),(0,a.createElementVNode)("a",{href:"https://dash.cloudflare.com/",target:"_blank"},"Cloudflare Turnstile",-1),(0,a.createTextVNode)(" 生成站点密钥。 ",-1)])]))])):(0,a.createCommentVNode)("",!0),t.value.ChallengeMode?((0,a.openBlock)(),(0,a.createElementBlock)("div",x,[(0,a.createVNode)(Ce,{modelValue:t.value.ChallengeRule,"onUpdate:modelValue":o[8]||(o[8]=e=>t.value.ChallengeRule=e),options:be,dense:"",outlined:"","emit-value":"","map-options":"",prefix:"启用规则:"},null,8,["modelValue"])])):(0,a.createCommentVNode)("",!0),"Region"===t.value.ChallengeRule&&t.value.ChallengeMode?((0,a.openBlock)(),(0,a.createElementBlock)("div",y,[(0,a.createVNode)(fe,{modelValue:t.value.ChallengeRegions,"onUpdate:modelValue":o[9]||(o[9]=e=>t.value.ChallengeRegions=e),label:"地区限制",placeholder:"竖线分隔，支持国家、地区、城市、运营商、ASN",dense:"",outlined:""},null,8,["modelValue"])])):(0,a.createCommentVNode)("",!0),"Region"===t.value.ChallengeRule&&t.value.ChallengeMode?((0,a.openBlock)(),(0,a.createElementBlock)("div",k,[(0,a.createVNode)(Ce,{modelValue:t.value.ChallengeRegionLimitMode,"onUpdate:modelValue":o[10]||(o[10]=e=>t.value.ChallengeRegionLimitMode=e),options:xe,label:"限制模式",dense:"",outlined:"","emit-value":"","map-options":""},null,8,["modelValue"])])):(0,a.createCommentVNode)("",!0)]),(0,a.createElementVNode)("div",E,[(0,a.createElementVNode)("div",A,[(0,a.createVNode)(fe,{autogrow:"",modelValue:t.value.DenyArea,"onUpdate:modelValue":o[11]||(o[11]=e=>t.value.DenyArea=e),label:"受限制的地区或运营商",placeholder:"禁止访问的地区，逗号分隔,如：江苏,苏州,移动,AS2333,DMIT，支持地区、运营商、ASN、机房名称",dense:"",outlined:""},null,8,["modelValue"])]),(0,a.createElementVNode)("div",R,[(0,a.createVNode)(fe,{autogrow:"",modelValue:t.value.AllowedArea,"onUpdate:modelValue":o[12]||(o[12]=e=>t.value.AllowedArea=e),label:"不受限制的地区或运营商",placeholder:"不受访问限制的地区或网络，逗号分隔，支持地区、运营商、ASN、机房名称",dense:"",outlined:""},null,8,["modelValue"])])]),(0,a.createElementVNode)("div",_,[(0,a.createElementVNode)("div",I,[(0,a.createVNode)(fe,{autogrow:"",modelValue:t.value.AttackRedirects,"onUpdate:modelValue":o[13]||(o[13]=e=>t.value.AttackRedirects=e),label:"攻击重定向",placeholder:"检测到CC攻击时，将请求重定向到指定URL，一行一个",dense:"",outlined:""},null,8,["modelValue"])]),(0,a.createElementVNode)("div",q,[(0,a.createVNode)(fe,{autogrow:"",modelValue:t.value.BlockHeaderValues,"onUpdate:modelValue":o[14]||(o[14]=e=>t.value.BlockHeaderValues=e),label:"屏蔽固定的请求头值",placeholder:"禁止的HeaderValues，竖线分隔",dense:"",outlined:""},null,8,["modelValue"])])]),(0,a.createElementVNode)("div",P,[(0,a.createElementVNode)("div",U,[(0,a.createVNode)(fe,{autogrow:"",modelValue:t.value.UserAgentBlocked,"onUpdate:modelValue":o[15]||(o[15]=e=>t.value.UserAgentBlocked=e),label:"UA标识限制",placeholder:"禁止的UserAgent，逗号分隔(MicroMessenger,QQ)",dense:"",outlined:""},null,8,["modelValue"])])])]),_:1})]),_:1}),(0,a.createVNode)(We,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ie,null,{default:(0,a.withCtx)(()=>[o[31]||(o[31]=(0,a.createElementVNode)("div",{class:"text-h6 q-mb-md"},"提示信息配置",-1)),(0,a.createElementVNode)("div",B,[o[29]||(o[29]=(0,a.createElementVNode)("div",{class:"text-subtitle1 q-mb-sm"},"受限制提示语：",-1)),(0,a.createElementVNode)("div",{ref_key:"accessDenyTipsEditor",ref:Ne,class:"editor-container",style:{height:"200px"}},null,512)]),(0,a.createElementVNode)("div",T,[o[30]||(o[30]=(0,a.createElementVNode)("div",{class:"text-subtitle1 q-mb-sm"},"UA限制提示语：",-1)),(0,a.createElementVNode)("div",{ref_key:"userAgentBlockedMsgEditor",ref:he,class:"editor-container",style:{height:"400px"}},null,512)])]),_:1})]),_:1}),(0,a.createVNode)(We,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ie,null,{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",D,[(0,a.createVNode)(Ye,{name:"security",class:"q-mr-sm"}),o[32]||(o[32]=(0,a.createTextVNode)(" 拦截日志 ",-1)),le.value>0?((0,a.openBlock)(),(0,a.createBlock)(Je,{key:0,color:"negative","text-color":"white",label:`累计拦截 ${le.value} 次`,class:"q-ml-sm"},null,8,["label"])):(0,a.createCommentVNode)("",!0)]),0===l.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",S," 暂无拦截日志 ")):((0,a.openBlock)(),(0,a.createElementBlock)("div",M,[(0,a.createElementVNode)("div",L,[(0,a.createElementVNode)("div",Q,[(0,a.createVNode)(r,{color:"negative",icon:"delete",label:"清空日志",loading:re.value},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ge,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(We,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ie,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ye,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),o[33]||(o[33]=(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("div",{class:"text-h6"},"确认清空拦截日志吗？"),(0,a.createElementVNode)("div",{class:"text-subtitle2"},"清空后将无法恢复！")],-1))]),_:1}),(0,a.createVNode)($e,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(r,{color:"negative",label:"确认",onClick:Pe},null,512),[[rt]]),(0,a.withDirectives)((0,a.createVNode)(r,{color:"primary",label:"取消"},null,512),[[rt]])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),(0,a.createElementVNode)("div",O,[(0,a.createVNode)(c,{modelValue:ne.value,"onUpdate:modelValue":[o[16]||(o[16]=e=>ne.value=e),Te],label:"按IP去重"},null,8,["modelValue"])]),(0,a.createElementVNode)("div",K,[(0,a.createVNode)(r,{color:"primary",icon:"refresh",label:"刷新",onClick:qe,loading:oe.value},null,8,["loading"])]),(0,a.createElementVNode)("div",H,[(0,a.createVNode)(fe,{autofocus:"",modelValue:Re.value,"onUpdate:modelValue":o[18]||(o[18]=e=>Re.value=e),dense:"",outlined:"",placeholder:"搜索IP、请求URL、来源URL、UserAgent、备注",onKeyup:(0,a.withKeys)(qe,["enter"]),debounce:"100"},{prepend:(0,a.withCtx)(()=>[(0,a.createVNode)(Ye,{name:"search",class:"cursor-pointer"})]),append:(0,a.withCtx)(()=>[Re.value?((0,a.openBlock)(),(0,a.createBlock)(Ye,{key:0,name:"close",class:"cursor-pointer",onClick:o[17]||(o[17]=e=>Re.value="")})):(0,a.createCommentVNode)("",!0)]),_:1},8,["modelValue"])])]),(0,a.createVNode)(et,{ref:"tableRef",data:_e.value,stripe:"",border:"",loading:oe.value},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Xe,{field:"IP",title:"IP地址",width:"160",sortable:""},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("a",{href:`/tools/ip/${e.IP}`,target:"_blank",class:"text-primary text-weight-bold"},(0,a.toDisplayString)(e.IP),9,j),(0,a.createVNode)(r,{color:"positive",icon:"security",dense:"",flat:"",size:"sm"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ze,{class:"bg-indigo"},{default:(0,a.withCtx)(()=>[...o[34]||(o[34]=[(0,a.createTextVNode)("添加到白名单",-1)])]),_:1}),(0,a.createVNode)(Ge,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(We,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ie,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ye,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),o[35]||(o[35]=(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("div",{class:"text-h6"},"确认操作"),(0,a.createElementVNode)("div",{class:"text-subtitle2"}," 此操作将标记该用户IP为白名单，是否继续？ ")],-1))]),_:1}),(0,a.createVNode)($e,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(r,{flat:"",label:"确认",color:"negative",onClick:t=>Ke(e.IP)},null,8,["onClick"]),[[rt]]),(0,a.withDirectives)((0,a.createVNode)(r,{flat:"",label:"取消",color:"primary"},null,512),[[rt]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),(0,a.createVNode)(Xe,{field:"Address",title:"IP地理位置",width:"180"}),(0,a.createVNode)(Xe,{field:"RequestUrl",title:"请求URL","min-width":"200"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("a",{href:e.RequestUrl,target:"_blank",class:"text-primary"},(0,a.toDisplayString)(e.RequestUrl),9,F)]),_:1}),(0,a.createVNode)(Xe,{field:"Referer",title:"来源URL",width:"200"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("a",{href:e.Referer,target:"_blank",class:"text-primary"},(0,a.toDisplayString)(e.Referer),9,z)]),_:1}),(0,a.createVNode)(Xe,{field:"UserAgent",title:"UserAgent",width:"200"}),(0,a.createVNode)(Xe,{field:"Time",title:"拦截时间",width:"120",sortable:""},{default:(0,a.withCtx)(({row:e})=>[(0,a.createTextVNode)((0,a.toDisplayString)(Fe(e.Time)),1)]),_:1}),(0,a.createVNode)(Xe,{field:"Remark",title:"备注",width:"120"}),(0,a.createVNode)(Xe,{width:"40",align:"center"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(r,{color:"info",icon:"visibility",dense:"",flat:"",size:"sm",onClick:t=>je(e.Headers)},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ze,{class:"bg-green"},{default:(0,a.withCtx)(()=>[...o[36]||(o[36]=[(0,a.createTextVNode)("查看请求头",-1)])]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","loading"]),(0,a.createElementVNode)("div",W,[(0,a.createElementVNode)("div",Y,[(0,a.createElementVNode)("span",J," 共 "+(0,a.toDisplayString)(Ee.value.length)+" 条记录，当前显示第 "+(0,a.toDisplayString)((se.value-1)*ce.value+1)+" - "+(0,a.toDisplayString)(Math.min(se.value*ce.value,Ee.value.length))+" 条 ",1)]),(0,a.createElementVNode)("div",$,[(0,a.createVNode)(tt,{modelValue:se.value,"onUpdate:modelValue":[o[19]||(o[19]=e=>se.value=e),Ue],max:Ae.value,"max-pages":6,"direction-links":"","boundary-links":"",color:"primary"},null,8,["modelValue","max"])]),(0,a.createElementVNode)("div",G,[(0,a.createVNode)(Ce,{modelValue:ce.value,"onUpdate:modelValue":[o[20]||(o[20]=e=>ce.value=e),Be],options:de,dense:"",outlined:"",label:"每页显示","emit-value":"","map-options":""},null,8,["modelValue"])])])]))]),_:1})]),_:1}),n.value.length>0?((0,a.openBlock)(),(0,a.createBlock)(We,{key:0,flat:"",bordered:""},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ie,null,{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",Z,[(0,a.createVNode)(Ye,{name:"leaderboard",class:"q-mr-sm"}),o[37]||(o[37]=(0,a.createTextVNode)(" 拦截次数排行榜 ",-1))]),(0,a.createVNode)(et,{data:n.value,stripe:"",border:""},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Xe,{field:"index",title:"序号",width:"80",align:"center"},{default:(0,a.withCtx)(({$rowIndex:e})=>[(0,a.createVNode)(lt,{color:e+1<=3?"negative":"grey",label:e+1},null,8,["color","label"])]),_:1}),(0,a.createVNode)(Xe,{field:"Key",title:"IP地址"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("a",{href:`https://ipinfo.io/${e.Key}`,target:"_blank",class:"text-primary text-weight-bold"},(0,a.toDisplayString)(e.Key),9,X),(0,a.createVNode)(r,{color:"negative",icon:"block",dense:"",flat:"",size:"sm",class:"q-ml-sm"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ze,{class:"bg-red"},{default:(0,a.withCtx)(()=>[...o[38]||(o[38]=[(0,a.createTextVNode)("添加到黑名单",-1)])]),_:1}),(0,a.createVNode)(Ge,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(We,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ie,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ye,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),o[39]||(o[39]=(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("div",{class:"text-h6"},"确认操作"),(0,a.createElementVNode)("div",{class:"text-subtitle2"}," 此操作将标记该用户IP为黑名单，是否继续？ ")],-1))]),_:1}),(0,a.createVNode)($e,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(r,{flat:"",label:"确认",color:"negative",onClick:t=>He(e.Key)},null,8,["onClick"]),[[rt]]),(0,a.withDirectives)((0,a.createVNode)(r,{flat:"",label:"取消",color:"primary"},null,512),[[rt]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),(0,a.createVNode)(Xe,{field:"Count",title:"拦截次数",sortable:"",align:"center"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(Je,{color:"negative","text-color":"white",label:e.Count},null,8,["label"])]),_:1}),(0,a.createVNode)(Xe,{field:"Address",title:"地理位置"}),(0,a.createVNode)(Xe,{field:"Start",title:"拦截开始时间",width:"160",sortable:""},{default:(0,a.withCtx)(({row:e})=>[(0,a.createTextVNode)((0,a.toDisplayString)(ze(e.Start)),1)]),_:1}),(0,a.createVNode)(Xe,{field:"End",title:"拦截截止时间",width:"160",sortable:""},{default:(0,a.withCtx)(({row:e})=>[(0,a.createTextVNode)((0,a.toDisplayString)(ze(e.End)),1)]),_:1}),(0,a.createVNode)(Xe,{field:"Continue",title:"持续时长"})]),_:1},8,["data"])]),_:1})]),_:1})):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(ot,{modelValue:ie.value,"onUpdate:modelValue":o[22]||(o[22]=e=>ie.value=e)},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(We,{style:{width:"60vw"}},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ie,{class:"row items-center q-pb-none"},{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",ee,(0,a.toDisplayString)(me.value),1),(0,a.createVNode)(at),(0,a.createVNode)(r,{icon:"close",flat:"",round:"",dense:"",onClick:Oe})]),_:1}),(0,a.createVNode)(Ie,{class:"q-pt-none"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(fe,{autogrow:"",modelValue:ve.value,"onUpdate:modelValue":o[21]||(o[21]=e=>ve.value=e),placeholder:"请输入IP地址",hint:"IP地址段黑名单"===ue.value?"每行一条地址段，起始地址和结束地址用空格分隔开，其余信息也用空格分隔开":"多个IP之间用英文逗号分隔"},null,8,["modelValue","hint"])]),_:1}),(0,a.createVNode)($e,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(r,{flat:"",label:"取消",onClick:Oe}),(0,a.createVNode)(r,{color:"primary",label:"保存",onClick:Qe,loading:pe.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,a.createVNode)(ot,{modelValue:Ve.value,"onUpdate:modelValue":o[24]||(o[24]=e=>Ve.value=e)},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(We,{style:{"min-width":"600px"}},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ie,null,{default:(0,a.withCtx)(()=>[...o[40]||(o[40]=[(0,a.createElementVNode)("div",{class:"text-h6"},"请求头详情",-1)])]),_:1}),(0,a.createVNode)(Ie,null,{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("pre",te,(0,a.toDisplayString)(ge.value),1)]),_:1}),(0,a.createVNode)($e,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(r,{color:"negative",label:"关闭",onClick:o[23]||(o[23]=e=>Ve.value=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,a.createVNode)(ot,{modelValue:ye.value,"onUpdate:modelValue":o[26]||(o[26]=e=>ye.value=e)},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(We,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Ie,null,{default:(0,a.withCtx)(()=>[...o[41]||(o[41]=[(0,a.createElementVNode)("div",{class:"text-h6"},"确认关闭WAF防火墙吗？",-1)])]),_:1}),(0,a.createVNode)($e,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(r,{color:"negative",label:"确认",onClick:o[25]||(o[25]=e=>t.value.FirewallEnabled="false")},null,512),[[rt]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),ae=l(1317),oe=l(10258),re=l(20407),ne=l(63663),se=l(17180),ce=l(91343),de=l(38622),ie=l(40975),ue=l(64503),me=l(97491),ve=l(34854),pe=l(71248),Ve=l(76997),ge=l(74183),Ne=l(62373),he=l(51375),fe=l(25915),Ce=l(60515),we=l(22110),be=l.n(we);const xe=(0,ae.A)(le,[["__scopeId","data-v-6f93b4a5"]]);var ye=xe;be()(le,"components",{QBtnGroup:oe.A,QBtn:re.A,QCard:ne.A,QCardSection:se.A,QToggle:ce.A,QInput:de.A,QSelect:ie.A,QIcon:ue.A,QChip:me.A,QPopupProxy:ve.A,QCardActions:pe.A,QTooltip:Ve.A,QPagination:ge.A,QBadge:Ne.A,QDialog:he.A,QSpace:fe.A}),be()(le,"directives",{ClosePopup:Ce.A})}}]);
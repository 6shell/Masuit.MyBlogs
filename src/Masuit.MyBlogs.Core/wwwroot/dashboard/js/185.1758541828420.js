(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[185],{13986:function(e,t,o){"use strict";var a=o(74413),r=o(27454),n=o.n(r),s=o(76661),l=o(57695);const i=a.A.create({baseURL:s.c.baseURL,timeout:s.c.timeOut});i.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=n().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&l.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return l.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:l.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:l.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:l.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:l.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:l.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:l.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:l.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:l.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:l.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:l.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=i},42634:function(){},45860:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return D}});var a=o(74220),r=o(39798),n=o(97700),s=o(46732),l=o(75220),i=o(57695),u=o(13986);const c={class:"notice-write-page"},d={class:"row q-gutter-md items-center"},p={class:"col"},m={class:"row items-center justify-end"},v={class:"col"},b={class:"col text-right"};var f=(0,a.pM)({__name:"write",setup(e){const t=(0,l.lq)(),o=(0,l.rd)(),f=(0,s.KR)(),k=(0,s.KR)(!1),g=(0,s.KR)({Title:"",Content:"",StrongAlert:!1}),C=(0,s.KR)({from:"",to:""}),R=(0,a.EW)(()=>{if(C.value.from&&C.value.to){const e=C.value.from,t=C.value.to;return`${e} - ${t}`}return""}),y=async e=>{k.value=!0;const t=await u.A.get(`/notice/get/${e}`);t?.Success&&t.Data?(g.value=t.Data,t.Data.StartTime&&t.Data.EndTime&&(C.value={from:t.Data.StartTime,to:t.Data.EndTime})):i.oR.error("获取公告数据失败",{autoClose:2e3,position:"top-center"}),k.value=!1},h=()=>{C.value={from:"",to:""},g.value.StartTime=void 0,g.value.EndTime=void 0},A=e=>{const t=new Date;t.setHours(0,0,0,0);const o=new Date(e);return o>=t},q=async()=>{if(!g.value.Title||!g.value.Content)return void i.oR.error("请填写完整信息",{autoClose:2e3,position:"top-center"});k.value=!0;const e=g.value.Id?"/notice/edit":"/notice/write";g.value.StartTime=C.value.from||void 0,g.value.EndTime=C.value.to||void 0;const t=await u.A.post(e,g.value);t?.Success?(i.oR.success(t.Message||"操作成功",{autoClose:2e3,position:"top-center"}),o.push("/notice/list")):i.oR.error(t?.Message||"操作失败",{autoClose:2e3,position:"top-center"}),k.value=!1},T=()=>{o.push("/notice/list")};(0,a.sV)(()=>{const e=t.query.id;e&&y(Number(e)),document.querySelector(".q-page-container").addEventListener("scroll",_)}),(0,a.hi)(()=>{w&&clearTimeout(w),document.querySelector(".q-page-container").removeEventListener("scroll",_)});let w=null,F=!1;const _=()=>{w&&clearTimeout(w),w=setTimeout(()=>{x()},100)},x=()=>{if(null==f.value?.$el)return;const e=f.value.$el.querySelector(".edui-editor-toolbarbox");if(e){const t=f.value.$el.getBoundingClientRect(),o=t.top<84&&t.bottom>300;if(o&&!F){const t=f.value.$el.offsetWidth;e.style.cssText=`\n          position: fixed !important;\n          top: 84px !important;\n          z-index: 1000 !important;\n          width: ${t}px !important;\n          transition: all 0.5s ease !important;\n        `,F=!0}else!o&&F&&(e.style.cssText="\n          position: static !important;\n          top: auto !important;\n          z-index: auto !important;\n          width: auto !important;\n          transition: all 0.5s ease !important;\n        ",F=!1)}};return(e,t)=>{const o=(0,a.g2)("q-input"),s=(0,a.g2)("vue-ueditor-wrap"),l=(0,a.g2)("q-card-section"),i=(0,a.g2)("q-card"),u=(0,a.g2)("q-icon"),y=(0,a.g2)("q-btn"),w=(0,a.g2)("q-date"),F=(0,a.g2)("q-popup-proxy"),_=(0,a.g2)("q-checkbox"),x=(0,a.g2)("q-btn-group"),S=(0,a.g2)("q-form"),V=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.bF)(S,{onSubmit:q},{default:(0,a.k6)(()=>[(0,a.bF)(i,{flat:"",bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)(l,null,{default:(0,a.k6)(()=>[t[5]||(t[5]=(0,a.Lk)("div",{class:"text-h6"},"公告标题",-1)),(0,a.bF)(o,{dense:"",modelValue:g.value.Title,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value.Title=e),placeholder:"请输入公告标题",outlined:"",required:"",rules:[e=>!!e||"请输入公告标题"]},null,8,["modelValue","rules"]),t[6]||(t[6]=(0,a.Lk)("div",{class:"text-h6"},"公告内容",-1)),(0,a.bF)(s,{ref_key:"editor",ref:f,modelValue:g.value.Content,"onUpdate:modelValue":t[1]||(t[1]=e=>g.value.Content=e),config:{initialFrameHeight:250}},null,8,["modelValue"])]),_:1})]),_:1}),(0,a.bF)(i,{flat:"",bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)(l,null,{default:(0,a.k6)(()=>[t[8]||(t[8]=(0,a.Lk)("div",{class:"text-h6 q-mb-md"},"公告设置",-1)),(0,a.Lk)("div",d,[(0,a.Lk)("div",p,[(0,a.bF)(o,{dense:"",modelValue:R.value,"onUpdate:modelValue":t[3]||(t[3]=e=>R.value=e),label:"生效时间段",outlined:"",readonly:""},{prepend:(0,a.k6)(()=>[(0,a.bF)(u,{name:"schedule"})]),append:(0,a.k6)(()=>[(0,a.bF)(u,{name:"event",class:"cursor-pointer"},{default:(0,a.k6)(()=>[(0,a.bF)(F,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(()=>[(0,a.bF)(w,{modelValue:C.value,"onUpdate:modelValue":t[2]||(t[2]=e=>C.value=e),range:"",options:A},{default:(0,a.k6)(()=>[(0,a.Lk)("div",m,[(0,a.bo)((0,a.bF)(y,{label:"确定",color:"primary",flat:""},null,512),[[V]])])]),_:1},8,["modelValue"])]),_:1})]),_:1}),R.value?((0,a.uX)(),(0,a.Wv)(y,{key:0,flat:"",round:"",dense:"",icon:"clear",onClick:(0,r.D$)(h,["stop"])})):(0,a.Q3)("",!0)]),_:1},8,["modelValue"])]),(0,a.Lk)("div",v,[(0,a.bF)(_,{modelValue:g.value.StrongAlert,"onUpdate:modelValue":t[4]||(t[4]=e=>g.value.StrongAlert=e),label:"是否弹窗显示",color:"primary"},null,8,["modelValue"])]),(0,a.Lk)("div",b,[(0,a.bF)(x,null,{default:(0,a.k6)(()=>[(0,a.bF)(y,{type:"submit",color:"primary",icon:"send",loading:k.value,disable:!g.value.Title||!g.value.Content},{default:(0,a.k6)(()=>[(0,a.eW)((0,n.v_)(g.value.Id?"更新公告":"发布公告"),1)]),_:1},8,["loading","disable"]),(0,a.bF)(y,{color:"grey",icon:"arrow_back",onClick:T,outline:""},{default:(0,a.k6)(()=>[...t[7]||(t[7]=[(0,a.eW)(" 返回列表 ",-1)])]),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1})])}}}),k=o(1317),g=o(93483),C=o(63663),R=o(17180),y=o(38622),h=o(64503),A=o(34854),q=o(9341),T=o(20407),w=o(78495),F=o(10258),_=o(66284),x=o(60515),S=o(22110),V=o.n(S);const L=(0,k.A)(f,[["__scopeId","data-v-658f681b"]]);var D=L;V()(f,"components",{QForm:g.A,QCard:C.A,QCardSection:R.A,QInput:y.A,QIcon:h.A,QPopupProxy:A.A,QDate:q.A,QBtn:T.A,QCheckbox:w.A,QBtnGroup:F.A,QPageContainer:_.A}),V()(f,"directives",{ClosePopup:x.A})}}]);
(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[36],{253:function(){},3986:function(e,t,o){"use strict";var a=o(3719),r=o.n(a),l=o(7454),s=o.n(l),n=o(6661),c=o(7695);const i=r().create({baseURL:n.c.baseURL,timeout:n.c.timeOut});i.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=s().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&c.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return c.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:c.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:c.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:c.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:c.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:c.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:c.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:c.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:c.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:c.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:c.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=i},5987:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return S}});var a=o(4061),r=o(7695),l=o(3992),s=o(3986);const n={class:"merge-compare-container"},c={class:"q-mb-lg"},i={class:"q-gutter-md"},d={style:{width:"400px"}},u={class:"text-h6"},p={class:"row q-col-gutter-md"},m={class:"col-md-6 col-12"},v={key:0},C={class:"text-center q-mb-md"},h={class:"text-h6"},N=["innerHTML"],V={class:"col-md-6 col-12"},f={key:0},g={class:"text-center q-mb-md"},w={class:"text-h6"},b=["innerHTML"];var x=(0,a.defineComponent)({__name:"compare",setup(e){const t=(0,l.useRouter)(),o=(0,l.useRoute)(),x=(0,a.ref)(!1),k=(0,a.ref)(null),E=(0,a.ref)(null),R=(0,a.ref)(""),y=async()=>{x.value=!0;try{if(R.value=o.query.id,!R.value)return void r.oR.error("缺少合并ID参数",{autoClose:2e3,position:"top-center"});const e=await s.A.get(`/merge/compare/${R.value}`);e?.Data&&(k.value=e.Data.old,E.value=e.Data.newer)}catch(e){r.oR.error("加载对比数据失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading compare data:",e)}finally{x.value=!1}},_=async()=>{x.value=!0;const e=await s.A.post(`/merge/${R.value}`);r.oR.success(e?.Message||"合并成功",{autoClose:2e3,position:"top-center"}),t.push("/posts/merge"),x.value=!1},q=(0,a.ref)(""),A=async()=>{if(!q.value.trim())return void r.oR.error("请填写拒绝理由！",{autoClose:2e3,position:"top-center"});x.value=!0;const e=await s.A.post(`/merge/reject/${R.value}`,{reason:q.value});r.oR.success(e?.Message||"已拒绝合并",{autoClose:2e3,position:"top-center"}),t.push("/posts/merge"),x.value=!1},D=async()=>{x.value=!0;const e=await s.A.post(`/merge/block/${R.value}`);r.oR.success(e?.Message||"已标记为恶意修改",{autoClose:2e3,position:"top-center"}),t.push("/posts/merge"),x.value=!1};return(0,a.onMounted)(()=>{y()}),(e,t)=>{const o=(0,a.resolveComponent)("q-icon"),r=(0,a.resolveComponent)("q-card-section"),l=(0,a.resolveComponent)("q-btn"),s=(0,a.resolveComponent)("q-card-actions"),y=(0,a.resolveComponent)("q-card"),M=(0,a.resolveComponent)("q-popup-proxy"),T=(0,a.resolveComponent)("q-input"),B=(0,a.resolveComponent)("q-spinner"),Q=(0,a.resolveComponent)("q-inner-loading"),L=(0,a.resolveDirective)("close-popup");return(0,a.openBlock)(),(0,a.createElementBlock)("div",n,[(0,a.createElementVNode)("div",c,[(0,a.createElementVNode)("div",i,[(0,a.createVNode)(l,{color:"info",label:"接受合并",loading:x.value},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(M,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(y,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(r,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(o,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),t[1]||(t[1]=(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("div",{class:"text-h6"},"确认操作"),(0,a.createElementVNode)("div",{class:"text-subtitle2"},"此操作将直接合并该修改，是否继续？")],-1))]),_:1}),(0,a.createVNode)(s,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(l,{flat:"",label:"确认",color:"negative",onClick:_},null,512),[[L]]),(0,a.withDirectives)((0,a.createVNode)(l,{flat:"",label:"取消",color:"primary"},null,512),[[L]])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"]),(0,a.createVNode)(l,{color:"positive",label:"编辑并合并",to:`/posts/merge/edit?id=${R.value}`},null,8,["to"]),(0,a.createVNode)(l,{color:"negative",label:"拒绝合并",loading:x.value},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(M,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(y,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(r,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",d,[(0,a.createElementVNode)("div",u,[(0,a.createVNode)(o,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),t[2]||(t[2]=(0,a.createTextVNode)("拒绝合并理由：",-1))]),(0,a.createVNode)(T,{dense:"",autogrow:"",outlined:"",modelValue:q.value,"onUpdate:modelValue":t[0]||(t[0]=e=>q.value=e),placeholder:"请填写拒绝理由"},null,8,["modelValue"])])]),_:1}),(0,a.createVNode)(s,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(l,{flat:"",label:"确认",disabled:!q.value,color:"negative",onClick:A},null,8,["disabled"]),[[L]]),(0,a.withDirectives)((0,a.createVNode)(l,{flat:"",label:"取消",color:"primary"},null,512),[[L]])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"]),(0,a.createVNode)(l,{color:"warning",label:"标记为恶意修改",loading:x.value},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(M,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(y,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(r,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(o,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),t[3]||(t[3]=(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("div",{class:"text-h6"},"确认操作"),(0,a.createElementVNode)("div",{class:"text-subtitle2"},"此操作将标记该修改为恶意修改，是否继续？")],-1))]),_:1}),(0,a.createVNode)(s,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(l,{flat:"",label:"确认",color:"negative",onClick:D},null,512),[[L]]),(0,a.withDirectives)((0,a.createVNode)(l,{flat:"",label:"取消",color:"primary"},null,512),[[L]])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])])]),(0,a.createElementVNode)("div",p,[(0,a.createElementVNode)("div",m,[(0,a.createVNode)(y,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(r,null,{default:(0,a.withCtx)(()=>[t[4]||(t[4]=(0,a.createElementVNode)("h3",{class:"text-h5 q-mb-md"},"原文：",-1)),k.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",v,[(0,a.createElementVNode)("div",C,[(0,a.createElementVNode)("h4",h,(0,a.toDisplayString)(k.value.Title),1)]),(0,a.createElementVNode)("div",{class:"article-content",innerHTML:k.value.Content},null,8,N)])):(0,a.createCommentVNode)("",!0)]),_:1})]),_:1})]),(0,a.createElementVNode)("div",V,[(0,a.createVNode)(y,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(r,null,{default:(0,a.withCtx)(()=>[t[5]||(t[5]=(0,a.createElementVNode)("h3",{class:"text-h5 q-mb-md"},"修改后：",-1)),E.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",f,[(0,a.createElementVNode)("div",g,[(0,a.createElementVNode)("h4",w,(0,a.toDisplayString)(E.value.Title),1)]),(0,a.createElementVNode)("div",{class:"article-content",innerHTML:E.value.Content},null,8,b)])):(0,a.createCommentVNode)("",!0)]),_:1})]),_:1})])]),(0,a.createVNode)(Q,{showing:x.value},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(B,{color:"primary",size:"100px"})]),_:1},8,["showing"])])}}}),k=o(1317),E=o(407),R=o(4854),y=o(3663),_=o(7180),q=o(4503),A=o(1248),D=o(8622),M=o(9010),T=o(5485),B=o(515),Q=o(2110),L=o.n(Q);const O=(0,k.A)(x,[["__scopeId","data-v-68fb4316"]]);var S=O;L()(x,"components",{QBtn:E.A,QPopupProxy:R.A,QCard:y.A,QCardSection:_.A,QIcon:q.A,QCardActions:A.A,QInput:D.A,QInnerLoading:M.A,QSpinner:T.A}),L()(x,"directives",{ClosePopup:B.A})}}]);
(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[128],{13986:function(e,a,t){"use strict";var o=t(74413),l=t(27454),s=t.n(l),r=t(76661),n=t(57695);const i=o.A.create({baseURL:r.c.baseURL,timeout:r.c.timeOut});i.interceptors.request.use(e=>{const a=sessionStorage.getItem("access_token");if(a&&(e.headers.Authorization="Bearer "+a),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=s().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&n.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return n.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:n.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:n.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:n.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:n.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:n.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:n.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:n.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:n.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:n.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:n.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),a.A=i},40831:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return te}});var o=t(74220),l=t(97700),s=t(46732),r=t(57695),n=t(88828),i=t.n(n),c=t(13986);const d={class:"search-analysis-container"},u={class:"row"},k={class:"col-12"},p={class:"row"},w={class:"col"},b={class:"text-right"},f={class:"q-mt-md"},g=["href"],v={class:"ip-info"},h=["href"],y={class:"region-info"},m={class:"q-mt-md flex justify-center items-center"},_={class:"q-mt-lg"},F={class:"row q-gutter-md"},C={key:0,class:"col-md"},x=["href"],L={key:1,class:"col-md"},R=["href"],P={key:2,class:"col-md"},K=["href"],A={class:"row q-gutter-md q-mt-md"},q={key:0,class:"col-md"},Q=["href"],M={key:1,class:"col-md"},I=["href"],T={key:2,class:"col-md"},E=["href"];var S=(0,o.pM)({__name:"index",setup(e){const a=(0,s.KR)(!1),t=(0,s.KR)(!1),n=(0,s.KR)([]),S=(0,s.KR)(""),$=(0,s.KR)({page:1,rowsPerPage:10,total:0}),V=(0,s.KR)({month:[],week:[],today:[],wish_month:[],wish_week:[],wish_today:[]}),D=(0,s.KR)(null),O=[{name:"index",label:"序号",field:"index",align:"center"},{name:"keywords",label:"关键词",field:"Keywords",align:"left"},{name:"count",label:"搜索次数",field:"Count",align:"center"}],W=[{name:"keywords",label:"关键词",field:"Keywords",align:"left"},{name:"count",label:"搜索次数",field:"Count",align:"center"}],X=e=>e?i()(e).format("YYYY-MM-DD HH:mm:ss"):"",j=(e,a=0)=>null===e||void 0===e?"0":Number(e).toFixed(a),N=async()=>{try{const e=await c.A.get("/search/HotKey");e?.Success&&e.Data?V.value=e.Data:r.oR.error(e?.Message||"获取热词数据失败",{autoClose:2e3,position:"top-center"})}catch(e){r.oR.error("获取热词数据失败",{autoClose:2e3,position:"top-center"})}},U=async()=>{a.value=!0;try{const e={page:$.value.page,size:$.value.rowsPerPage,search:S.value||""},a=await c.A.post("/search/SearchList",null,{params:e});a&&a.TotalCount>0?(n.value=a.Data||[],$.value.total=a.TotalCount||0):(n.value=[],$.value.total=0,a?.Message&&r.oR.warning(a.Message,{autoClose:2e3,position:"top-center"}))}catch(e){r.oR.error("加载数据失败",{autoClose:2e3,position:"top-center"}),n.value=[],$.value.total=0}finally{a.value=!1}},z=()=>{$.value.page=1,U()},B=async e=>{const a=await c.A.post(`/system/AddToBlackList/${e}`);r.oR.success(a?.Message||"已加入黑名单",{autoClose:2e3,position:"top-center"})},H=async e=>{t.value=!0;try{const a=await c.A.post(`/search/delete/${e}`);a?.Success?(r.oR.success(a.Message||"删除成功",{autoClose:2e3,position:"top-center"}),await U()):r.oR.error(a?.Message||"删除失败",{autoClose:2e3,position:"top-center"})}catch(a){r.oR.error("删除失败",{autoClose:2e3,position:"top-center"})}finally{t.value=!1}};return(0,o.sV)(async()=>{await N(),await U()}),(e,t)=>{const s=(0,o.g2)("q-btn"),r=(0,o.g2)("q-icon"),i=(0,o.g2)("q-input"),c=(0,o.g2)("vxe-column"),N=(0,o.g2)("q-tooltip"),Y=(0,o.g2)("q-card-section"),J=(0,o.g2)("q-card-actions"),G=(0,o.g2)("q-card"),Z=(0,o.g2)("q-popup-proxy"),ee=(0,o.g2)("vxe-table"),ae=(0,o.g2)("q-pagination"),te=(0,o.g2)("q-select"),oe=(0,o.g2)("q-td"),le=(0,o.g2)("q-table"),se=(0,o.gN)("close-popup");return(0,o.uX)(),(0,o.CE)("div",d,[(0,o.bF)(G,null,{default:(0,o.k6)(()=>[(0,o.bF)(Y,null,{default:(0,o.k6)(()=>[(0,o.Lk)("div",u,[(0,o.Lk)("div",k,[(0,o.Lk)("div",p,[(0,o.Lk)("div",w,[(0,o.bF)(s,{color:"info",icon:"refresh",onClick:U,loading:a.value,class:"q-mr-md"},{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.eW)(" 刷新 ",-1)])]),_:1},8,["loading"])]),(0,o.Lk)("div",b,[(0,o.bF)(i,{modelValue:S.value,"onUpdate:modelValue":[t[0]||(t[0]=e=>S.value=e),U],placeholder:"全局搜索",outlined:"",dense:"",clearable:"",class:"search-input",debounce:"500"},{prepend:(0,o.k6)(()=>[(0,o.bF)(r,{name:"search"})]),_:1},8,["modelValue"])])])])]),(0,o.Lk)("div",f,[(0,o.bF)(ee,{ref_key:"tableRef",ref:D,data:n.value,loading:a.value,stripe:"",border:""},{default:(0,o.k6)(()=>[(0,o.bF)(c,{field:"Keywords",title:"关键词"},{default:(0,o.k6)(({row:e})=>[(0,o.Lk)("a",{href:`/search/${e.Keywords}`,target:"_blank",class:"keyword-link"},(0,l.v_)(e.Keywords),9,g)]),_:1}),(0,o.bF)(c,{field:"SearchTime",title:"搜索时间",width:"180"},{default:(0,o.k6)(({row:e})=>[(0,o.eW)((0,l.v_)(X(e.SearchTime)),1)]),_:1}),(0,o.bF)(c,{field:"ResultCount",title:"结果集数量",width:"120"}),(0,o.bF)(c,{field:"Elapsed",title:"搜索耗时",width:"120"},{default:(0,o.k6)(({row:e})=>[(0,o.eW)((0,l.v_)(j(e.Elapsed,2))+" ms ",1)]),_:1}),(0,o.bF)(c,{field:"IP",title:"客户端IP","min-width":"200"},{default:(0,o.k6)(({row:e})=>[(0,o.Lk)("div",v,[(0,o.Lk)("a",{href:`/tools/ip?ip=${e.IP}`,target:"_blank",class:"ip-link"},(0,l.v_)(e.IP),9,h),(0,o.Lk)("span",y,"("+(0,l.v_)(e.Region)+")",1),(0,o.bF)(s,{color:"negative",icon:"block",dense:"",flat:"",size:"sm",class:"q-ml-sm"},{default:(0,o.k6)(()=>[(0,o.bF)(N,{class:"bg-red"},{default:(0,o.k6)(()=>[...t[4]||(t[4]=[(0,o.eW)("添加到黑名单",-1)])]),_:1}),(0,o.bF)(Z,{"transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(()=>[(0,o.bF)(G,null,{default:(0,o.k6)(()=>[(0,o.bF)(Y,{class:"row items-center"},{default:(0,o.k6)(()=>[(0,o.bF)(r,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),t[5]||(t[5]=(0,o.Lk)("div",null,[(0,o.Lk)("div",{class:"text-h6"},"确认操作"),(0,o.Lk)("div",{class:"text-subtitle2"},"此操作将标记该用户IP为黑名单，是否继续？")],-1))]),_:1}),(0,o.bF)(J,{align:"right"},{default:(0,o.k6)(()=>[(0,o.bo)((0,o.bF)(s,{flat:"",label:"确认",color:"negative",onClick:a=>B(e.IP)},null,8,["onClick"]),[[se]]),(0,o.bo)((0,o.bF)(s,{flat:"",label:"取消",color:"primary"},null,512),[[se]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:1}),(0,o.bF)(c,{title:"操作",width:"70",fixed:"right"},{default:(0,o.k6)(({row:e})=>[(0,o.bF)(s,{dense:"",flat:"",color:"negative",icon:"delete"},{default:(0,o.k6)(()=>[(0,o.bF)(N,null,{default:(0,o.k6)(()=>[...t[6]||(t[6]=[(0,o.eW)("删除",-1)])]),_:1}),(0,o.bF)(Z,{"transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(()=>[(0,o.bF)(G,null,{default:(0,o.k6)(()=>[(0,o.bF)(Y,{class:"row items-center"},{default:(0,o.k6)(()=>[(0,o.bF)(r,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),t[7]||(t[7]=(0,o.Lk)("div",null,[(0,o.Lk)("div",{class:"text-h6"},"确认删除"),(0,o.Lk)("div",{class:"text-subtitle2"},"确认删除这条记录吗？")],-1))]),_:1}),(0,o.bF)(J,{align:"right"},{default:(0,o.k6)(()=>[(0,o.bo)((0,o.bF)(s,{flat:"",label:"确认",color:"negative",onClick:a=>H(e.Id)},null,8,["onClick"]),[[se]]),(0,o.bo)((0,o.bF)(s,{flat:"",label:"取消",color:"primary"},null,512),[[se]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data","loading"]),(0,o.Lk)("div",m,[(0,o.bF)(ae,{"max-pages":"6",modelValue:$.value.page,"onUpdate:modelValue":[t[1]||(t[1]=e=>$.value.page=e),U],max:Math.ceil($.value.total/$.value.rowsPerPage),"direction-links":""},null,8,["modelValue","max"]),(0,o.bF)(te,{modelValue:$.value.rowsPerPage,"onUpdate:modelValue":[t[2]||(t[2]=e=>$.value.rowsPerPage=e),z],options:[10,15,20,30,50,100,200],dense:"",outlined:"",style:{width:"80px"},class:"q-ml-md"},null,8,["modelValue"])])])]),_:1})]),_:1}),(0,o.Lk)("div",_,[(0,o.Lk)("div",F,[V.value.month&&V.value.month.length>0?((0,o.uX)(),(0,o.CE)("div",C,[(0,o.bF)(G,null,{default:(0,o.k6)(()=>[(0,o.bF)(Y,{class:"text-center"},{default:(0,o.k6)(()=>[...t[8]||(t[8]=[(0,o.Lk)("div",{class:"text-h6"},"月度搜索排行",-1)])]),_:1}),(0,o.bF)(Y,null,{default:(0,o.k6)(()=>[(0,o.bF)(le,{rows:V.value.month,columns:O,"row-key":"Keywords","hide-pagination":"",pagination:{rowsPerPage:0},flat:""},{"body-cell-index":(0,o.k6)(e=>[(0,o.bF)(oe,{props:e},{default:(0,o.k6)(()=>[(0,o.eW)((0,l.v_)(e.rowIndex+1),1)]),_:2},1032,["props"])]),"body-cell-keywords":(0,o.k6)(e=>[(0,o.bF)(oe,{props:e},{default:(0,o.k6)(()=>[(0,o.Lk)("a",{href:`/search/${e.row.Keywords}`,target:"_blank",class:"keyword-link"},(0,l.v_)(e.row.Keywords),9,x)]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1})]),_:1})])):(0,o.Q3)("",!0),V.value.week&&V.value.week.length>0?((0,o.uX)(),(0,o.CE)("div",L,[(0,o.bF)(G,null,{default:(0,o.k6)(()=>[(0,o.bF)(Y,{class:"text-center"},{default:(0,o.k6)(()=>[...t[9]||(t[9]=[(0,o.Lk)("div",{class:"text-h6"},"本周搜索排行",-1)])]),_:1}),(0,o.bF)(Y,null,{default:(0,o.k6)(()=>[(0,o.bF)(le,{rows:V.value.week,columns:W,"row-key":"Keywords","hide-pagination":"",pagination:{rowsPerPage:0},flat:""},{"body-cell-keywords":(0,o.k6)(e=>[(0,o.bF)(oe,{props:e},{default:(0,o.k6)(()=>[(0,o.Lk)("a",{href:`/search/${e.row.Keywords}`,target:"_blank",class:"keyword-link"},(0,l.v_)(e.row.Keywords),9,R)]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1})]),_:1})])):(0,o.Q3)("",!0),V.value.today&&V.value.today.length>0?((0,o.uX)(),(0,o.CE)("div",P,[(0,o.bF)(G,null,{default:(0,o.k6)(()=>[(0,o.bF)(Y,{class:"text-center"},{default:(0,o.k6)(()=>[...t[10]||(t[10]=[(0,o.Lk)("div",{class:"text-h6"},"今日搜索排行",-1)])]),_:1}),(0,o.bF)(Y,null,{default:(0,o.k6)(()=>[(0,o.bF)(le,{rows:V.value.today,columns:W,"row-key":"Keywords","hide-pagination":"",pagination:{rowsPerPage:0},flat:""},{"body-cell-keywords":(0,o.k6)(e=>[(0,o.bF)(oe,{props:e},{default:(0,o.k6)(()=>[(0,o.Lk)("a",{href:`/search/${e.row.Keywords}`,target:"_blank",class:"keyword-link"},(0,l.v_)(e.row.Keywords),9,K)]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1})]),_:1})])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",A,[V.value.wish_month&&V.value.wish_month.length>0?((0,o.uX)(),(0,o.CE)("div",q,[(0,o.bF)(G,null,{default:(0,o.k6)(()=>[(0,o.bF)(Y,{class:"text-center"},{default:(0,o.k6)(()=>[...t[11]||(t[11]=[(0,o.Lk)("div",{class:"text-h6"},"月度搜索排行",-1),(0,o.Lk)("div",{class:"text-caption text-grey-6"},"(搜索结果为0的热词)",-1)])]),_:1}),(0,o.bF)(Y,null,{default:(0,o.k6)(()=>[(0,o.bF)(le,{rows:V.value.wish_month,columns:O,"row-key":"Keywords","hide-pagination":"",pagination:{rowsPerPage:0},flat:""},{"body-cell-index":(0,o.k6)(e=>[(0,o.bF)(oe,{props:e},{default:(0,o.k6)(()=>[(0,o.eW)((0,l.v_)(e.rowIndex+1),1)]),_:2},1032,["props"])]),"body-cell-keywords":(0,o.k6)(e=>[(0,o.bF)(oe,{props:e},{default:(0,o.k6)(()=>[(0,o.Lk)("a",{href:`/search/${e.row.Keywords}`,target:"_blank",class:"keyword-link"},(0,l.v_)(e.row.Keywords),9,Q)]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1})]),_:1})])):(0,o.Q3)("",!0),V.value.wish_week&&V.value.wish_week.length>0?((0,o.uX)(),(0,o.CE)("div",M,[(0,o.bF)(G,null,{default:(0,o.k6)(()=>[(0,o.bF)(Y,{class:"text-center"},{default:(0,o.k6)(()=>[...t[12]||(t[12]=[(0,o.Lk)("div",{class:"text-h6"},"本周搜索排行",-1),(0,o.Lk)("div",{class:"text-caption text-grey-6"},"(搜索结果为0的热词)",-1)])]),_:1}),(0,o.bF)(Y,null,{default:(0,o.k6)(()=>[(0,o.bF)(le,{rows:V.value.wish_week,columns:W,"row-key":"Keywords","hide-pagination":"",pagination:{rowsPerPage:0},flat:""},{"body-cell-keywords":(0,o.k6)(e=>[(0,o.bF)(oe,{props:e},{default:(0,o.k6)(()=>[(0,o.Lk)("a",{href:`/search/${e.row.Keywords}`,target:"_blank",class:"keyword-link"},(0,l.v_)(e.row.Keywords),9,I)]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1})]),_:1})])):(0,o.Q3)("",!0),V.value.wish_today&&V.value.wish_today.length>0?((0,o.uX)(),(0,o.CE)("div",T,[(0,o.bF)(G,null,{default:(0,o.k6)(()=>[(0,o.bF)(Y,{class:"text-center"},{default:(0,o.k6)(()=>[...t[13]||(t[13]=[(0,o.Lk)("div",{class:"text-h6"},"今日搜索排行",-1),(0,o.Lk)("div",{class:"text-caption text-grey-6"},"(搜索结果为0的热词)",-1)])]),_:1}),(0,o.bF)(Y,null,{default:(0,o.k6)(()=>[(0,o.bF)(le,{rows:V.value.wish_today,columns:W,"row-key":"Keywords","hide-pagination":"",pagination:{rowsPerPage:0},flat:""},{"body-cell-keywords":(0,o.k6)(e=>[(0,o.bF)(oe,{props:e},{default:(0,o.k6)(()=>[(0,o.Lk)("a",{href:`/search/${e.row.Keywords}`,target:"_blank",class:"keyword-link"},(0,l.v_)(e.row.Keywords),9,E)]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1})]),_:1})])):(0,o.Q3)("",!0)])])])}}}),$=t(1317),V=t(63663),D=t(17180),O=t(20407),W=t(38622),X=t(64503),j=t(76997),N=t(34854),U=t(71248),z=t(74183),B=t(40975),H=t(29754),Y=t(53403),J=t(51375),G=t(60515),Z=t(22110),ee=t.n(Z);const ae=(0,$.A)(S,[["__scopeId","data-v-5f698902"]]);var te=ae;ee()(S,"components",{QCard:V.A,QCardSection:D.A,QBtn:O.A,QInput:W.A,QIcon:X.A,QTooltip:j.A,QPopupProxy:N.A,QCardActions:U.A,QPagination:z.A,QSelect:B.A,QTable:H.A,QTd:Y.A,QDialog:J.A}),ee()(S,"directives",{ClosePopup:G.A})},42634:function(){}}]);
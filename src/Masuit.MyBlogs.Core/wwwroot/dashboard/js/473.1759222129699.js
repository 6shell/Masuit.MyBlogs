(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[473],{13986:function(e,t,a){"use strict";var o=a(74413),l=a(27454),s=a.n(l),r=a(76661),i=a(57695);const n=o.A.create({baseURL:r.c.baseURL,timeout:r.c.timeOut});n.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=s().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&i.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return i.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:i.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:i.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:i.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:i.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:i.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:i.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:i.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:i.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:i.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:i.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=n},42634:function(){},94916:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return S}});var o=a(74220),l=a(97700),s=a(46732),r=a(57695),i=a(88828),n=a.n(i),c=a(13986);const u={class:"merge-list-container"},d=["href"],b=["href"],p={class:"column q-gutter-xs"},m=["href"],g={style:{width:"400px"}},k={class:"text-h6"},f={class:"q-mt-md flex justify-center items-center"},v={class:"q-ml-sm text-caption"};var w=(0,o.pM)({__name:"list",setup(e){const t=(0,s.KR)(!1),a=(0,s.KR)([]),i=(0,s.KR)(""),w=(0,s.KR)({page:1,rowsPerPage:10,total:0}),F=(0,s.KR)(null),h=e=>n()(e).format("YYYY-MM-DD HH:mm:ss"),_=e=>{const t={0:"warning",1:"positive",2:"negative",3:"negative"};return t[e]||"grey"},C=e=>{const t={0:"待合并",1:"已合并",2:"已拒绝",3:"已被标记为恶意修改"};return t[e]||"未知"},y=async()=>{t.value=!0;const e={page:w.value.page,size:w.value.rowsPerPage,kw:i.value||""},o=await c.A.get("/merge",{params:e});o&&(a.value=o.Data||[],w.value.total=o.TotalCount||0),t.value=!1},R=async e=>{const t=await c.A.post(`/merge/${e.Id}`);r.oR.success(t?.Message||"合并成功",{autoClose:2e3,position:"top-center"}),await y()},x=(0,s.KR)(""),A=async e=>{const t=await c.A.post(`/merge/reject/${e.Id}`,{reason:x.value});r.oR.success(t?.Message||"已拒绝合并",{autoClose:2e3,position:"top-center"}),await y()},P=async e=>{const t=await c.A.post(`/merge/block/${e.Id}`);r.oR.success(t?.Message||"已标记为恶意修改",{autoClose:2e3,position:"top-center"}),await y()},q=async e=>{const t=await c.A.post("/system/AddToBlackList",{ip:e});r.oR.success(t?.Message||"已加入黑名单",{autoClose:2e3,position:"top-center"})};return(0,o.sV)(()=>{y()}),(e,s)=>{const r=(0,o.g2)("q-btn"),n=(0,o.g2)("q-input"),c=(0,o.g2)("vxe-column"),L=(0,o.g2)("router-link"),M=(0,o.g2)("q-tooltip"),I=(0,o.g2)("q-icon"),T=(0,o.g2)("q-card-section"),Q=(0,o.g2)("q-card-actions"),V=(0,o.g2)("q-card"),z=(0,o.g2)("q-popup-proxy"),S=(0,o.g2)("q-chip"),$=(0,o.g2)("q-btn-group"),O=(0,o.g2)("vxe-table"),j=(0,o.g2)("q-pagination"),U=(0,o.g2)("q-select"),K=(0,o.gN)("close-popup");return(0,o.uX)(),(0,o.CE)("div",u,[(0,o.bF)(n,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=e=>i.value=e),outlined:"",dense:"",placeholder:"全局搜索",class:"q-mb-md"},{append:(0,o.k6)(()=>[(0,o.bF)(r,{color:"info",icon:"search",onClick:y,loading:t.value,label:"搜索"},null,8,["loading"])]),_:1},8,["modelValue"]),(0,o.bF)(O,{ref_key:"tableRef",ref:F,data:a.value,loading:t.value,stripe:"",border:""},{default:(0,o.k6)(()=>[(0,o.bF)(c,{field:"PostTitle",title:"原标题","min-width":"200",fixed:"left"},{default:(0,o.k6)(({row:e})=>[(0,o.Lk)("a",{href:`/${e.PostId}`,target:"_blank",class:"text-primary"},(0,l.v_)(e.PostTitle),9,d)]),_:1}),(0,o.bF)(c,{field:"Title",title:"新标题","min-width":"200"},{default:(0,o.k6)(({row:e})=>[(0,o.bF)(L,{to:`/merge/compare?id=${e.Id}`,target:"_blank",class:"text-primary"},{default:(0,o.k6)(()=>[(0,o.eW)((0,l.v_)(e.Title),1)]),_:2},1032,["to"])]),_:1}),(0,o.bF)(c,{field:"Modifier",title:"修改人",width:"120"},{default:(0,o.k6)(({row:e})=>[(0,o.Lk)("a",{href:`/author/${e.Modifier}`,target:"_blank",class:"text-primary"},(0,l.v_)(e.Modifier),9,b)]),_:1}),(0,o.bF)(c,{field:"ModifierEmail",title:"修改人邮箱",width:"180"}),(0,o.bF)(c,{field:"SubmitTime",title:"提交时间",width:"160"},{default:(0,o.k6)(({row:e})=>[(0,o.eW)((0,l.v_)(h(e.SubmitTime)),1)]),_:1}),(0,o.bF)(c,{field:"IP",title:"IP",width:"200"},{default:(0,o.k6)(({row:e})=>[(0,o.Lk)("div",p,[(0,o.Lk)("a",{href:`/tools/ip/${e.IP}`,target:"_blank",class:"text-primary"},(0,l.v_)(e.IP),9,m),(0,o.bF)(r,{color:"negative",icon:"block",dense:"",flat:"",size:"sm"},{default:(0,o.k6)(()=>[(0,o.bF)(M,{class:"bg-red"},{default:(0,o.k6)(()=>[...s[4]||(s[4]=[(0,o.eW)("添加到黑名单",-1)])]),_:1}),(0,o.bF)(z,{"transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(()=>[(0,o.bF)(V,null,{default:(0,o.k6)(()=>[(0,o.bF)(T,{class:"row items-center"},{default:(0,o.k6)(()=>[(0,o.bF)(I,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),s[5]||(s[5]=(0,o.Lk)("div",null,[(0,o.Lk)("div",{class:"text-h6"},"确认操作"),(0,o.Lk)("div",{class:"text-subtitle2"},"此操作将标记该用户IP为黑名单，是否继续？")],-1))]),_:1}),(0,o.bF)(Q,{align:"right"},{default:(0,o.k6)(()=>[(0,o.bo)((0,o.bF)(r,{flat:"",label:"确认",color:"negative",onClick:t=>q(e.IP)},null,8,["onClick"]),[[K]]),(0,o.bo)((0,o.bF)(r,{flat:"",label:"取消",color:"primary"},null,512),[[K]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:1}),(0,o.bF)(c,{field:"MergeState",title:"状态",width:"100"},{default:(0,o.k6)(({row:e})=>[(0,o.bF)(S,{color:_(e.MergeState),"text-color":"white",label:C(e.MergeState),dense:""},null,8,["color","label"])]),_:1}),(0,o.bF)(c,{title:"操作",width:"230",fixed:"right"},{default:(0,o.k6)(({row:e})=>[0===e.MergeState?((0,o.uX)(),(0,o.Wv)($,{key:0},{default:(0,o.k6)(()=>[(0,o.bF)(r,{size:"sm",color:"info",label:"对比",dense:"",to:`/posts/merge/compare?id=${e.Id}`},null,8,["to"]),(0,o.bF)(r,{size:"sm",color:"positive",label:"直接合并",dense:""},{default:(0,o.k6)(()=>[(0,o.bF)(z,{"transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(()=>[(0,o.bF)(V,null,{default:(0,o.k6)(()=>[(0,o.bF)(T,{class:"row items-center"},{default:(0,o.k6)(()=>[(0,o.bF)(I,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),s[6]||(s[6]=(0,o.Lk)("div",null,[(0,o.Lk)("div",{class:"text-h6"},"确认操作"),(0,o.Lk)("div",{class:"text-subtitle2"},"此操作将直接合并该修改，是否继续？")],-1))]),_:1}),(0,o.bF)(Q,{align:"right"},{default:(0,o.k6)(()=>[(0,o.bo)((0,o.bF)(r,{flat:"",label:"确认",color:"negative",onClick:t=>R(e)},null,8,["onClick"]),[[K]]),(0,o.bo)((0,o.bF)(r,{flat:"",label:"取消",color:"primary"},null,512),[[K]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,o.bF)(r,{size:"sm",color:"info",label:"编辑并合并",dense:"",to:`/posts/merge/edit?id=${e.Id}`},null,8,["to"]),(0,o.bF)(r,{size:"sm",color:"negative",label:"拒绝",dense:""},{default:(0,o.k6)(()=>[(0,o.bF)(z,{"transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(()=>[(0,o.bF)(V,null,{default:(0,o.k6)(()=>[(0,o.bF)(T,{class:"row items-center"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",g,[(0,o.Lk)("div",k,[(0,o.bF)(I,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),s[7]||(s[7]=(0,o.eW)("拒绝合并理由：",-1))]),(0,o.bF)(n,{dense:"",autogrow:"",outlined:"",modelValue:x.value,"onUpdate:modelValue":s[1]||(s[1]=e=>x.value=e),placeholder:"请填写拒绝理由"},null,8,["modelValue"])])]),_:1}),(0,o.bF)(Q,{align:"right"},{default:(0,o.k6)(()=>[(0,o.bo)((0,o.bF)(r,{flat:"",label:"确认",disabled:!x.value,color:"negative",onClick:t=>A(e)},null,8,["disabled","onClick"]),[[K]]),(0,o.bo)((0,o.bF)(r,{flat:"",label:"取消",color:"primary"},null,512),[[K]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,o.bF)(r,{size:"sm",color:"warning",label:"标记恶意",dense:""},{default:(0,o.k6)(()=>[(0,o.bF)(z,{"transition-show":"scale","transition-hide":"scale"},{default:(0,o.k6)(()=>[(0,o.bF)(V,null,{default:(0,o.k6)(()=>[(0,o.bF)(T,{class:"row items-center"},{default:(0,o.k6)(()=>[(0,o.bF)(I,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),s[8]||(s[8]=(0,o.Lk)("div",null,[(0,o.Lk)("div",{class:"text-h6"},"确认操作"),(0,o.Lk)("div",{class:"text-subtitle2"},"此操作将标记该修改为恶意修改，是否继续？")],-1))]),_:1}),(0,o.bF)(Q,{align:"right"},{default:(0,o.k6)(()=>[(0,o.bo)((0,o.bF)(r,{flat:"",label:"确认",color:"negative",onClick:t=>P(e)},null,8,["onClick"]),[[K]]),(0,o.bo)((0,o.bF)(r,{flat:"",label:"取消",color:"primary"},null,512),[[K]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(0,o.Q3)("",!0)]),_:1})]),_:1},8,["data","loading"]),(0,o.Lk)("div",f,[(0,o.bF)(j,{modelValue:w.value.page,"onUpdate:modelValue":[s[2]||(s[2]=e=>w.value.page=e),y],max:Math.ceil(w.value.total/w.value.rowsPerPage),"max-pages":6,"boundary-numbers":""},null,8,["modelValue","max"]),(0,o.bF)(U,{modelValue:w.value.rowsPerPage,"onUpdate:modelValue":[s[3]||(s[3]=e=>w.value.rowsPerPage=e),y],options:[10,15,20,30,50,100,200],dense:"",outlined:"",class:"q-ml-md",style:{width:"80px"}},null,8,["modelValue"]),(0,o.Lk)("span",v," 共 "+(0,l.v_)(w.value.total)+" 条 ",1)])])}}}),F=a(1317),h=a(38622),_=a(20407),C=a(76997),y=a(34854),R=a(63663),x=a(17180),A=a(64503),P=a(71248),q=a(97491),L=a(10258),M=a(74183),I=a(40975),T=a(60515),Q=a(22110),V=a.n(Q);const z=(0,F.A)(w,[["__scopeId","data-v-541ca20f"]]);var S=z;V()(w,"components",{QInput:h.A,QBtn:_.A,QTooltip:C.A,QPopupProxy:y.A,QCard:R.A,QCardSection:x.A,QIcon:A.A,QCardActions:P.A,QChip:q.A,QBtnGroup:L.A,QPagination:M.A,QSelect:I.A}),V()(w,"directives",{ClosePopup:T.A})}}]);
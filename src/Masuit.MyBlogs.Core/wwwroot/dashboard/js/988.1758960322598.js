(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[988],{13986:function(e,t,o){"use strict";var l=o(74413),a=o(27454),n=o.n(a),s=o(76661),i=o(57695);const u=l.A.create({baseURL:s.c.baseURL,timeout:s.c.timeOut});u.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=n().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),u.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&i.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return i.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:i.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:i.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:i.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:i.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:i.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:i.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:i.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:i.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:i.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:i.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=u},21475:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return fe}});var l=o(74220),a=o(46732),n=o(97700),s=o(75220),i=o(13986);class u{static async getCategories(){const e=await i.A.get("/category/getcategories");return e}static async getTags(){const e=await i.A.get("/post/gettag");return e}static async getSeminars(){const e=await i.A.get("/seminar/getall");return e}static async writePost(e){const t=await i.A.post("/Post/write",e);return t}static async editPost(e){const t=await i.A.post("/Post/edit",e);return t}static async editPost(e){const t=await i.A.post("/Post/edit",e);return t}static async getPost(e){const t=await i.A.get(`/post/get/${e}`);return t}static async uploadWord(e){const t=new FormData;t.append("upload",e);const o=await i.A.post("/Upload/UploadWord",t,{headers:{"Content-Type":"multipart/form-data"}});return o}static async getRegions(e="Regions"){const t=await i.A.get(`/post/GetRegions?name=${e}`);return t}}var r=o(57695),d=o(64485),c=(o(74564),o(92532),o(39798)),p={__name:"QTagInput",props:{modelValue:{type:Array,default:()=>[]},label:{type:String,default:""},outlined:{type:Boolean,default:!1},dense:{type:Boolean,default:!1},autogrow:{type:Boolean,default:!1},tagColors:{type:Array,default:()=>["#FFB300","#39B54A","#00A1E9","#F75000","#8C6E63","#E67E22"]},clearable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,s=t,i=(0,a.KR)(""),u=(0,a.KR)(null),r=(0,a.KR)(null),d=(0,l.EW)(()=>o.modelValue.length>0||i.value.length>0),p=(0,l.EW)(()=>({minHeight:o.dense?"40px":"56px",transition:"min-height 0.2s",overflow:"visible"})),m=(0,l.EW)(()=>({display:"flex",flexWrap:"wrap",alignItems:"center",gap:o.dense?"4px":"8px",minHeight:o.dense?"28px":"50px",padding:o.dense?"1px 4px":"8px 12px"})),v=(0,l.EW)(()=>({border:"none",outline:"none",fontSize:o.dense?"12px":"16px",background:"transparent",minWidth:o.dense?"30px":"50px",flexGrow:1,marginLeft:"2px",marginRight:"2px",height:o.dense?"20px":"24px",width:"50px"}));function g(e){const t=Math.abs(Array.from(e).reduce((e,t)=>e+t.charCodeAt(0),0))%o.tagColors.length;return o.tagColors[t]}function b(){const e=i.value.trim();e&&!o.modelValue.includes(e)&&s("update:modelValue",[...o.modelValue,e]),i.value=""}function f(e){const t=[...o.modelValue];t.splice(e,1),s("update:modelValue",t),(0,l.dY)(()=>{r.value&&r.value.focus()})}function k(){s("update:modelValue",[]),i.value="",(0,l.dY)(()=>{r.value&&r.value.focus()})}function y(e){"Enter"===e.key||","===e.key?(e.preventDefault(),b()):"Backspace"===e.key&&0===i.value.length&&o.modelValue.length>0&&f(o.modelValue.length-1)}function h(){r.value&&r.value.focus()}return(0,l.wB)(()=>o.modelValue.length,()=>{(0,l.dY)(()=>{u.value&&(u.value.parentElement.style.minHeight=Math.max(p.value.minHeight.replace("px",""),u.value.offsetHeight)+"px")})}),(t,o)=>{const a=(0,l.g2)("q-icon"),s=(0,l.g2)("q-field");return(0,l.uX)(),(0,l.Wv)(s,{label:e.label,outlined:e.outlined,dense:e.dense,autogrow:e.autogrow,class:(0,n.C4)(["color-tag-input",{"color-tag-input--dense":e.dense},{"q-field--float":d.value}]),style:(0,n.Tr)(p.value),onClick:h},{default:(0,l.k6)(()=>[(0,l.Lk)("div",{class:"tag-list",style:(0,n.Tr)(m.value),ref_key:"tagList",ref:u},[e.clearable&&e.modelValue.length?((0,l.uX)(),(0,l.Wv)(a,{key:0,name:"clear",class:"clear-icon",onMousedown:o[0]||(o[0]=(0,c.D$)(()=>{},["prevent"])),onClick:k})):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.modelValue,(e,t)=>((0,l.uX)(),(0,l.CE)("span",{key:t,class:"tag",style:(0,n.Tr)({background:g(e)})},[(0,l.eW)((0,n.v_)(e)+" ",1),(0,l.bF)(a,{name:"close",class:"remove-icon",onClick:e=>f(t)},null,8,["onClick"])],4))),128)),(0,l.bo)((0,l.Lk)("input",{ref_key:"input",ref:r,"onUpdate:modelValue":o[1]||(o[1]=e=>i.value=e),style:(0,n.Tr)(v.value),onKeydown:y,onBlur:b,class:"tag-input"},null,36),[[c.Jo,i.value]])],4)]),_:1},8,["label","outlined","dense","autogrow","class","style"])}}},m=o(1317),v=o(45855),g=o(64503),b=o(22110),f=o.n(b);const k=(0,m.A)(p,[["__scopeId","data-v-1e8250a2"]]);var y=k;f()(p,"components",{QField:v.A,QIcon:g.A});const h={key:0},w={key:1,class:"write-blog-container"},C={key:0,class:"text-h6"},V={key:1,class:"text-h6"},x={class:"row"},R={class:"row items-center"},F={key:0,class:"row items-center"},L={key:0},A={class:"row q-gutter-md"},_={class:"col"},E={class:"col"},q={class:"row q-mb-md"},I={class:"col"},D={class:"col"},U={class:"col"},S={class:"col"},P={class:"row"},Q={class:"col-3"},T={class:"col-3"},M={class:"col"},W={class:"row items-center"},K={key:0,class:"col-3"},N={style:{"font-size":"14px"}},X={style:{"min-height":"420px"}},O={class:"row",style:{"min-width":"600px"}},B={class:"row q-gutter-md"},Y={class:"col"},$={key:0,class:"col"},H={key:1,class:"col"},z={class:"row items-start"};var j=(0,l.pM)({__name:"write",setup(e){const t=(0,d.k)(),o=(0,s.lq)(),i=(0,s.rd)(),c=(0,a.KR)(null),p=(0,a.KR)(null),m=(0,a.KR)(o.query.id>0),v=(0,a.Kh)({Id:o.query.id?Number(o.query.id):0,Title:"",Author:"",Email:"",Content:"",ProtectContent:"",ProtectContentMode:0,ProtectContentRegions:"",ProtectContentLimitMode:1,ProtectPassword:"",CategoryId:1,Labels:[],Keyword:"",Seminars:[],DisableCopy:!1,DisableComment:!1,schedule:!1,timespan:"",Redirect:"",IsNsfw:!1,ExpireAt:"",LimitMode:0,Regions:"",ExceptRegions:"",Reserve:!0}),g=(0,l.EW)({get(){return v.Keyword?v.Keyword.split(",").filter(e=>e.trim().length>0):[]},set(e){v.Keyword=e.join(",")}}),b=(0,a.KR)(!1),f=(0,a.KR)(!0),k=(0,a.KR)(!1),j=(0,a.KR)(!1),J=(0,a.KR)(!1),G=(0,a.KR)(null);let Z=null;const ee=(0,a.KR)([]),te=(0,a.KR)([]),oe=(0,a.KR)([]),le=(0,a.KR)([]),ae=(0,a.KR)([]),ne=(0,a.KR)([]),se=(0,a.KR)([]),ie=(0,a.KR)([]),ue=(0,a.KR)([]),re=(0,a.KR)([]),de=[{label:"无加密",value:0},{label:"评论可见",value:1},{label:"地区可见",value:2},{label:"授权可见",value:3},{label:"密码可见",value:4},{label:"仅搜索引擎可见",value:5}],ce=[{label:"不限",value:0},{label:"指定地区可见",value:1},{label:"指定地区不可见",value:2},{label:"指定地区可见但排除在内的这些地区",value:3},{label:"指定地区不可见但排除在内的这些地区",value:4},{label:"仅搜索引擎可见",value:5}],pe=async()=>{try{const e=await u.getCategories();e.Success&&(ee.value=ve(e.Data)||[],te.value=ee.value)}catch(e){console.error("加载分类失败:",e),r.oR.error("加载分类失败",{position:"top-center",autoClose:3e3})}},me=(e,t)=>{t(()=>{if(""===e)te.value=ee.value;else{const t=e.toLowerCase();te.value=ee.value.filter(e=>e.Name.toLowerCase().indexOf(t)>-1)}})},ve=(e,t="")=>{const o=[];for(const l of e){const e=t?`${t}/${l.Name}`:l.Name;if(o.push({...l,Name:e,OriginalName:l.Name}),l.Children&&l.Children.length>0){const t=ve(l.Children,e);o.push(...t)}}return o},ge=async()=>{try{const e=await u.getTags();e.Success&&(oe.value=e.Data||[],le.value=oe.value)}catch(e){console.error("加载标签失败:",e),r.oR.error("加载标签失败",{position:"top-center",autoClose:3e3})}},be=(e,t)=>{t(""!==e?()=>{const t=e?.toLowerCase();le.value=oe.value.filter(e=>e?.toLowerCase().indexOf(t)>-1)}:()=>{le.value=oe.value})},fe=(e,t)=>{const o=oe.value.find(t=>t.TagName===e);if(!o&&e.length>0){const o={Id:Date.now(),TagName:e};oe.value.push(o),le.value=oe.value,t(e)}},ke=async()=>{const e=await u.getSeminars();e.Success&&(ae.value=e.Data||[],ne.value=ae.value)},ye=(e,t)=>{t(()=>{if(""===e)ne.value=ae.value;else{const t=e.toLowerCase();ne.value=ae.value.filter(e=>e.Title.toLowerCase().indexOf(t)>-1)}})},he=async()=>{let e=await u.getRegions();e.Success&&(se.value=e.Data||[],ie.value=se.value),e=await u.getRegions("ExceptRegions"),e.Success&&(ue.value=e.Data||[])},we=(e,t)=>{t(""!==e?()=>{const t=e?.toLowerCase();ie.value=se.value.filter(e=>e?.toLowerCase().indexOf(t)>-1)}:()=>{ie.value=se.value})},Ce=(e,t)=>{const o=se.value.find(t=>t===e);!o&&e.length>0&&(se.value.push(e),ie.value=se.value,t(e))},Ve=(e,t)=>{t(""!==e?()=>{const t=e?.toLowerCase();re.value=ue.value.filter(e=>e?.toLowerCase().indexOf(t)>-1)}:()=>{re.value=ue.value})},xe=(e,t)=>{const o=ue.value.find(t=>t===e);!o&&e.length>0&&(ue.value.push(e),re.value=ue.value,t(e))},Re=()=>{j.value=!0},Fe=e=>{G.value=e},Le=async()=>{if(G.value){k.value=!0;try{const e=await u.uploadWord(G.value);e.Success?(v.Title=e.Data?.Title||v.Title,v.Content=e.Data?.Content||"",r.oR.success("Word文档上传成功",{position:"top-center",autoClose:3e3}),j.value=!1,G.value=null):r.oR.error(e.Message||"Word文档上传失败",{position:"top-center",autoClose:3e3})}catch(e){console.error("上传Word文档失败:",e),r.oR.error("上传失败，请重试",{position:"top-center",autoClose:3e3})}finally{k.value=!1}}else r.oR.error("请选择要上传的Word文档",{position:"top-center",autoClose:3e3})},Ae=async()=>{if(!v.Title||v.Title.trim().length<2)r.oR.error("文章标题至少需要2个字符",{position:"top-center",autoClose:3e3});else if(!v.Content||v.Content.length<20)r.oR.error("文章内容至少需要20个字符",{position:"top-center",autoClose:3e3});else{if(v.schedule&&v.timespan){const e=new Date(v.timespan),t=new Date;if(e<=t)return void r.oR.error("定时发表时间必须大于当前时间",{position:"top-center",autoClose:3e3})}else if(v.schedule&&!v.timespan)return void r.oR.error("请选择定时发表时间",{position:"top-center",autoClose:3e3});b.value=!0;try{v.Label=v.Labels.join(",");const e=m.value?await u.editPost(v):await u.writePost(v);e.Success?(r.oR.success("文章发布成功",{position:"top-center",autoClose:3e3}),localStorage.removeItem("write-post-draft:"+v.Id),clearInterval(Z),i.push("/posts/list")):r.oR.error(e.Message||"文章发布失败",{position:"top-center",autoClose:3e3})}catch(e){console.error("提交文章失败:",e),r.oR.error("提交失败，请重试",{position:"top-center",autoClose:3e3})}finally{b.value=!1}}},_e=()=>{const e=localStorage.getItem("write-post-draft:"+v.Id);if(e){const t=JSON.parse(e);Object.assign(v,t)}Ee(),J.value=!1},Ee=()=>{Z=setInterval(()=>{const e={...v};localStorage.setItem("write-post-draft:"+v.Id,JSON.stringify(e))},5e3)},qe=e=>{const t=new Date,o=new Date(e);return o>=new Date(t.getFullYear(),t.getMonth(),t.getDate())},Ie=(e,t)=>{const o=new Date,l=new Date(o.getFullYear(),o.getMonth(),o.getDate());if(!v.timespan)return!0;const a=v.timespan.split(" ")[0];if(!a)return!0;const n=new Date(a);if(n.getTime()!==l.getTime())return!0;const s=o.getHours(),i=o.getMinutes();return void 0!==t?e>s||e===s&&t>i:e>=s},De=async()=>{const e=new URLSearchParams(window.location.search),t=o.query.refer||o.query.id||e.get("refer");if(t){const e=await u.getPost(parseInt(t));if(e.Success&&e.Data){const t=e.Data;t.Id=o.query.id||0,t.Labels=t.Label?.split(",")||[],Object.assign(v,t)}}};(0,l.sV)(async()=>{const e=await t.getUserInfo();v.Author=e.NickName,v.Email=e.Email,await Promise.all([pe(),ge(),ke(),De(),he()]),J.value=JSON.parse(localStorage.getItem("write-post-draft:"+v.Id))?.Content?.length>0,J.value||Ee(),document.querySelector(".q-page-container").addEventListener("scroll",Qe),f.value=!1}),(0,l.hi)(()=>{Z&&clearInterval(Z),Ue&&clearTimeout(Ue),document.querySelector(".q-page-container")?.removeEventListener("scroll",Qe)});let Ue=null,Se=!1,Pe=!1;const Qe=()=>{Ue&&clearTimeout(Ue),Ue=setTimeout(()=>{Te()},100)},Te=()=>{if(c.value?.$el){const e=c.value.$el.querySelector(".edui-editor-toolbarbox");if(e){const t=c.value.$el.getBoundingClientRect(),o=t.top<84&&t.bottom>300;if(o&&!Se){const t=c.value.$el.offsetWidth;e.style.cssText=`\n          position: fixed !important;\n          top: 84px !important;\n          z-index: 1000 !important;\n          width: ${t}px !important;\n          transition: all 0.5s ease !important;\n        `,Se=!0}else!o&&Se&&(e.style.cssText="\n          position: static !important;\n          top: auto !important;\n          z-index: auto !important;\n          width: auto !important;\n          transition: all 0.5s ease !important;\n        ",Se=!1)}}if(p.value?.$el){const e=p.value.$el.querySelector(".edui-editor-toolbarbox");if(e){const t=p.value.$el.getBoundingClientRect(),o=t.top<84&&t.bottom>300;if(o&&!Pe){const t=p.value.$el.offsetWidth;e.style.cssText=`\n          position: fixed !important;\n          top: 84px !important;\n          z-index: 1000 !important;\n          width: ${t}px !important;\n          transition: all 0.2s ease !important;\n        `,Pe=!0}else!o&&Pe&&(e.style.cssText="\n          position: static !important;\n          top: auto !important;\n          z-index: auto !important;\n          width: auto !important;\n          transition: all 0.2s ease !important;\n        ",Pe=!1)}}};return(e,t)=>{const s=(0,l.g2)("q-spinner"),i=(0,l.g2)("q-inner-loading"),u=(0,l.g2)("q-btn"),r=(0,l.g2)("q-input"),d=(0,l.g2)("vue-ueditor-wrap"),Z=(0,l.g2)("q-card-section"),ee=(0,l.g2)("q-card"),oe=(0,l.g2)("q-select"),ae=(0,l.g2)("q-item-section"),se=(0,l.g2)("q-item"),ue=(0,l.g2)("q-chip"),pe=(0,l.g2)("q-date"),ve=(0,l.g2)("q-popup-proxy"),ge=(0,l.g2)("q-icon"),ke=(0,l.g2)("q-checkbox"),he=(0,l.g2)("q-time"),De=(0,l.g2)("q-file"),Ue=(0,l.g2)("q-card-actions"),Se=(0,l.g2)("q-dialog"),Pe=(0,l.gN)("close-popup");return f.value?((0,l.uX)(),(0,l.CE)("div",h,[(0,l.bF)(i,{showing:f.value},{default:(0,l.k6)(()=>[(0,l.bF)(s,{color:"primary",size:"100px"})]),_:1},8,["showing"])])):((0,l.uX)(),(0,l.CE)("div",w,[(0,a.R1)(o).query.id?((0,l.uX)(),(0,l.CE)("div",C,"编辑ID："+(0,n.v_)(v.Id),1)):(0,l.Q3)("",!0),(0,a.R1)(o).query.refer?((0,l.uX)(),(0,l.CE)("div",V,"复制来源ID："+(0,n.v_)((0,a.R1)(o).query.refer),1)):(0,l.Q3)("",!0),(0,l.Lk)("div",x,[(0,l.bF)(r,{autogrow:"",class:"col",modelValue:v.Title,"onUpdate:modelValue":t[0]||(t[0]=e=>v.Title=e),label:"文章标题",outlined:"",required:"",rules:[e=>!!e||"请输入文章标题",e=>e.length>=2||"标题至少2个字符",e=>e.length<=128||"标题最多128个字符"]},{append:(0,l.k6)(()=>[(0,l.bF)(u,{dense:"",size:"lg",color:"info",label:"上传Word文档",onClick:Re,class:"full-width",icon:"upload","no-caps":""})]),_:1},8,["modelValue","rules"])]),(0,l.bF)(ee,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,l.k6)(()=>[(0,l.bF)(Z,null,{default:(0,l.k6)(()=>[t[35]||(t[35]=(0,l.Lk)("div",{class:"text-h6"},"文章内容：",-1)),(0,l.bF)(d,{ref_key:"editor",ref:c,modelValue:v.Content,"onUpdate:modelValue":t[1]||(t[1]=e=>v.Content=e),config:{initialFrameHeight:500}},null,8,["modelValue"])]),_:1})]),_:1}),(0,l.bF)(ee,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,l.k6)(()=>[(0,l.bF)(Z,null,{default:(0,l.k6)(()=>[(0,l.Lk)("div",R,[(0,l.bF)(oe,{dense:"",modelValue:v.ProtectContentMode,"onUpdate:modelValue":t[2]||(t[2]=e=>v.ProtectContentMode=e),options:de,label:"加密模式",outlined:"",style:{"min-width":"200px"},"map-options":"","emit-value":""},{before:(0,l.k6)(()=>[...t[36]||(t[36]=[(0,l.Lk)("div",{class:"text-h6"},"文章加密",-1)])]),_:1},8,["modelValue"]),2===v.ProtectContentMode?((0,l.uX)(),(0,l.CE)("div",F,[(0,l.bF)(r,{autogrow:"",dense:"",modelValue:v.ProtectContentRegions,"onUpdate:modelValue":t[4]||(t[4]=e=>v.ProtectContentRegions=e),label:"可见地区",placeholder:"竖线分隔，支持国家、地区、城市、运营商、ASN",style:{width:"450px"},outlined:""},{append:(0,l.k6)(()=>[(0,l.bF)(oe,{dense:"",borderless:"",modelValue:v.ProtectContentLimitMode,"onUpdate:modelValue":t[3]||(t[3]=e=>v.ProtectContentLimitMode=e),options:[{label:"以内",value:1},{label:"以外",value:2}],"emit-value":"","map-options":""},null,8,["modelValue"])]),_:1},8,["modelValue"])])):(0,l.Q3)("",!0),4===v.ProtectContentMode?((0,l.uX)(),(0,l.Wv)(r,{key:1,autogrow:"",dense:"",modelValue:v.ProtectPassword,"onUpdate:modelValue":t[5]||(t[5]=e=>v.ProtectPassword=e),label:"访问密码",type:"password",outlined:""},null,8,["modelValue"])):(0,l.Q3)("",!0)]),v.ProtectContentMode>0?((0,l.uX)(),(0,l.CE)("div",L,[(0,l.bF)(d,{ref_key:"protectContentEditor",ref:p,modelValue:v.ProtectContent,"onUpdate:modelValue":t[6]||(t[6]=e=>v.ProtectContent=e),config:{initialFrameHeight:300}},null,8,["modelValue"])])):(0,l.Q3)("",!0)]),_:1})]),_:1}),(0,l.bF)(ee,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,l.k6)(()=>[(0,l.bF)(Z,null,{default:(0,l.k6)(()=>[t[37]||(t[37]=(0,l.Lk)("div",{class:"text-h6"},"作者信息",-1)),(0,l.Lk)("div",A,[(0,l.Lk)("div",_,[(0,l.bF)(r,{autogrow:"",dense:"",modelValue:v.Author,"onUpdate:modelValue":t[7]||(t[7]=e=>v.Author=e),label:"作者",outlined:"",rules:[e=>!!e||"请输入作者",e=>e.length<=20||"作者名最多20个字符"]},null,8,["modelValue","rules"])]),(0,l.Lk)("div",E,[(0,l.bF)(r,{autogrow:"",dense:"",modelValue:v.Email,"onUpdate:modelValue":t[8]||(t[8]=e=>v.Email=e),label:"邮箱",type:"email",outlined:"",rules:[e=>!!e||"请输入邮箱",e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||"邮箱格式不正确"]},null,8,["modelValue","rules"])])])]),_:1})]),_:1}),(0,l.bF)(ee,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,l.k6)(()=>[(0,l.bF)(Z,null,{default:(0,l.k6)(()=>[t[40]||(t[40]=(0,l.Lk)("div",{class:"text-h6"},"文章设置",-1)),(0,l.Lk)("div",q,[(0,l.Lk)("div",I,[(0,l.bF)(oe,{dense:"",modelValue:v.CategoryId,"onUpdate:modelValue":t[9]||(t[9]=e=>v.CategoryId=e),options:te.value,label:"分类",outlined:"","option-label":"Name","option-value":"Id","emit-value":"","map-options":"","use-input":"","input-debounce":"300",onFilter:me},{"no-option":(0,l.k6)(()=>[(0,l.bF)(se,null,{default:(0,l.k6)(()=>[(0,l.bF)(ae,{class:"text-grey"},{default:(0,l.k6)(()=>[...t[38]||(t[38]=[(0,l.eW)(" 没有找到匹配的分类 ",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),(0,l.Lk)("div",D,[(0,l.bF)(oe,{dense:"",modelValue:v.Seminars,"onUpdate:modelValue":t[10]||(t[10]=e=>v.Seminars=e),options:ne.value,label:"专题",outlined:"",multiple:"","use-chips":"","option-label":"Title","option-value":"Id","map-options":"","emit-value":"","use-input":"","input-debounce":"300",onFilter:ye,clearable:""},{"no-option":(0,l.k6)(()=>[(0,l.bF)(se,null,{default:(0,l.k6)(()=>[(0,l.bF)(ae,{class:"text-grey"},{default:(0,l.k6)(()=>[...t[39]||(t[39]=[(0,l.eW)(" 没有找到匹配的专题 ",-1)])]),_:1})]),_:1})]),"selected-item":(0,l.k6)(e=>[(0,l.bF)(ue,{style:(0,n.Tr)({backgroundColor:["#FFB300","#39B54A","#00A1E9","#F75000","#8C6E63","#E67E22"][e.index%6],color:"white",fontSize:"11px"}),removable:"",onRemove:t=>e.removeAtIndex(e.index)},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)(e.opt.Title),1)]),_:2},1032,["style","onRemove"])]),_:1},8,["modelValue","options"])]),(0,l.Lk)("div",U,[(0,l.bF)(oe,{dense:"",modelValue:v.Labels,"onUpdate:modelValue":t[11]||(t[11]=e=>v.Labels=e),options:le.value,label:"标签",outlined:"",multiple:"","use-chips":"","use-input":"","new-value-mode":"add-unique","input-debounce":"0",onFilter:be,onNewValue:fe,clearable:""},{"selected-item":(0,l.k6)(e=>[(0,l.bF)(ue,{style:(0,n.Tr)({backgroundColor:["#FFB300","#39B54A","#00A1E9","#F75000","#8C6E63","#E67E22"][e.index%6],color:"white",fontSize:"11px"}),removable:"",onRemove:t=>e.removeAtIndex(e.index)},{default:(0,l.k6)(()=>[(0,l.eW)((0,n.v_)(e.opt),1)]),_:2},1032,["style","onRemove"])]),_:1},8,["modelValue","options"])]),(0,l.Lk)("div",S,[(0,l.bF)(y,{clearable:"",dense:"",autogrow:"",modelValue:g.value,"onUpdate:modelValue":t[12]||(t[12]=e=>g.value=e),label:"文章关键词",outlined:""},null,8,["modelValue"])])]),(0,l.Lk)("div",P,[(0,l.Lk)("div",Q,[(0,l.bF)(r,{dense:"",autogrow:"",modelValue:v.Redirect,"onUpdate:modelValue":t[13]||(t[13]=e=>v.Redirect=e),label:"跳转到第三方链接",placeholder:"如：https://baidu.com 留空不跳转",outlined:"",hint:"当跳转第三方链接时，文章内容不宜过多"},null,8,["modelValue"])]),(0,l.Lk)("div",T,[(0,l.bF)(r,{dense:"",modelValue:v.ExpireAt,"onUpdate:modelValue":t[16]||(t[16]=e=>v.ExpireAt=e),label:"过期时间",outlined:"",readonly:""},{append:(0,l.k6)(()=>[(0,l.bF)(ge,{name:"event",class:"cursor-pointer"},{default:(0,l.k6)(()=>[(0,l.bF)(ve,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(pe,{modelValue:v.ExpireAt,"onUpdate:modelValue":t[14]||(t[14]=e=>v.ExpireAt=e),options:qe,mask:"YYYY-MM-DD"},null,8,["modelValue"]),[[Pe]])]),_:1})]),_:1}),v.ExpireAt?((0,l.uX)(),(0,l.Wv)(u,{key:0,round:"",flat:"",icon:"clear",onClick:t[15]||(t[15]=e=>v.ExpireAt="")})):(0,l.Q3)("",!0)]),_:1},8,["modelValue"])]),(0,l.Lk)("div",M,[(0,l.Lk)("div",W,[(0,l.bF)(ke,{modelValue:v.IsNsfw,"onUpdate:modelValue":t[17]||(t[17]=e=>v.IsNsfw=e),label:"标记为不安全的内容"},null,8,["modelValue"]),m.value?((0,l.uX)(),(0,l.Wv)(ke,{key:0,modelValue:v.Reserve,"onUpdate:modelValue":t[18]||(t[18]=e=>v.Reserve=e),label:"保留历史版本"},null,8,["modelValue"])):(0,l.Q3)("",!0),(0,l.bF)(ke,{modelValue:v.DisableCopy,"onUpdate:modelValue":t[19]||(t[19]=e=>v.DisableCopy=e),label:"禁止转载"},null,8,["modelValue"]),(0,l.bF)(ke,{modelValue:v.DisableComment,"onUpdate:modelValue":t[20]||(t[20]=e=>v.DisableComment=e),label:"禁止评论"},null,8,["modelValue"]),m.value||v.schedule?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(ke,{key:1,modelValue:v.schedule,"onUpdate:modelValue":t[21]||(t[21]=e=>v.schedule=e),label:"定时发表"},null,8,["modelValue"]))])]),v.schedule?((0,l.uX)(),(0,l.CE)("div",K,[(0,l.bF)(r,{dense:"",modelValue:v.timespan,"onUpdate:modelValue":t[26]||(t[26]=e=>v.timespan=e),label:"计划发表时间",outlined:"",readonly:""},{prepend:(0,l.k6)(()=>[(0,l.Lk)("span",N,[m.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(ke,{key:0,modelValue:v.schedule,"onUpdate:modelValue":t[22]||(t[22]=e=>v.schedule=e),label:"定时发表"},null,8,["modelValue"]))])]),append:(0,l.k6)(()=>[(0,l.bF)(ge,{name:"event",class:"cursor-pointer"},{default:(0,l.k6)(()=>[(0,l.bF)(ve,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.k6)(()=>[(0,l.Lk)("div",X,[(0,l.Lk)("div",O,[(0,l.bF)(pe,{modelValue:v.timespan,"onUpdate:modelValue":t[23]||(t[23]=e=>v.timespan=e),mask:"YYYY-MM-DD HH:mm",options:qe},null,8,["modelValue"]),v.timespan?((0,l.uX)(),(0,l.Wv)(he,{key:0,modelValue:v.timespan,"onUpdate:modelValue":t[24]||(t[24]=e=>v.timespan=e),mask:"YYYY-MM-DD HH:mm",options:Ie},null,8,["modelValue"])):(0,l.Q3)("",!0)]),v.timespan?(0,l.bo)(((0,l.uX)(),(0,l.Wv)(u,{key:0,color:"primary",label:"确认"},null,512)),[[Pe]]):(0,l.Q3)("",!0)])]),_:1})]),_:1}),v.timespan?((0,l.uX)(),(0,l.Wv)(u,{key:0,round:"",flat:"",icon:"clear",onClick:t[25]||(t[25]=e=>v.timespan="")})):(0,l.Q3)("",!0)]),_:1},8,["modelValue"])])):(0,l.Q3)("",!0)])]),_:1})]),_:1}),(0,l.bF)(ee,{flat:"",bordered:"",class:"q-mb-md"},{default:(0,l.k6)(()=>[(0,l.bF)(Z,null,{default:(0,l.k6)(()=>[t[41]||(t[41]=(0,l.Lk)("div",{class:"text-h6"},"按地区投放",-1)),(0,l.Lk)("div",B,[(0,l.Lk)("div",Y,[(0,l.bF)(oe,{dense:"",modelValue:v.LimitMode,"onUpdate:modelValue":t[27]||(t[27]=e=>v.LimitMode=e),options:ce,label:"投放模式",outlined:"","map-options":"","emit-value":""},null,8,["modelValue"])]),v.LimitMode>0&&v.LimitMode<5?((0,l.uX)(),(0,l.CE)("div",$,[(0,l.bF)(oe,{dense:"",modelValue:v.Regions,"onUpdate:modelValue":t[29]||(t[29]=e=>v.Regions=e),options:ie.value,label:v.LimitMode%2===1?"可见地区":"不可见地区","label-color":v.LimitMode%2===1?"":"red",outlined:"","use-input":"","new-value-mode":"add-unique","input-debounce":"0",onFilter:we,onNewValue:Ce,hint:"竖线分隔，如：江苏|苏州|移动|AS2333|DMIT，支持地区、运营商、ASN、机房名称"},{append:(0,l.k6)(()=>[v.Regions?((0,l.uX)(),(0,l.Wv)(u,{key:0,round:"",flat:"",icon:"clear",onClick:t[28]||(t[28]=e=>v.Regions=null)})):(0,l.Q3)("",!0)]),_:1},8,["modelValue","options","label","label-color"])])):(0,l.Q3)("",!0),3===v.LimitMode||4===v.LimitMode?((0,l.uX)(),(0,l.CE)("div",H,[(0,l.bF)(oe,{dense:"",modelValue:v.ExceptRegions,"onUpdate:modelValue":t[31]||(t[31]=e=>v.ExceptRegions=e),options:re.value,label:"排除地区",outlined:"","use-input":"","new-value-mode":"add-unique","input-debounce":"0",onFilter:Ve,onNewValue:xe,hint:"竖线分隔，如：江苏|苏州|移动|AS2333|DMIT，支持地区、运营商、ASN、机房名称"},{append:(0,l.k6)(()=>[v.ExceptRegions?((0,l.uX)(),(0,l.Wv)(u,{key:0,round:"",flat:"",icon:"clear",onClick:t[30]||(t[30]=e=>v.ExceptRegions=null)})):(0,l.Q3)("",!0)]),_:1},8,["modelValue","options"])])):(0,l.Q3)("",!0),(0,l.Lk)("div",z,[(0,l.bF)(u,{icon:"send",type:"submit",color:"primary",label:"发布文章",loading:b.value,onClick:Ae},null,8,["loading"])])])]),_:1})]),_:1}),(0,l.bF)(Se,{modelValue:j.value,"onUpdate:modelValue":t[33]||(t[33]=e=>j.value=e)},{default:(0,l.k6)(()=>[(0,l.bF)(ee,{style:{"min-width":"400px"}},{default:(0,l.k6)(()=>[(0,l.bF)(Z,null,{default:(0,l.k6)(()=>[...t[42]||(t[42]=[(0,l.Lk)("div",{class:"text-h6"},"上传Word文档",-1),(0,l.Lk)("div",{class:"text-caption text-orange"},"注意：重复上传将会覆盖之前上传的内容！",-1)])]),_:1}),(0,l.bF)(Z,null,{default:(0,l.k6)(()=>[(0,l.bF)(De,{modelValue:G.value,"onUpdate:modelValue":t[32]||(t[32]=e=>G.value=e),label:"选择Word文档",outlined:"",accept:".doc,.docx",onInput:Fe},{prepend:(0,l.k6)(()=>[(0,l.bF)(ge,{name:"attach_file"})]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(Ue,{align:"right"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(u,{flat:"",label:"取消",color:"grey"},null,512),[[Pe]]),(0,l.bF)(u,{label:"上传",color:"primary",onClick:Le,loading:k.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,l.bF)(Se,{modelValue:J.value,"onUpdate:modelValue":t[34]||(t[34]=e=>J.value=e)},{default:(0,l.k6)(()=>[(0,l.bF)(ee,{style:{"min-width":"400px"}},{default:(0,l.k6)(()=>[(0,l.bF)(Z,null,{default:(0,l.k6)(()=>[...t[43]||(t[43]=[(0,l.Lk)("div",{class:"text-h6"},"检测到草稿",-1),(0,l.Lk)("div",{class:"text-caption text-orange"},"检查到上次有未提交的草稿，是否加载？",-1)])]),_:1}),(0,l.bF)(Ue,{align:"right"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(u,{flat:"",label:"取消",color:"grey",onClick:Ee},null,512),[[Pe]]),(0,l.bF)(u,{label:"加载",color:"primary",onClick:_e})]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,l.bF)(i,{showing:b.value},{default:(0,l.k6)(()=>[(0,l.bF)(s,{color:"primary",size:"100px"})]),_:1},8,["showing"])]))}}}),J=o(49010),G=o(25485),Z=o(38622),ee=o(20407),te=o(63663),oe=o(17180),le=o(40975),ae=o(93359),ne=o(91484),se=o(97491),ie=o(34854),ue=o(9341),re=o(78495),de=o(37139),ce=o(51375),pe=o(61929),me=o(71248),ve=o(66284),ge=o(60515);const be=(0,m.A)(j,[["__scopeId","data-v-ffcd5686"]]);var fe=be;f()(j,"components",{QInnerLoading:J.A,QSpinner:G.A,QInput:Z.A,QBtn:ee.A,QCard:te.A,QCardSection:oe.A,QSelect:le.A,QItem:ae.A,QItemSection:ne.A,QChip:se.A,QIcon:g.A,QPopupProxy:ie.A,QDate:ue.A,QCheckbox:re.A,QTime:de.A,QDialog:ce.A,QFile:pe.A,QCardActions:me.A,QPageContainer:ve.A}),f()(j,"directives",{ClosePopup:ge.A})},42634:function(){},64485:function(e,t,o){"use strict";o.d(t,{k:function(){return i}});var l=o(13986),a=o(76661),n=o(10810),s=o(46732);const i=(0,n.nY)("user",()=>{const e=(0,s.KR)(),t=(0,s.KR)(!1),o=async()=>{if(e.value)return e.value;try{const o=await l.A.get("/passport/getuserinfo");if(o.Data)return e.value=o.Data,t.value=!0,o.Data;window.location.href=a.A.baseURL+"/passport/login?redirect="+encodeURIComponent(window.location.pathname)}catch(o){throw console.error("获取用户信息失败:",o),e.value=null,t.value=!1,o}},n=o=>{e.value=o,t.value=!0},i=()=>{e.value=null,t.value=!1},u=()=>t.value&&null!==e.value;return{getUserInfo:o,setUserInfo:n,clearUserInfo:i,checkLoginStatus:u}})}}]);
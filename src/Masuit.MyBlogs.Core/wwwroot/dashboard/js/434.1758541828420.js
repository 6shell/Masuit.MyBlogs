(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[434],{13986:function(e,a,t){"use strict";var l=t(74413),o=t(27454),r=t.n(o),s=t(76661),i=t(57695);const n=l.A.create({baseURL:s.c.baseURL,timeout:s.c.timeOut});n.interceptors.request.use(e=>{const a=sessionStorage.getItem("access_token");if(a&&(e.headers.Authorization="Bearer "+a),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=r().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&i.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return i.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:i.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:i.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:i.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:i.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:i.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:i.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:i.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:i.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:i.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:i.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),a.A=n},42634:function(){},79241:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return P}});var l=t(74220),o=t(97700),r=t(46732),s=t(57695),i=t(13986);const n={class:"values-page"},u={class:"row q-mb-md"},c={class:"col text-right"},d={class:"text-h6 q-mb-md"},p={key:0,class:"text-center q-pa-xl text-grey-6"},v={key:1},b={class:"row items-center justify-between q-mb-md"},m={class:"col-auto"},g={class:"text-body2 text-grey-7"},k={class:"col-auto"},f=["innerHTML"],h={key:0,class:"row justify-center q-mt-md"},y={class:"text-h6"},w={class:"q-gutter-md"},C={class:"row items-center"},q={class:"col-auto"},R={key:0,class:"editor-container"},x={key:1,class:"editor-container"};var F=(0,l.pM)({__name:"values",setup(e){const a=(0,r.KR)([]),t=(0,r.KR)(!1),F=(0,r.KR)(!1),L=(0,r.KR)([{data:""}]),V=(0,r.KR)(1),A=(0,r.KR)(10),_=[{label:"5条/页",value:5},{label:"10条/页",value:10},{label:"20条/页",value:20},{label:"50条/页",value:50}],K=(0,r.KR)(!1),Q=(0,r.KR)(!1),E=(0,r.KR)({Key:"",Value:""}),M=(0,r.KR)(!1),j={autoHeightEnabled:!1,initialFrameHeight:300,initialFrameWidth:"100%",zIndex:99,toolbars:[["fullscreen","source","|","undo","redo","|","bold","italic","underline","fontborder","strikethrough","superscript","subscript","removeformat","formatmatch","autotypeset","blockquote","pasteplain","|","forecolor","backcolor","insertorderedlist","insertunorderedlist","selectall","cleardoc","|","rowspacingtop","rowspacingbottom","lineheight","|","customstyle","paragraph","fontfamily","fontsize","|","directionalityltr","directionalityrtl","indent","|","justifyleft","justifycenter","justifyright","justifyjustify","|","touppercase","tolowercase","|","link","unlink","anchor","|","imagenone","imageleft","imageright","imagecenter","|","simpleupload","insertimage","emotion","scrawl","insertvideo","music","attachment","map","gmap","insertframe","insertcode","webapp","pagebreak","template","background","|","horizontal","date","time","spechars","snapscreen","wordimage","|","inserttable","deletetable","insertparagraphbeforetable","insertrow","deleterow","insertcol","deletecol","mergecells","mergeright","mergedown","splittocells","splittorows","splittocols","charts","|","print","preview","searchreplace","drafts","help"]]},U=["browser","os","clientip","location","network"],T={toolbars:["bold","italic","strikethrough","|","title","quote","unorderedList","orderedList","task","|","codeRow","code","link","image","table","|","hr","br","|","preview","fullscreen"]},O=(0,l.EW)(()=>Math.ceil(a.value.length/A.value)),S=(0,l.EW)(()=>{const e=(V.value-1)*A.value,t=e+A.value;return a.value.slice(e,t)}),X=e=>{V.value=e},z=e=>{A.value=e,V.value=1},D=e=>e?/^[a-zA-Z]/.test(e)?U.includes(e.toLowerCase())?"不能使用系统保留变量名":!(!Q.value&&a.value.some(a=>a.Key===e))||"变量名已存在":"变量名必须以字母开头":"请输入变量名",B=async()=>{t.value=!0;try{const e=await i.A.get("/values/list");e?.Data&&Array.isArray(e.Data)?a.value=e.Data:a.value=[]}catch(e){s.oR.error("加载变量列表失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading variables:",e),a.value=[]}finally{t.value=!1}},H=()=>{E.value={Key:"",Value:""},Q.value=!1,M.value=!1,K.value=!0},I=e=>{E.value={...e},Q.value=!0,K.value=!0},P=()=>{K.value=!1},W=async()=>{const e=D(E.value.Key);if(!0===e)if(E.value.Key){F.value=!0;try{const e=await i.A.post("/values",E.value);!1!==e?.Success?(s.oR.success(e?.Message||"保存成功",{autoClose:2e3,position:"top-center"}),P(),setTimeout(()=>{B()},500)):s.oR.error(e?.Message||"保存失败",{autoClose:2e3,position:"top-center"})}catch(a){s.oR.error("保存失败",{autoClose:2e3,position:"top-center"}),console.error("Error saving variable:",a)}finally{F.value=!1}}else s.oR.warning("请输入变量名",{autoClose:2e3,position:"top-center"});else s.oR.warning(e,{autoClose:2e3,position:"top-center"})};return(0,l.sV)(()=>{B()}),(e,r)=>{const s=(0,l.g2)("q-btn"),i=(0,l.g2)("q-btn-group"),U=(0,l.g2)("q-icon"),N=(0,l.g2)("q-banner"),$=(0,l.g2)("q-chip"),G=(0,l.g2)("q-select"),J=(0,l.g2)("vxe-column"),Z=(0,l.g2)("vxe-table"),Y=(0,l.g2)("q-pagination"),ee=(0,l.g2)("q-card-section"),ae=(0,l.g2)("q-card"),te=(0,l.g2)("q-space"),le=(0,l.g2)("q-input"),oe=(0,l.g2)("q-toggle"),re=(0,l.g2)("vue-ueditor-wrap"),se=(0,l.g2)("v-md-editor"),ie=(0,l.g2)("q-card-actions"),ne=(0,l.g2)("q-dialog");return(0,l.uX)(),(0,l.CE)("div",n,[(0,l.Lk)("div",u,[r[7]||(r[7]=(0,l.Lk)("div",{class:"col text-h6"}," 系统变量管理 ",-1)),(0,l.Lk)("div",c,[(0,l.bF)(i,null,{default:(0,l.k6)(()=>[(0,l.bF)(s,{color:"primary",icon:"refresh",label:"刷新",onClick:B,loading:t.value},null,8,["loading"]),(0,l.bF)(s,{color:"positive",icon:"add",label:"添加变量",onClick:H})]),_:1})])]),(0,l.bF)(N,{class:"bg-warning text-white q-mb-md",rounded:""},{avatar:(0,l.k6)(()=>[(0,l.bF)(U,{name:"warning"})]),default:(0,l.k6)(()=>[r[8]||(r[8]=(0,l.Lk)("div",{class:"text-body2"},[(0,l.Lk)("p",{class:"q-mb-xs"},[(0,l.Lk)("strong",null,"温馨提示：")]),(0,l.Lk)("p",{class:"q-mb-xs"},"1. 变量支持关联引用，请注意不要造成循环引用！"),(0,l.Lk)("p",{class:"q-mb-xs"},"2. 关联引用层级不要太多，避免造成递归查找时的性能问题！"),(0,l.Lk)("p",{class:"q-mb-none"},"3. 请不要使用如下系统变量名作为变量名：browser(浏览器版本)、os(操作系统)、clientip(客户端ip)、location(客户端地理位置)、network(客户端网络信息)")],-1))]),_:1}),(0,l.bF)(ae,{flat:"",bordered:""},{default:(0,l.k6)(()=>[(0,l.bF)(ee,null,{default:(0,l.k6)(()=>[(0,l.Lk)("div",d,[(0,l.bF)(U,{name:"settings",class:"q-mr-sm"}),r[9]||(r[9]=(0,l.eW)(" 变量列表 ",-1)),a.value.length>0?((0,l.uX)(),(0,l.Wv)($,{key:0,color:"primary","text-color":"white",label:`共 ${a.value.length} 个变量`,class:"q-ml-sm"},null,8,["label"])):(0,l.Q3)("",!0)]),0!==a.value.length||t.value?((0,l.uX)(),(0,l.CE)("div",v,[(0,l.Lk)("div",b,[(0,l.Lk)("div",m,[(0,l.Lk)("span",g," 共 "+(0,o.v_)(a.value.length)+" 条记录，当前显示第 "+(0,o.v_)((V.value-1)*A.value+1)+" - "+(0,o.v_)(Math.min(V.value*A.value,a.value.length))+" 条 ",1)]),(0,l.Lk)("div",k,[(0,l.bF)(G,{modelValue:A.value,"onUpdate:modelValue":[r[0]||(r[0]=e=>A.value=e),z],options:_,dense:"",outlined:"",label:"每页显示",style:{"min-width":"120px"}},null,8,["modelValue"])])]),(0,l.bF)(Z,{data:S.value,border:"",stripe:""},{default:(0,l.k6)(()=>[(0,l.bF)(J,{field:"Key",title:"变量名",width:"200",filters:L.value,"filter-render":{name:"input"}},null,8,["filters"]),(0,l.bF)(J,{field:"Value",title:"变量值",filters:L.value,"filter-render":{name:"input"}},{default:(0,l.k6)(({row:e})=>[(0,l.Lk)("div",{class:"variable-value",innerHTML:e.Value},null,8,f)]),_:1},8,["filters"]),(0,l.bF)(J,{title:"操作",width:"100",align:"center",fixed:"right"},{default:(0,l.k6)(({row:e})=>[(0,l.bF)(s,{flat:"",dense:"",color:"green",icon:"edit",onClick:a=>I(e)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),O.value>1?((0,l.uX)(),(0,l.CE)("div",h,[(0,l.bF)(Y,{modelValue:V.value,"onUpdate:modelValue":[r[1]||(r[1]=e=>V.value=e),X],max:O.value,"max-pages":6,"direction-links":"","boundary-links":"",color:"primary"},null,8,["modelValue","max"])])):(0,l.Q3)("",!0)])):((0,l.uX)(),(0,l.CE)("div",p,[(0,l.bF)(U,{name:"settings_outline",size:"64px",class:"q-mb-md"}),r[10]||(r[10]=(0,l.Lk)("div",{class:"text-h6"},"暂无系统变量",-1)),r[11]||(r[11]=(0,l.Lk)("div",{class:"text-body2 q-mt-sm"},'点击上方"添加变量"按钮创建第一个变量',-1))]))]),_:1})]),_:1}),(0,l.bF)(ne,{modelValue:K.value,"onUpdate:modelValue":r[6]||(r[6]=e=>K.value=e),persistent:""},{default:(0,l.k6)(()=>[(0,l.bF)(ae,{style:{"min-width":"800px","max-width":"90vw"}},{default:(0,l.k6)(()=>[(0,l.bF)(ee,{class:"row items-center q-pb-none"},{default:(0,l.k6)(()=>[(0,l.Lk)("div",y,(0,o.v_)(Q.value?"修改变量":"添加变量"),1),(0,l.bF)(te),(0,l.bF)(s,{icon:"close",flat:"",round:"",dense:"",onClick:P})]),_:1}),(0,l.bF)(ee,null,{default:(0,l.k6)(()=>[(0,l.Lk)("div",w,[(0,l.bF)(le,{modelValue:E.value.Key,"onUpdate:modelValue":r[2]||(r[2]=e=>E.value.Key=e),label:"变量名",hint:"以字母开头，请勿使用系统变量名：browser、os、clientip、location、network",dense:"",outlined:"",required:"",disable:Q.value,rules:[D]},null,8,["modelValue","disable","rules"]),(0,l.Lk)("div",C,[r[12]||(r[12]=(0,l.Lk)("div",{class:"col-auto text-subtitle2"},"编辑器类型：",-1)),(0,l.Lk)("div",q,[(0,l.bF)(oe,{modelValue:M.value,"onUpdate:modelValue":r[3]||(r[3]=e=>M.value=e),label:M.value?"Markdown编辑器":"UEditor富文本编辑器",color:"primary"},null,8,["modelValue","label"])])]),(0,l.Lk)("div",null,[r[13]||(r[13]=(0,l.Lk)("div",{class:"text-subtitle2 q-mb-sm"},"变量值：",-1)),M.value?((0,l.uX)(),(0,l.CE)("div",x,[(0,l.bF)(se,{modelValue:E.value.Value,"onUpdate:modelValue":r[5]||(r[5]=e=>E.value.Value=e),height:"300px",placeholder:"请输入专题描述（支持 Markdown 语法）","toolbar-config":T},null,8,["modelValue"])])):((0,l.uX)(),(0,l.CE)("div",R,[(0,l.bF)(re,{modelValue:E.value.Value,"onUpdate:modelValue":r[4]||(r[4]=e=>E.value.Value=e),config:j,"editor-id":"variable-ueditor"},null,8,["modelValue"])]))])])]),_:1}),(0,l.bF)(ie,{align:"right"},{default:(0,l.k6)(()=>[(0,l.bF)(s,{flat:"",label:"取消",onClick:P}),(0,l.bF)(s,{color:"primary",label:Q.value?"保存修改":"确认添加",onClick:W,loading:F.value,disable:!E.value.Key},null,8,["label","loading","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),L=t(1317),V=t(10258),A=t(20407),_=t(4959),K=t(64503),Q=t(63663),E=t(17180),M=t(97491),j=t(40975),U=t(74183),T=t(51375),O=t(25915),S=t(38622),X=t(91343),z=t(71248),D=t(29754),B=t(22110),H=t.n(B);const I=(0,L.A)(F,[["__scopeId","data-v-293067ac"]]);var P=I;H()(F,"components",{QBtnGroup:V.A,QBtn:A.A,QBanner:_.A,QIcon:K.A,QCard:Q.A,QCardSection:E.A,QChip:M.A,QSelect:j.A,QPagination:U.A,QDialog:T.A,QSpace:O.A,QInput:S.A,QToggle:X.A,QCardActions:z.A,QTable:D.A})}}]);
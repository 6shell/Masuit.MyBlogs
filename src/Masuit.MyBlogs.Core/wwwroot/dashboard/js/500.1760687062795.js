(self["webpackChunk"]=self["webpackChunk"]||[]).push([[500],{253:function(){},2779:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return P}});var a=o(4061),r=o(7695),l=o(3986),i=o(3508),n=o.n(i);const s={class:"notice-list-page"},c={class:"row q-mb-md"},d={class:"col"},u={class:"text-right"},p={style:{height:"calc(100vh - 270px)"}},m=["href"],f=["href"],C=["innerHTML"],g={class:"text-subtitle2"},w={class:"row justify-center q-mt-md"},h={class:"q-ml-sm text-caption"};var v=(0,a.defineComponent)({__name:"list",setup(e){const t=(0,a.ref)(""),o=(0,a.ref)(),i=(0,a.ref)(!1),v=(0,a.ref)([]),V=(0,a.ref)({page:1,size:10,total:0}),N=e=>{switch(e){case 0:return"grey";case 1:return"green";case 2:return"red";default:return"grey"}},b=e=>{const t=["未生效","正常","已失效或下架"];return t[e]||"未知"},x=async()=>{i.value=!0;try{const e=await l.A.post(`/notice/getpagedata?page=${V.value.page}&size=${V.value.size}&keywords=${t.value}`);e?.Data?(v.value=e.Data,V.value.total=e.TotalCount||0):r.oR.error("获取数据失败",{autoClose:2e3,position:"top-center"})}catch(e){r.oR.error("获取数据失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading notice data:",e)}finally{i.value=!1}},y=e=>{V.value.page=e,x()},k=e=>{V.value.size=e,V.value.page=1,x()},_=async e=>{const t=await l.A.get(`/notice/delete/${e.Id}`);t?.Success?(r.oR.success(t.Message||"删除成功",{autoClose:2e3,position:"top-center"}),await x()):r.oR.error(t?.Message||"删除失败",{autoClose:2e3,position:"top-center"})},T=async e=>{const t=await l.A.get(`/notice/ChangeState/${e.Id}`);t?.Success?(r.oR.success(t.Message||"状态修改成功",{autoClose:2e3,position:"top-center"}),e.NoticeStatus=3-e.NoticeStatus):r.oR.error(t?.Message||"状态修改失败",{autoClose:2e3,position:"top-center"})};return(0,a.onMounted)(()=>{x()}),(e,r)=>{const l=(0,a.resolveComponent)("q-btn"),D=(0,a.resolveComponent)("q-btn-group"),R=(0,a.resolveComponent)("q-input"),S=(0,a.resolveComponent)("vxe-column"),A=(0,a.resolveComponent)("q-badge"),M=(0,a.resolveComponent)("q-toggle"),q=(0,a.resolveComponent)("q-tooltip"),E=(0,a.resolveComponent)("q-icon"),Y=(0,a.resolveComponent)("q-card-section"),Q=(0,a.resolveComponent)("q-card-actions"),z=(0,a.resolveComponent)("q-card"),P=(0,a.resolveComponent)("q-popup-proxy"),I=(0,a.resolveComponent)("vxe-table"),$=(0,a.resolveComponent)("q-pagination"),O=(0,a.resolveComponent)("q-select"),U=(0,a.resolveDirective)("close-popup");return(0,a.openBlock)(),(0,a.createElementBlock)("div",s,[(0,a.createVNode)(z,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Y,null,{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",c,[(0,a.createElementVNode)("div",d,[(0,a.createVNode)(D,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(l,{color:"info",icon:"refresh",label:"刷新",onClick:x,loading:i.value},null,8,["loading"]),(0,a.createVNode)(l,{color:"primary",icon:"add",label:"新建公告",to:"/notice/write"})]),_:1})]),(0,a.createElementVNode)("div",u,[(0,a.createVNode)(R,{modelValue:t.value,"onUpdate:modelValue":r[0]||(r[0]=e=>t.value=e),outlined:"",dense:"",placeholder:"全局搜索"},{append:(0,a.withCtx)(()=>[(0,a.createVNode)(l,{dense:"",color:"info",icon:"search",onClick:x,loading:i.value,label:"搜索"},null,8,["loading"])]),_:1},8,["modelValue"])])]),(0,a.createElementVNode)("div",p,[(0,a.createVNode)(I,{ref_key:"tableRef",ref:o,data:v.value,loading:i.value,stripe:"",border:"",height:"100%",class:"limited-row-height"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(S,{field:"Title",title:"标题","min-width":"200",fixed:"left"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("a",{href:`/notice/${e.Id}`,target:"_blank",class:"text-primary"},(0,a.toDisplayString)(e.Title),9,m)]),_:1}),(0,a.createVNode)(S,{field:"Content",title:"内容","min-width":"300"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("a",{href:`/notice/${e.Id}`,target:"_blank",class:"text-primary"},[(0,a.createElementVNode)("div",{class:"notice-content",innerHTML:e.Content},null,8,C)],8,f)]),_:1}),(0,a.createVNode)(S,{field:"PostDate",title:"发表时间",width:"140",sortable:""},{default:(0,a.withCtx)(({row:e})=>[(0,a.createTextVNode)((0,a.toDisplayString)((0,a.unref)(n())(e.PostDate).format("YYYY-MM-DD HH:mm")),1)]),_:1}),(0,a.createVNode)(S,{field:"ModifyDate",title:"修改时间",width:"140",sortable:""},{default:(0,a.withCtx)(({row:e})=>[(0,a.createTextVNode)((0,a.toDisplayString)((0,a.unref)(n())(e.ModifyDate).format("YYYY-MM-DD HH:mm")),1)]),_:1}),(0,a.createVNode)(S,{field:"ViewCount",title:"浏览次数",width:"100",align:"center"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.ViewCount||0),1)]),_:1}),(0,a.createVNode)(S,{field:"StartTime",title:"开始时间",width:"100"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.StartTime?(0,a.unref)(n())(e.StartTime).format("YYYY-MM-DD"):"-"),1)]),_:1}),(0,a.createVNode)(S,{field:"EndTime",title:"结束时间",width:"100"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.EndTime?(0,a.unref)(n())(e.EndTime).format("YYYY-MM-DD"):"-"),1)]),_:1}),(0,a.createVNode)(S,{field:"NoticeStatus",title:"状态",width:"110",align:"center"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(A,{color:N(e.NoticeStatus),label:b(e.NoticeStatus)},null,8,["color","label"])]),_:1}),(0,a.createVNode)(S,{title:"状态切换",width:"80",align:"center"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(M,{"model-value":1===e.NoticeStatus,"onUpdate:modelValue":t=>T(e),color:"primary",disable:i.value},null,8,["model-value","onUpdate:modelValue","disable"])]),_:1}),(0,a.createVNode)(S,{title:"操作",width:"80",align:"center",fixed:"right"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(l,{dense:"",flat:"",size:"md",color:"primary",icon:"edit",to:`/notice/write?id=${e.Id}`,disable:i.value},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(q,null,{default:(0,a.withCtx)(()=>[...r[3]||(r[3]=[(0,a.createTextVNode)("编辑",-1)])]),_:1})]),_:1},8,["to","disable"]),(0,a.createVNode)(l,{dense:"",flat:"",size:"md",color:"negative",icon:"delete",disable:i.value},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(q,null,{default:(0,a.withCtx)(()=>[...r[4]||(r[4]=[(0,a.createTextVNode)("删除",-1)])]),_:1}),(0,a.createVNode)(P,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(z,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(Y,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(E,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),(0,a.createElementVNode)("div",null,[r[7]||(r[7]=(0,a.createElementVNode)("div",{class:"text-h6"},"确认删除",-1)),(0,a.createElementVNode)("div",g,[r[5]||(r[5]=(0,a.createTextVNode)("确认删除这条公告吗？",-1)),r[6]||(r[6]=(0,a.createElementVNode)("br",null,null,-1)),(0,a.createTextVNode)((0,a.toDisplayString)(e.Title),1)])])]),_:2},1024),(0,a.createVNode)(Q,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(l,{flat:"",label:"确认",color:"negative",onClick:t=>_(e)},null,8,["onClick"]),[[U]]),(0,a.withDirectives)((0,a.createVNode)(l,{flat:"",label:"取消",color:"primary"},null,512),[[U]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["disable"])]),_:1})]),_:1},8,["data","loading"])]),(0,a.createElementVNode)("div",w,[(0,a.createVNode)($,{modelValue:V.value.page,"onUpdate:modelValue":[r[1]||(r[1]=e=>V.value.page=e),y],max:Math.ceil(V.value.total/V.value.size),"max-pages":6,"direction-links":"","boundary-numbers":""},null,8,["modelValue","max"]),(0,a.createVNode)(O,{class:"q-ml-md",modelValue:V.value.size,"onUpdate:modelValue":[r[2]||(r[2]=e=>V.value.size=e),k],options:[10,20,50,100],dense:"",outlined:"",label:"每页显示",style:{width:"80px"}},null,8,["modelValue"]),(0,a.createElementVNode)("span",h,"共 "+(0,a.toDisplayString)(V.value.total)+" 条",1)])]),_:1})]),_:1})])}}}),V=o(1317),N=o(3663),b=o(7180),x=o(7877),y=o(407),k=o(8622),_=o(2373),T=o(1343),D=o(6997),R=o(4854),S=o(4503),A=o(1248),M=o(4183),q=o(975),E=o(515),Y=o(2110),Q=o.n(Y);const z=(0,V.A)(v,[["__scopeId","data-v-1b4ab516"]]);var P=z;Q()(v,"components",{QCard:N.A,QCardSection:b.A,QBtnGroup:x.A,QBtn:y.A,QInput:k.A,QBadge:_.A,QToggle:T.A,QTooltip:D.A,QPopupProxy:R.A,QIcon:S.A,QCardActions:A.A,QPagination:M.A,QSelect:q.A}),Q()(v,"directives",{ClosePopup:E.A})},3986:function(e,t,o){"use strict";var a=o(3719),r=o.n(a),l=o(7454),i=o.n(l),n=o(6661),s=o(7695);const c=r().create({baseURL:n.c.baseURL,timeout:n.c.timeOut});c.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=i().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),c.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&s.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return s.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:s.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:s.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:s.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:s.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:s.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:s.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:s.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:s.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:s.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:s.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=c}}]);
(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[177],{13986:function(e,t,o){"use strict";var a=o(74413),l=o(27454),r=o.n(l),i=o(76661),s=o(57695);const n=a.A.create({baseURL:i.c.baseURL,timeout:i.c.timeOut});n.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=r().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&s.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return s.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:s.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:s.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:s.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:s.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:s.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:s.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:s.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:s.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:s.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:s.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=n},26948:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return I}});var a=o(74220),l=o(97700),r=o(46732),i=o(57695),s=o(13986),n=o(88828),c=o.n(n);const u={class:"notice-list-page"},d={class:"row q-mb-md"},p={class:"col"},b={class:"text-right"},g={style:{height:"calc(100vh - 240px)"}},f=["href"],m=["href"],k=["innerHTML"],v={class:"text-subtitle2"},w={class:"row justify-center q-mt-md"},h={class:"q-ml-sm text-caption"};var _=(0,a.pM)({__name:"list",setup(e){const t=(0,r.KR)(""),o=(0,r.KR)(),n=(0,r.KR)(!1),_=(0,r.KR)([]),C=(0,r.KR)({page:1,size:10,total:0}),F=e=>{switch(e){case 0:return"grey";case 1:return"green";case 2:return"red";default:return"grey"}},R=e=>{const t=["未生效","正常","已失效或下架"];return t[e]||"未知"},y=async()=>{n.value=!0;try{const e=await s.A.post(`/notice/getpagedata?page=${C.value.page}&size=${C.value.size}&keywords=${t.value}`);e?.Data?(_.value=e.Data,C.value.total=e.TotalCount||0):i.oR.error("获取数据失败",{autoClose:2e3,position:"top-center"})}catch(e){i.oR.error("获取数据失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading notice data:",e)}finally{n.value=!1}},A=e=>{C.value.page=e,y()},M=e=>{C.value.size=e,C.value.page=1,y()},q=async e=>{const t=await s.A.get(`/notice/delete/${e.Id}`);t?.Success?(i.oR.success(t.Message||"删除成功",{autoClose:2e3,position:"top-center"}),await y()):i.oR.error(t?.Message||"删除失败",{autoClose:2e3,position:"top-center"})},x=async e=>{const t=await s.A.get(`/notice/ChangeState/${e.Id}`);t?.Success?(i.oR.success(t.Message||"状态修改成功",{autoClose:2e3,position:"top-center"}),e.NoticeStatus=3-e.NoticeStatus):i.oR.error(t?.Message||"状态修改失败",{autoClose:2e3,position:"top-center"})};return(0,a.sV)(()=>{y()}),(e,i)=>{const s=(0,a.g2)("q-btn"),T=(0,a.g2)("q-btn-group"),L=(0,a.g2)("q-input"),S=(0,a.g2)("vxe-column"),D=(0,a.g2)("q-badge"),Y=(0,a.g2)("q-toggle"),V=(0,a.g2)("q-tooltip"),Q=(0,a.g2)("q-icon"),z=(0,a.g2)("q-card-section"),N=(0,a.g2)("q-card-actions"),P=(0,a.g2)("q-card"),I=(0,a.g2)("q-popup-proxy"),W=(0,a.g2)("vxe-table"),$=(0,a.g2)("q-pagination"),E=(0,a.g2)("q-select"),O=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",u,[(0,a.bF)(P,null,{default:(0,a.k6)(()=>[(0,a.bF)(z,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",d,[(0,a.Lk)("div",p,[(0,a.bF)(T,null,{default:(0,a.k6)(()=>[(0,a.bF)(s,{color:"info",icon:"refresh",label:"刷新",onClick:y,loading:n.value},null,8,["loading"]),(0,a.bF)(s,{color:"primary",icon:"add",label:"新建公告",to:"/notice/write"})]),_:1})]),(0,a.Lk)("div",b,[(0,a.bF)(L,{modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=e=>t.value=e),outlined:"",dense:"",placeholder:"全局搜索"},{append:(0,a.k6)(()=>[(0,a.bF)(s,{dense:"",color:"info",icon:"search",onClick:y,loading:n.value,label:"搜索"},null,8,["loading"])]),_:1},8,["modelValue"])])]),(0,a.Lk)("div",g,[(0,a.bF)(W,{ref_key:"tableRef",ref:o,data:_.value,loading:n.value,stripe:"",border:"",height:"100%",class:"limited-row-height"},{default:(0,a.k6)(()=>[(0,a.bF)(S,{field:"Title",title:"标题","min-width":"200",fixed:"left"},{default:(0,a.k6)(({row:e})=>[(0,a.Lk)("a",{href:`/notice/${e.Id}`,target:"_blank",class:"text-primary"},(0,l.v_)(e.Title),9,f)]),_:1}),(0,a.bF)(S,{field:"Content",title:"内容","min-width":"300"},{default:(0,a.k6)(({row:e})=>[(0,a.Lk)("a",{href:`/notice/${e.Id}`,target:"_blank",class:"text-primary"},[(0,a.Lk)("div",{class:"notice-content",innerHTML:e.Content},null,8,k)],8,m)]),_:1}),(0,a.bF)(S,{field:"PostDate",title:"发表时间",width:"140",sortable:""},{default:(0,a.k6)(({row:e})=>[(0,a.eW)((0,l.v_)((0,r.R1)(c())(e.PostDate).format("YYYY-MM-DD HH:mm")),1)]),_:1}),(0,a.bF)(S,{field:"ModifyDate",title:"修改时间",width:"140",sortable:""},{default:(0,a.k6)(({row:e})=>[(0,a.eW)((0,l.v_)((0,r.R1)(c())(e.ModifyDate).format("YYYY-MM-DD HH:mm")),1)]),_:1}),(0,a.bF)(S,{field:"ViewCount",title:"浏览次数",width:"100",align:"center"},{default:(0,a.k6)(({row:e})=>[(0,a.eW)((0,l.v_)(e.ViewCount||0),1)]),_:1}),(0,a.bF)(S,{field:"StartTime",title:"开始时间",width:"100"},{default:(0,a.k6)(({row:e})=>[(0,a.eW)((0,l.v_)(e.StartTime?(0,r.R1)(c())(e.StartTime).format("YYYY-MM-DD"):"-"),1)]),_:1}),(0,a.bF)(S,{field:"EndTime",title:"结束时间",width:"100"},{default:(0,a.k6)(({row:e})=>[(0,a.eW)((0,l.v_)(e.EndTime?(0,r.R1)(c())(e.EndTime).format("YYYY-MM-DD"):"-"),1)]),_:1}),(0,a.bF)(S,{field:"NoticeStatus",title:"状态",width:"110",align:"center"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(D,{color:F(e.NoticeStatus),label:R(e.NoticeStatus)},null,8,["color","label"])]),_:1}),(0,a.bF)(S,{title:"状态切换",width:"80",align:"center"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(Y,{"model-value":1===e.NoticeStatus,"onUpdate:modelValue":t=>x(e),color:"primary",disable:n.value},null,8,["model-value","onUpdate:modelValue","disable"])]),_:1}),(0,a.bF)(S,{title:"操作",width:"80",align:"center",fixed:"right"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(s,{dense:"",flat:"",size:"md",color:"primary",icon:"edit",to:`/notice/write?id=${e.Id}`,disable:n.value},{default:(0,a.k6)(()=>[(0,a.bF)(V,null,{default:(0,a.k6)(()=>[...i[3]||(i[3]=[(0,a.eW)("编辑",-1)])]),_:1})]),_:1},8,["to","disable"]),(0,a.bF)(s,{dense:"",flat:"",size:"md",color:"negative",icon:"delete",disable:n.value},{default:(0,a.k6)(()=>[(0,a.bF)(V,null,{default:(0,a.k6)(()=>[...i[4]||(i[4]=[(0,a.eW)("删除",-1)])]),_:1}),(0,a.bF)(I,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(()=>[(0,a.bF)(P,null,{default:(0,a.k6)(()=>[(0,a.bF)(z,{class:"row items-center"},{default:(0,a.k6)(()=>[(0,a.bF)(Q,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),(0,a.Lk)("div",null,[i[7]||(i[7]=(0,a.Lk)("div",{class:"text-h6"},"确认删除",-1)),(0,a.Lk)("div",v,[i[5]||(i[5]=(0,a.eW)("确认删除这条公告吗？",-1)),i[6]||(i[6]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)((0,l.v_)(e.Title),1)])])]),_:2},1024),(0,a.bF)(N,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bo)((0,a.bF)(s,{flat:"",label:"确认",color:"negative",onClick:t=>q(e)},null,8,["onClick"]),[[O]]),(0,a.bo)((0,a.bF)(s,{flat:"",label:"取消",color:"primary"},null,512),[[O]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["disable"])]),_:1})]),_:1},8,["data","loading"])]),(0,a.Lk)("div",w,[(0,a.bF)($,{modelValue:C.value.page,"onUpdate:modelValue":[i[1]||(i[1]=e=>C.value.page=e),A],max:Math.ceil(C.value.total/C.value.size),"max-pages":6,"direction-links":"","boundary-numbers":""},null,8,["modelValue","max"]),(0,a.bF)(E,{class:"q-ml-md",modelValue:C.value.size,"onUpdate:modelValue":[i[2]||(i[2]=e=>C.value.size=e),M],options:[10,20,50,100],dense:"",outlined:"",label:"每页显示",style:{width:"80px"}},null,8,["modelValue"]),(0,a.Lk)("span",h,"共 "+(0,l.v_)(C.value.total)+" 条",1)])]),_:1})]),_:1})])}}}),C=o(1317),F=o(63663),R=o(17180),y=o(10258),A=o(20407),M=o(38622),q=o(62373),x=o(91343),T=o(76997),L=o(34854),S=o(64503),D=o(71248),Y=o(74183),V=o(40975),Q=o(60515),z=o(22110),N=o.n(z);const P=(0,C.A)(_,[["__scopeId","data-v-6853ac7e"]]);var I=P;N()(_,"components",{QCard:F.A,QCardSection:R.A,QBtnGroup:y.A,QBtn:A.A,QInput:M.A,QBadge:q.A,QToggle:x.A,QTooltip:T.A,QPopupProxy:L.A,QIcon:S.A,QCardActions:D.A,QPagination:Y.A,QSelect:V.A}),N()(_,"directives",{ClosePopup:Q.A})},42634:function(){}}]);
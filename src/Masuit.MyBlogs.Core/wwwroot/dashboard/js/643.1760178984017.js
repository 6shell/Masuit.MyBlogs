(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[643],{253:function(){},2095:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return q}});var r=o(4061),a=o(7695),s=o(2608),l=o(3986);const n={class:"system-logs-page"},c={key:0,class:"text-center q-pa-xl"},i={key:1,class:"row q-gutter-md"},d=["title"],u={class:"text-h6"},p={class:"log-content"};var m=(0,r.defineComponent)({__name:"logs",setup(e){(0,s.A)();const t=(0,r.ref)([]),o=(0,r.ref)(null),m=(0,r.ref)(!1),v=(0,r.ref)(""),C=(0,r.ref)(""),f=(0,r.ref)(!1),h=async()=>{f.value=!0;try{const e=await l.A.get("/dashboard/GetLogfiles");e?.Success&&e.Data?t.value=e.Data:a.oR.error("获取日志文件列表失败",{autoClose:2e3,position:"top-center"})}catch(e){a.oR.error("获取日志文件列表失败",{autoClose:2e3,position:"top-center"}),console.error("Error getting log files:",e)}finally{f.value=!1}},g=async e=>{try{const t=await l.A.post("/dashboard/catlog",{filename:e});t?.Success&&t.Data?(v.value=e,C.value=t.Data,m.value=!0):a.oR.error("读取日志文件失败",{autoClose:2e3,position:"top-center"})}catch(t){a.oR.error("读取日志文件失败",{autoClose:2e3,position:"top-center"}),console.error("Error viewing log:",t)}},w=async e=>{const t=await l.A.post("/dashboard/deleteFile",{filename:e});t?.Success?(a.oR.success(t.Message||"删除成功",{autoClose:2e3,position:"top-center"}),await h()):a.oR.error(t?.Message||"删除失败",{autoClose:2e3,position:"top-center"})},k=()=>{m.value=!1,v.value="",C.value=""};return(0,r.onMounted)(()=>{h()}),(e,a)=>{const s=(0,r.resolveComponent)("q-icon"),l=(0,r.resolveComponent)("q-card-section"),f=(0,r.resolveComponent)("q-btn"),h=(0,r.resolveComponent)("q-card-actions"),b=(0,r.resolveComponent)("q-card"),N=(0,r.resolveComponent)("q-popup-proxy"),x=(0,r.resolveComponent)("q-space"),V=(0,r.resolveComponent)("q-scroll-area"),y=(0,r.resolveComponent)("q-dialog"),R=(0,r.resolveDirective)("close-popup");return(0,r.openBlock)(),(0,r.createElementBlock)("div",n,[a[5]||(a[5]=(0,r.createElementVNode)("div",{class:"text-h4 q-mb-md"},"系统日志管理",-1)),(0,r.createVNode)(b,null,{default:(0,r.withCtx)(()=>[(0,r.createVNode)(l,null,{default:(0,r.withCtx)(()=>[0===t.value.length?((0,r.openBlock)(),(0,r.createElementBlock)("div",c,[(0,r.createVNode)(s,{name:"description",size:"4rem",color:"grey-5"}),a[3]||(a[3]=(0,r.createElementVNode)("div",{class:"text-h6 text-grey-7 q-mt-md"},"暂无日志文件",-1))])):((0,r.openBlock)(),(0,r.createElementBlock)("div",i,[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(t.value,e=>((0,r.openBlock)(),(0,r.createElementBlock)("div",{key:e,class:"col-lg-2 col-md-3 col-sm-4 col-xs-6"},[(0,r.createVNode)(b,{class:(0,r.normalizeClass)(["file-card cursor-pointer",{"file-card-hover":o.value===e}]),onDblclick:t=>g(e),onMouseenter:t=>o.value=e,onMouseleave:a[1]||(a[1]=e=>o.value=null)},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(l,{class:"text-center q-pa-md relative-position"},{default:(0,r.withCtx)(()=>[(0,r.withDirectives)((0,r.createVNode)(f,{round:"",dense:"",size:"sm",color:"negative",icon:"delete",class:"delete-btn",onClick:a[0]||(a[0]=(0,r.withModifiers)(()=>{},["stop"]))},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(N,{"transition-show":"scale","transition-hide":"scale"},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(b,null,{default:(0,r.withCtx)(()=>[(0,r.createVNode)(l,{class:"row items-center"},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(s,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),a[4]||(a[4]=(0,r.createElementVNode)("div",null,[(0,r.createElementVNode)("div",{class:"text-h6"},"确认操作"),(0,r.createElementVNode)("div",{class:"text-subtitle2"},"此操作将彻底删除该日志文件，是否继续？")],-1))]),_:1}),(0,r.createVNode)(h,{align:"right"},{default:(0,r.withCtx)(()=>[(0,r.withDirectives)((0,r.createVNode)(f,{flat:"",label:"确认",color:"negative",onClick:(0,r.withModifiers)(t=>w(e),["stop"])},null,8,["onClick"]),[[R]]),(0,r.withDirectives)((0,r.createVNode)(f,{flat:"",label:"取消",color:"primary"},null,512),[[R]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1536),[[r.vShow,o.value===e]]),(0,r.createVNode)(s,{name:"description",size:"3rem",color:"primary",class:"q-mb-sm"}),(0,r.createElementVNode)("div",{class:"text-body2 text-weight-medium file-name",title:e},(0,r.toDisplayString)(e),9,d)]),_:2},1024)]),_:2},1032,["onDblclick","class","onMouseenter"])]))),128))]))]),_:1})]),_:1}),(0,r.createVNode)(y,{modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=e=>m.value=e),maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(b,null,{default:(0,r.withCtx)(()=>[(0,r.createVNode)(l,{class:"row items-center q-pb-none"},{default:(0,r.withCtx)(()=>[(0,r.createElementVNode)("div",u,(0,r.toDisplayString)(v.value),1),(0,r.createVNode)(x),(0,r.createVNode)(f,{icon:"close",flat:"",round:"",dense:"",onClick:k})]),_:1}),(0,r.createVNode)(l,{class:"q-pt-none"},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(V,{style:{height:"calc(100vh - 70px)"}},{default:(0,r.withCtx)(()=>[(0,r.createElementVNode)("pre",p,(0,r.toDisplayString)(C.value),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),v=o(1317),C=o(3663),f=o(7180),h=o(4503),g=o(407),w=o(4854),k=o(1248),b=o(1375),N=o(5915),x=o(196),V=o(515),y=o(2110),R=o.n(y);const A=(0,v.A)(m,[["__scopeId","data-v-accaee30"]]);var q=A;R()(m,"components",{QCard:C.A,QCardSection:f.A,QIcon:h.A,QBtn:g.A,QPopupProxy:w.A,QCardActions:k.A,QDialog:b.A,QSpace:N.A,QScrollArea:x.A}),R()(m,"directives",{ClosePopup:V.A})},3986:function(e,t,o){"use strict";var r=o(3719),a=o.n(r),s=o(7454),l=o.n(s),n=o(6661),c=o(7695);const i=a().create({baseURL:n.c.baseURL,timeout:n.c.timeOut});i.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=l().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&c.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return c.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:c.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:c.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:c.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:c.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:c.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:c.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:c.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:c.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:c.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:c.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=i}}]);
(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[185],{253:function(){},3986:function(e,t,o){"use strict";var r=o(3719),a=o.n(r),n=o(7454),l=o.n(n),s=o(6661),i=o(7695);const c=a().create({baseURL:s.c.baseURL,timeout:s.c.timeOut});c.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=l().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),c.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&i.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return i.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:i.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:i.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:i.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:i.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:i.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:i.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:i.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:i.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:i.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:i.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=c},5860:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return S}});var r=o(4061),a=o(3992),n=o(7695),l=o(3986);const s={class:"notice-write-page"},i={class:"row q-gutter-md items-center"},c={class:"col"},u={class:"row items-center justify-end"},d={class:"col"},p={class:"col text-right"};var m=(0,r.defineComponent)({__name:"write",setup(e){const t=(0,a.useRoute)(),o=(0,a.useRouter)(),m=(0,r.ref)(),v=(0,r.ref)(!1),f=(0,r.ref)({Title:"",Content:"",StrongAlert:!1}),C=(0,r.ref)({from:"",to:""}),V=(0,r.computed)(()=>{if(C.value.from&&C.value.to){const e=C.value.from,t=C.value.to;return`${e} - ${t}`}return""}),b=async e=>{v.value=!0;const t=await l.A.get(`/notice/get/${e}`);t?.Success&&t.Data?(f.value=t.Data,t.Data.StartTime&&t.Data.EndTime&&(C.value={from:t.Data.StartTime,to:t.Data.EndTime})):n.oR.error("获取公告数据失败",{autoClose:2e3,position:"top-center"}),v.value=!1},h=()=>{C.value={from:"",to:""},f.value.StartTime=void 0,f.value.EndTime=void 0},w=e=>{const t=new Date;t.setHours(0,0,0,0);const o=new Date(e);return o>=t},g=async()=>{if(!f.value.Title||!f.value.Content)return void n.oR.error("请填写完整信息",{autoClose:2e3,position:"top-center"});v.value=!0;const e=f.value.Id?"/notice/edit":"/notice/write";f.value.StartTime=C.value.from||void 0,f.value.EndTime=C.value.to||void 0;const t=await l.A.post(e,f.value);t?.Success?(n.oR.success(t.Message||"操作成功",{autoClose:2e3,position:"top-center"}),o.push("/notice/list")):n.oR.error(t?.Message||"操作失败",{autoClose:2e3,position:"top-center"}),v.value=!1},x=()=>{o.push("/notice/list")};(0,r.onMounted)(()=>{const e=t.query.id;e&&b(Number(e)),document.querySelector(".q-page-container").addEventListener("scroll",y)}),(0,r.onUnmounted)(()=>{N&&clearTimeout(N),document.querySelector(".q-page-container").removeEventListener("scroll",y)});let N=null,k=!1;const y=()=>{N&&clearTimeout(N),N=setTimeout(()=>{R()},100)},R=()=>{if(null==m.value?.$el)return;const e=m.value.$el.querySelector(".edui-editor-toolbarbox");if(e){const t=m.value.$el.getBoundingClientRect(),o=t.top<84&&t.bottom>300;if(o&&!k){const t=m.value.$el.offsetWidth;e.style.cssText=`\n          position: fixed !important;\n          top: 84px !important;\n          z-index: 1000 !important;\n          width: ${t}px !important;\n          transition: all 0.5s ease !important;\n        `,k=!0}else!o&&k&&(e.style.cssText="\n          position: static !important;\n          top: auto !important;\n          z-index: auto !important;\n          width: auto !important;\n          transition: all 0.5s ease !important;\n        ",k=!1)}};return(e,t)=>{const o=(0,r.resolveComponent)("q-input"),a=(0,r.resolveComponent)("vue-ueditor-wrap"),n=(0,r.resolveComponent)("q-card-section"),l=(0,r.resolveComponent)("q-card"),b=(0,r.resolveComponent)("q-icon"),N=(0,r.resolveComponent)("q-btn"),k=(0,r.resolveComponent)("q-date"),y=(0,r.resolveComponent)("q-popup-proxy"),R=(0,r.resolveComponent)("q-checkbox"),T=(0,r.resolveComponent)("q-btn-group"),A=(0,r.resolveComponent)("q-form"),q=(0,r.resolveDirective)("close-popup");return(0,r.openBlock)(),(0,r.createElementBlock)("div",s,[(0,r.createVNode)(A,{onSubmit:g},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(l,{flat:"",bordered:""},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(n,null,{default:(0,r.withCtx)(()=>[t[5]||(t[5]=(0,r.createElementVNode)("div",{class:"text-h6"},"公告标题",-1)),(0,r.createVNode)(o,{dense:"",modelValue:f.value.Title,"onUpdate:modelValue":t[0]||(t[0]=e=>f.value.Title=e),placeholder:"请输入公告标题",outlined:"",required:"",rules:[e=>!!e||"请输入公告标题"]},null,8,["modelValue","rules"]),t[6]||(t[6]=(0,r.createElementVNode)("div",{class:"text-h6"},"公告内容",-1)),(0,r.createVNode)(a,{ref_key:"editor",ref:m,modelValue:f.value.Content,"onUpdate:modelValue":t[1]||(t[1]=e=>f.value.Content=e),config:{initialFrameHeight:250}},null,8,["modelValue"])]),_:1})]),_:1}),(0,r.createVNode)(l,{flat:"",bordered:""},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(n,null,{default:(0,r.withCtx)(()=>[t[8]||(t[8]=(0,r.createElementVNode)("div",{class:"text-h6 q-mb-md"},"公告设置",-1)),(0,r.createElementVNode)("div",i,[(0,r.createElementVNode)("div",c,[(0,r.createVNode)(o,{dense:"",modelValue:V.value,"onUpdate:modelValue":t[3]||(t[3]=e=>V.value=e),label:"生效时间段",outlined:"",readonly:""},{prepend:(0,r.withCtx)(()=>[(0,r.createVNode)(b,{name:"schedule"})]),append:(0,r.withCtx)(()=>[(0,r.createVNode)(b,{name:"event",class:"cursor-pointer"},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(y,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(k,{modelValue:C.value,"onUpdate:modelValue":t[2]||(t[2]=e=>C.value=e),range:"",options:w},{default:(0,r.withCtx)(()=>[(0,r.createElementVNode)("div",u,[(0,r.withDirectives)((0,r.createVNode)(N,{label:"确定",color:"primary",flat:""},null,512),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1}),V.value?((0,r.openBlock)(),(0,r.createBlock)(N,{key:0,flat:"",round:"",dense:"",icon:"clear",onClick:(0,r.withModifiers)(h,["stop"])})):(0,r.createCommentVNode)("",!0)]),_:1},8,["modelValue"])]),(0,r.createElementVNode)("div",d,[(0,r.createVNode)(R,{modelValue:f.value.StrongAlert,"onUpdate:modelValue":t[4]||(t[4]=e=>f.value.StrongAlert=e),label:"是否弹窗显示",color:"primary"},null,8,["modelValue"])]),(0,r.createElementVNode)("div",p,[(0,r.createVNode)(T,null,{default:(0,r.withCtx)(()=>[(0,r.createVNode)(N,{type:"submit",color:"primary",icon:"send",loading:v.value,disable:!f.value.Title||!f.value.Content},{default:(0,r.withCtx)(()=>[(0,r.createTextVNode)((0,r.toDisplayString)(f.value.Id?"更新公告":"发布公告"),1)]),_:1},8,["loading","disable"]),(0,r.createVNode)(N,{color:"grey",icon:"arrow_back",onClick:x,outline:""},{default:(0,r.withCtx)(()=>[...t[7]||(t[7]=[(0,r.createTextVNode)(" 返回列表 ",-1)])]),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1})])}}}),v=o(1317),f=o(3483),C=o(3663),V=o(7180),b=o(8622),h=o(4503),w=o(4854),g=o(9341),x=o(407),N=o(8495),k=o(7877),y=o(6284),R=o(515),T=o(2110),A=o.n(T);const q=(0,v.A)(m,[["__scopeId","data-v-658f681b"]]);var S=q;A()(m,"components",{QForm:f.A,QCard:C.A,QCardSection:V.A,QInput:b.A,QIcon:h.A,QPopupProxy:w.A,QDate:g.A,QBtn:x.A,QCheckbox:N.A,QBtnGroup:k.A,QPageContainer:y.A}),A()(m,"directives",{ClosePopup:R.A})}}]);
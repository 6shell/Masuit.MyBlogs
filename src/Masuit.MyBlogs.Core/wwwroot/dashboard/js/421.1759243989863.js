(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[421],{13986:function(e,o,t){"use strict";var a=t(74413),l=t(27454),r=t.n(l),s=t(76661),n=t(57695);const i=a.A.create({baseURL:s.c.baseURL,timeout:s.c.timeOut});i.interceptors.request.use(e=>{const o=sessionStorage.getItem("access_token");if(o&&(e.headers.Authorization="Bearer "+o),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=r().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&n.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return n.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:n.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:n.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:n.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:n.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:n.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:n.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:n.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:n.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:n.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:n.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),o.A=i},27488:function(e,o,t){"use strict";t.r(o),t.d(o,{default:function(){return I}});var a=t(74220),l=t(97700),r=t(46732),s=t(57695),n=t(13986),i=t(88828),c=t.n(i);const u={class:"links-container"},d={class:"row q-mb-md"},p={class:"text-h6"},m={class:"col"},k={class:"col-4 text-right"},b={key:0,class:"text-center q-pa-xl text-grey-6"},g=["href"],f=["href"],v=["href"],w={class:"q-gutter-xs"},h={class:"text-subtitle2"},C={key:2,class:"row justify-center q-mt-md"};var y=(0,a.pM)({__name:"links",setup(e){const o=(0,r.KR)([]),t=(0,r.KR)(!1),i=(0,r.KR)(1),y=(0,r.KR)(15),R=(0,r.KR)(""),F=(0,r.KR)(),_=(0,r.KR)(new Map),U=(0,a.EW)(()=>o.value.filter(e=>e.Name?.includes(R.value)||e.Url?.includes(R.value)||e.UrlBase?.includes(R.value))),x=(0,a.EW)(()=>Math.ceil(U.value.length/y.value)),V=(0,a.EW)(()=>{const e=(i.value-1)*y.value,o=e+y.value;return U.value.slice(e,o)}),A=e=>{i.value=e},E=async()=>{t.value=!0;try{const e=await n.A.get("/links/get");e?.Success&&e.Data?o.value=e.Data:o.value=[]}catch(e){s.oR.error("加载友情链接失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading links:",e),o.value=[]}finally{t.value=!1}},q=async()=>{const e=F.value;if(e){const o={Name:"",Url:"",UrlBase:"",Id:0,Loopbacks:0,UpdateTime:c()().format("YYYY-MM-DD HH:mm:ss"),Except:!1,Recommend:!1,Status:0},{row:t}=await e.insert(o);e.setEditCell(t,"Name")}},L=async(e,o)=>{if(!e.Name||!e.Url||!e.UrlBase)return void s.oR.warning("请填写完整的链接信息",{autoClose:2e3,position:"top-center"});const t=await n.A.post("/links/save",e);t?.Success?(s.oR.success(t.Message||"修改成功",{autoClose:2e3,position:"top-center"}),o.clearEdit(),_.value.set(e.Id,{...e})):s.oR.error(t?.Message||"修改失败",{autoClose:2e3,position:"top-center"})},M=(e,o)=>{const t=_.value.get(e.Id);t&&Object.assign(e,t),o.clearEdit()},N=async e=>{const o=await n.A.post(`/links/delete/${e.Id}`);o?.Success?(s.oR.success(o.Message||"删除成功",{autoClose:2e3,position:"top-center"}),E()):s.oR.error(o?.Message||"删除失败",{autoClose:2e3,position:"top-center"})},Q=async e=>{try{s.oR.success("正在检查链接 "+e.Name,{autoClose:5e3,position:"top-center"});const o=await n.A.post("/links/check",{link:e.Url});o?.Message&&s.oR.success(o.Message,{autoClose:5e3,position:"top-center"})}catch(o){s.oR.error("检查链接失败: "+e.Name,{autoClose:2e3,position:"top-center"}),console.error("Error checking link:",o)}},W=async e=>{try{await n.A.post(`/links/ToggleWhitelist/${e.Id}`)}catch(o){e.Except=!e.Except,s.oR.error("切换白名单状态失败",{autoClose:2e3,position:"top-center"}),console.error("Error toggling whitelist:",o)}},B=async e=>{try{await n.A.post(`/links/ToggleRecommend/${e.Id}`)}catch(o){e.Recommend=!e.Recommend,s.oR.error("切换推荐状态失败",{autoClose:2e3,position:"top-center"}),console.error("Error toggling recommend:",o)}},S=async e=>{try{await n.A.post(`/links/Toggle/${e.Id}`),e.Status=1===e.Status?0:1}catch(o){s.oR.error("切换可用状态失败",{autoClose:2e3,position:"top-center"}),console.error("Error toggling status:",o)}},T=e=>c()(e).format("YYYY-MM-DD HH:mm:ss");return(0,a.sV)(()=>{E(),F.value&&F.value.$on("edit-actived",({row:e})=>{_.value.set(e.Id,{...e})})}),(e,r)=>{const s=(0,a.g2)("q-icon"),n=(0,a.g2)("q-chip"),c=(0,a.g2)("q-btn"),y=(0,a.g2)("q-btn-group"),_=(0,a.g2)("q-input"),I=(0,a.g2)("vxe-column"),K=(0,a.g2)("q-toggle"),O=(0,a.g2)("q-tooltip"),$=(0,a.g2)("q-card-section"),z=(0,a.g2)("q-card-actions"),D=(0,a.g2)("q-card"),P=(0,a.g2)("q-popup-proxy"),X=(0,a.g2)("vxe-table"),Y=(0,a.g2)("q-pagination"),j=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",u,[(0,a.Lk)("div",d,[(0,a.Lk)("div",p,[(0,a.bF)(s,{name:"link",class:"q-mr-sm"}),r[3]||(r[3]=(0,a.eW)(" 友情链接列表 ",-1)),o.value.length>0?((0,a.uX)(),(0,a.Wv)(n,{key:0,color:"primary","text-color":"white",label:`共 ${o.value.length} 个链接`,class:"q-ml-sm"},null,8,["label"])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",m,[(0,a.bF)(y,null,{default:(0,a.k6)(()=>[(0,a.bF)(c,{color:"primary",icon:"refresh",label:"刷新",onClick:E,loading:t.value},null,8,["loading"]),(0,a.bF)(c,{color:"positive",icon:"add",label:"添加链接",onClick:q})]),_:1})]),(0,a.Lk)("div",k,[(0,a.bF)(_,{autofocus:"",modelValue:R.value,"onUpdate:modelValue":r[1]||(r[1]=e=>R.value=e),dense:"",outlined:"",placeholder:"搜索名称、链接地址",debounce:"100"},{prepend:(0,a.k6)(()=>[(0,a.bF)(s,{name:"search",class:"cursor-pointer"})]),append:(0,a.k6)(()=>[R.value?((0,a.uX)(),(0,a.Wv)(s,{key:0,name:"close",class:"cursor-pointer",onClick:r[0]||(r[0]=e=>R.value="")})):(0,a.Q3)("",!0)]),_:1},8,["modelValue"])])]),(0,a.bF)(D,{flat:"",bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)($,null,{default:(0,a.k6)(()=>[0!==U.value.length||t.value?((0,a.uX)(),(0,a.Wv)(X,{key:1,ref_key:"tableRef",ref:F,data:V.value,stripe:"",border:"","show-header-overflow":"","show-overflow":"",loading:t.value,"edit-config":{trigger:"manual",mode:"row"}},{default:(0,a.k6)(()=>[(0,a.bF)(I,{field:"Name",title:"名称",width:"150",sortable:"","edit-render":{}},{default:(0,a.k6)(({row:e})=>[(0,a.Lk)("a",{href:`https://www.baidu.com/s?wd=${e.Name}`,target:"_blank",class:"text-primary text-weight-bold"},(0,l.v_)(e.Name),9,g)]),edit:(0,a.k6)(({row:e})=>[(0,a.bF)(_,{modelValue:e.Name,"onUpdate:modelValue":o=>e.Name=o,dense:"",outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),(0,a.bF)(I,{field:"Url",title:"链接地址","min-width":"200",sortable:"","edit-render":{}},{default:(0,a.k6)(({row:e})=>[(0,a.Lk)("a",{href:e.Url,target:"_blank",class:"text-primary"},(0,l.v_)(e.Url),9,f)]),edit:(0,a.k6)(({row:e})=>[(0,a.bF)(_,{modelValue:e.Url,"onUpdate:modelValue":o=>e.Url=o,dense:"",outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),(0,a.bF)(I,{field:"UrlBase",title:"主页地址","min-width":"200","edit-render":{}},{default:(0,a.k6)(({row:e})=>[(0,a.Lk)("a",{href:e.UrlBase,target:"_blank",class:"text-primary"},(0,l.v_)(e.UrlBase),9,v)]),edit:(0,a.k6)(({row:e})=>[(0,a.bF)(_,{modelValue:e.UrlBase,"onUpdate:modelValue":o=>e.UrlBase=o,dense:"",outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),(0,a.bF)(I,{field:"Loopbacks",title:"最近来源次数",width:"120",sortable:"",align:"center"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(n,{color:e.Loopbacks>0?"positive":"grey","text-color":"white",label:e.Loopbacks},null,8,["color","label"])]),_:1}),(0,a.bF)(I,{field:"UpdateTime",title:"更新时间",width:"160",sortable:""},{default:(0,a.k6)(({row:e})=>[(0,a.eW)((0,l.v_)(T(e.UpdateTime)),1)]),_:1}),(0,a.bF)(I,{field:"Except",title:"白名单",width:"80",align:"center"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(K,{modelValue:e.Except,"onUpdate:modelValue":[o=>e.Except=o,o=>W(e)],color:"positive"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),(0,a.bF)(I,{field:"Recommend",title:"推荐",width:"80",align:"center"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(K,{modelValue:e.Recommend,"onUpdate:modelValue":[o=>e.Recommend=o,o=>B(e)],color:"warning"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),(0,a.bF)(I,{field:"Status",title:"可用状态",width:"90",align:"center"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(K,{"model-value":1===e.Status,color:"primary","onUpdate:modelValue":o=>S(e)},null,8,["model-value","onUpdate:modelValue"])]),_:1}),(0,a.bF)(I,{title:"操作",width:"100",align:"center"},{default:(0,a.k6)(({row:e,$table:o})=>[(0,a.Lk)("div",w,[o.isEditByRow(e)?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.bF)(c,{color:"primary",icon:"check",size:"sm",dense:"",flat:"",onClick:t=>L(e,o)},{default:(0,a.k6)(()=>[(0,a.bF)(O,null,{default:(0,a.k6)(()=>[...r[6]||(r[6]=[(0,a.eW)("保存",-1)])]),_:1})]),_:1},8,["onClick"]),(0,a.bF)(c,{color:"grey",icon:"close",size:"sm",dense:"",flat:"",onClick:t=>M(e,o)},{default:(0,a.k6)(()=>[(0,a.bF)(O,null,{default:(0,a.k6)(()=>[...r[7]||(r[7]=[(0,a.eW)("取消",-1)])]),_:1})]),_:1},8,["onClick"])],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.bF)(c,{color:"info",icon:"edit",size:"sm",dense:"",flat:"",onClick:t=>o.setEditRow(e)},{default:(0,a.k6)(()=>[(0,a.bF)(O,null,{default:(0,a.k6)(()=>[...r[8]||(r[8]=[(0,a.eW)("编辑",-1)])]),_:1})]),_:1},8,["onClick"]),(0,a.bF)(c,{color:"negative",icon:"delete",size:"sm",dense:"",flat:""},{default:(0,a.k6)(()=>[(0,a.bF)(O,null,{default:(0,a.k6)(()=>[...r[9]||(r[9]=[(0,a.eW)("删除",-1)])]),_:1}),(0,a.bF)(P,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(()=>[(0,a.bF)(D,null,{default:(0,a.k6)(()=>[(0,a.bF)($,{class:"row items-center"},{default:(0,a.k6)(()=>[(0,a.bF)(s,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),(0,a.Lk)("div",null,[r[10]||(r[10]=(0,a.Lk)("div",{class:"text-h6"},"确认删除",-1)),(0,a.Lk)("div",h,"确认删除该友情链接 "+(0,l.v_)(e.Name)+" 吗？",1)])]),_:2},1024),(0,a.bF)(z,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bo)((0,a.bF)(c,{flat:"",label:"确认",color:"negative",onClick:o=>N(e)},null,8,["onClick"]),[[j]]),(0,a.bo)((0,a.bF)(c,{flat:"",label:"取消",color:"primary"},null,512),[[j]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,a.bF)(c,{color:"primary",icon:"link",size:"sm",dense:"",flat:"",onClick:o=>Q(e)},{default:(0,a.k6)(()=>[(0,a.bF)(O,null,{default:(0,a.k6)(()=>[...r[11]||(r[11]=[(0,a.eW)("检查链接",-1)])]),_:1})]),_:1},8,["onClick"])],64))])]),_:1})]),_:1},8,["data","loading"])):((0,a.uX)(),(0,a.CE)("div",b,[(0,a.bF)(s,{name:"link_off",size:"64px",class:"q-mb-md"}),r[4]||(r[4]=(0,a.Lk)("div",{class:"text-h6"},"暂无友情链接",-1)),r[5]||(r[5]=(0,a.Lk)("div",{class:"text-body2 q-mt-sm"},'点击上方"添加链接"按钮添加第一个友情链接',-1))])),x.value>1?((0,a.uX)(),(0,a.CE)("div",C,[(0,a.bF)(Y,{modelValue:i.value,"onUpdate:modelValue":[r[2]||(r[2]=e=>i.value=e),A],max:x.value,"max-pages":6,"direction-links":"","boundary-links":"",color:"primary"},null,8,["modelValue","max"])])):(0,a.Q3)("",!0)]),_:1})]),_:1})])}}}),R=t(1317),F=t(64503),_=t(97491),U=t(10258),x=t(20407),V=t(38622),A=t(63663),E=t(17180),q=t(91343),L=t(76997),M=t(34854),N=t(71248),Q=t(74183),W=t(60515),B=t(22110),S=t.n(B);const T=(0,R.A)(y,[["__scopeId","data-v-b948796c"]]);var I=T;S()(y,"components",{QIcon:F.A,QChip:_.A,QBtnGroup:U.A,QBtn:x.A,QInput:V.A,QCard:A.A,QCardSection:E.A,QToggle:q.A,QTooltip:L.A,QPopupProxy:M.A,QCardActions:N.A,QPagination:Q.A}),S()(y,"directives",{ClosePopup:W.A})},42634:function(){}}]);
(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[134],{253:function(){},3986:function(e,t,a){"use strict";var o=a(3719),l=a.n(o),r=a(7454),s=a.n(r),i=a(6661),d=a(7695);const c=l().create({baseURL:i.c.baseURL,timeout:i.c.timeOut});c.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=s().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),c.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&d.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return d.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:d.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:d.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:d.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:d.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:d.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:d.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:d.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:d.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:d.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:d.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=c},7773:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Z}});var o=a(4061),l=a(7695),r=a(3508),s=a.n(r),i=a(3986);const d={class:"search-analysis-container"},c={class:"row"},n={class:"col-12"},u={class:"row"},w={class:"col"},h={class:"text-right"},p={class:"q-mt-md"},m=["href"],f={class:"ip-info"},V=["href"],N={class:"region-info"},v={class:"q-mt-md flex justify-center items-center"},C={class:"q-mt-lg"},g={class:"row q-gutter-md"},x={key:0,class:"col-md"},y=["href"],k={key:1,class:"col-md"},_=["href"],b={key:2,class:"col-md"},E=["href"],q={class:"row q-gutter-md q-mt-md"},R={key:0,class:"col-md"},A=["href"],D={key:1,class:"col-md"},P=["href"],K={key:2,class:"col-md"},S=["href"];var B=(0,o.defineComponent)({__name:"index",setup(e){const t=(0,o.ref)(!1),a=(0,o.ref)(!1),r=(0,o.ref)([]),B=(0,o.ref)(""),T=(0,o.ref)({page:1,rowsPerPage:10,total:0}),M=(0,o.ref)({month:[],week:[],today:[],wish_month:[],wish_week:[],wish_today:[]}),Q=(0,o.ref)(null),I=e=>e?s()(e).format("YYYY-MM-DD HH:mm:ss"):"",$=(e,t=0)=>null===e||void 0===e?"0":Number(e).toFixed(t),O=async()=>{try{const e=await i.A.get("/search/HotKey");e?.Success&&e.Data?M.value=e.Data:l.oR.error(e?.Message||"获取热词数据失败",{autoClose:2e3,position:"top-center"})}catch(e){l.oR.error("获取热词数据失败",{autoClose:2e3,position:"top-center"})}},j=async()=>{t.value=!0;try{const e={page:T.value.page,size:T.value.rowsPerPage,search:B.value||""},t=await i.A.post("/search/SearchList",null,{params:e});t&&t.TotalCount>0?(r.value=t.Data||[],T.value.total=t.TotalCount||0):(r.value=[],T.value.total=0,t?.Message&&l.oR.warning(t.Message,{autoClose:2e3,position:"top-center"}))}catch(e){l.oR.error("加载数据失败",{autoClose:2e3,position:"top-center"}),r.value=[],T.value.total=0}finally{t.value=!1}},U=()=>{T.value.page=1,j()},z=async e=>{const t=await i.A.post("/system/AddToBlackList",{ip:e});l.oR.success(t?.Message||"已加入黑名单",{autoClose:2e3,position:"top-center"})},L=async e=>{a.value=!0;try{const t=await i.A.post(`/search/delete/${e}`);t?.Success?(l.oR.success(t.Message||"删除成功",{autoClose:2e3,position:"top-center"}),await j()):l.oR.error(t?.Message||"删除失败",{autoClose:2e3,position:"top-center"})}catch(t){l.oR.error("删除失败",{autoClose:2e3,position:"top-center"})}finally{a.value=!1}};return(0,o.onMounted)(async()=>{await O(),await j()}),(e,a)=>{const l=(0,o.resolveComponent)("q-btn"),s=(0,o.resolveComponent)("q-icon"),i=(0,o.resolveComponent)("q-input"),O=(0,o.resolveComponent)("vxe-column"),H=(0,o.resolveComponent)("q-tooltip"),Y=(0,o.resolveComponent)("q-card-section"),F=(0,o.resolveComponent)("q-card-actions"),J=(0,o.resolveComponent)("q-card"),G=(0,o.resolveComponent)("q-popup-proxy"),W=(0,o.resolveComponent)("vxe-table"),X=(0,o.resolveComponent)("q-pagination"),Z=(0,o.resolveComponent)("q-select"),ee=(0,o.resolveDirective)("close-popup");return(0,o.openBlock)(),(0,o.createElementBlock)("div",d,[(0,o.createVNode)(J,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(Y,null,{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("div",c,[(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("div",w,[(0,o.createVNode)(l,{color:"info",icon:"refresh",onClick:j,loading:t.value,class:"q-mr-md"},{default:(0,o.withCtx)(()=>[...a[3]||(a[3]=[(0,o.createTextVNode)(" 刷新 ",-1)])]),_:1},8,["loading"])]),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(i,{modelValue:B.value,"onUpdate:modelValue":[a[0]||(a[0]=e=>B.value=e),j],placeholder:"全局搜索",outlined:"",dense:"",clearable:"",class:"search-input",debounce:"500"},{prepend:(0,o.withCtx)(()=>[(0,o.createVNode)(s,{name:"search"})]),_:1},8,["modelValue"])])])])]),(0,o.createElementVNode)("div",p,[(0,o.createVNode)(W,{ref_key:"tableRef",ref:Q,data:r.value,loading:t.value,stripe:"",border:""},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(O,{field:"Keywords",title:"关键词"},{default:(0,o.withCtx)(({row:e})=>[(0,o.createElementVNode)("a",{href:`/search/${e.Keywords}`,target:"_blank",class:"keyword-link"},(0,o.toDisplayString)(e.Keywords),9,m)]),_:1}),(0,o.createVNode)(O,{field:"SearchTime",title:"搜索时间",width:"180"},{default:(0,o.withCtx)(({row:e})=>[(0,o.createTextVNode)((0,o.toDisplayString)(I(e.SearchTime)),1)]),_:1}),(0,o.createVNode)(O,{field:"ResultCount",title:"结果集数量",width:"120"}),(0,o.createVNode)(O,{field:"Elapsed",title:"搜索耗时",width:"120"},{default:(0,o.withCtx)(({row:e})=>[(0,o.createTextVNode)((0,o.toDisplayString)($(e.Elapsed,2))+" ms ",1)]),_:1}),(0,o.createVNode)(O,{field:"IP",title:"客户端IP","min-width":"200"},{default:(0,o.withCtx)(({row:e})=>[(0,o.createElementVNode)("div",f,[(0,o.createElementVNode)("a",{href:`/tools/ip?ip=${e.IP}`,target:"_blank",class:"ip-link"},(0,o.toDisplayString)(e.IP),9,V),(0,o.createElementVNode)("span",N,"("+(0,o.toDisplayString)(e.Region)+")",1),(0,o.createVNode)(l,{color:"negative",icon:"block",dense:"",flat:"",size:"sm",class:"q-ml-sm"},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(H,{class:"bg-red"},{default:(0,o.withCtx)(()=>[...a[4]||(a[4]=[(0,o.createTextVNode)("添加到黑名单",-1)])]),_:1}),(0,o.createVNode)(G,{"transition-show":"scale","transition-hide":"scale"},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(J,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(Y,{class:"row items-center"},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(s,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),a[5]||(a[5]=(0,o.createElementVNode)("div",null,[(0,o.createElementVNode)("div",{class:"text-h6"},"确认操作"),(0,o.createElementVNode)("div",{class:"text-subtitle2"},"此操作将标记该用户IP为黑名单，是否继续？")],-1))]),_:1}),(0,o.createVNode)(F,{align:"right"},{default:(0,o.withCtx)(()=>[(0,o.withDirectives)((0,o.createVNode)(l,{flat:"",label:"确认",color:"negative",onClick:t=>z(e.IP)},null,8,["onClick"]),[[ee]]),(0,o.withDirectives)((0,o.createVNode)(l,{flat:"",label:"取消",color:"primary"},null,512),[[ee]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:1}),(0,o.createVNode)(O,{title:"操作",width:"70",fixed:"right"},{default:(0,o.withCtx)(({row:e})=>[(0,o.createVNode)(l,{dense:"",flat:"",color:"negative",icon:"delete"},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(H,null,{default:(0,o.withCtx)(()=>[...a[6]||(a[6]=[(0,o.createTextVNode)("删除",-1)])]),_:1}),(0,o.createVNode)(G,{"transition-show":"scale","transition-hide":"scale"},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(J,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(Y,{class:"row items-center"},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(s,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),a[7]||(a[7]=(0,o.createElementVNode)("div",null,[(0,o.createElementVNode)("div",{class:"text-h6"},"确认删除"),(0,o.createElementVNode)("div",{class:"text-subtitle2"},"确认删除这条记录吗？")],-1))]),_:1}),(0,o.createVNode)(F,{align:"right"},{default:(0,o.withCtx)(()=>[(0,o.withDirectives)((0,o.createVNode)(l,{flat:"",label:"确认",color:"negative",onClick:t=>L(e.Id)},null,8,["onClick"]),[[ee]]),(0,o.withDirectives)((0,o.createVNode)(l,{flat:"",label:"取消",color:"primary"},null,512),[[ee]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data","loading"]),(0,o.createElementVNode)("div",v,[(0,o.createVNode)(X,{"max-pages":"6",modelValue:T.value.page,"onUpdate:modelValue":[a[1]||(a[1]=e=>T.value.page=e),j],max:Math.ceil(T.value.total/T.value.rowsPerPage),"direction-links":""},null,8,["modelValue","max"]),(0,o.createVNode)(Z,{modelValue:T.value.rowsPerPage,"onUpdate:modelValue":[a[2]||(a[2]=e=>T.value.rowsPerPage=e),U],options:[10,15,20,30,50,100,200],dense:"",outlined:"",style:{width:"80px"},class:"q-ml-md"},null,8,["modelValue"])])])]),_:1})]),_:1}),(0,o.createElementVNode)("div",C,[(0,o.createElementVNode)("div",g,[M.value.month&&M.value.month.length>0?((0,o.openBlock)(),(0,o.createElementBlock)("div",x,[(0,o.createVNode)(J,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(Y,{class:"text-center"},{default:(0,o.withCtx)(()=>[...a[8]||(a[8]=[(0,o.createElementVNode)("div",{class:"text-h6"},"月度搜索排行",-1)])]),_:1}),(0,o.createVNode)(Y,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(W,{data:M.value.month,loading:t.value,stripe:"",border:""},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(O,{type:"seq",title:"序号",width:"60"}),(0,o.createVNode)(O,{field:"Keywords",title:"关键词"},{default:(0,o.withCtx)(({row:e})=>[(0,o.createElementVNode)("a",{href:`/search/${e.Keywords}`,target:"_blank",class:"keyword-link"},(0,o.toDisplayString)(e.Keywords),9,y)]),_:1}),(0,o.createVNode)(O,{field:"Count",title:"搜索次数",width:"120"})]),_:1},8,["data","loading"])]),_:1})]),_:1})])):(0,o.createCommentVNode)("",!0),M.value.week&&M.value.week.length>0?((0,o.openBlock)(),(0,o.createElementBlock)("div",k,[(0,o.createVNode)(J,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(Y,{class:"text-center"},{default:(0,o.withCtx)(()=>[...a[9]||(a[9]=[(0,o.createElementVNode)("div",{class:"text-h6"},"本周搜索排行",-1)])]),_:1}),(0,o.createVNode)(Y,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(W,{data:M.value.week,loading:t.value,stripe:"",border:""},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(O,{type:"seq",title:"序号",width:"60"}),(0,o.createVNode)(O,{field:"Keywords",title:"关键词"},{default:(0,o.withCtx)(({row:e})=>[(0,o.createElementVNode)("a",{href:`/search/${e.Keywords}`,target:"_blank",class:"keyword-link"},(0,o.toDisplayString)(e.Keywords),9,_)]),_:1}),(0,o.createVNode)(O,{field:"Count",title:"搜索次数",width:"120"})]),_:1},8,["data","loading"])]),_:1})]),_:1})])):(0,o.createCommentVNode)("",!0),M.value.today&&M.value.today.length>0?((0,o.openBlock)(),(0,o.createElementBlock)("div",b,[(0,o.createVNode)(J,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(Y,{class:"text-center"},{default:(0,o.withCtx)(()=>[...a[10]||(a[10]=[(0,o.createElementVNode)("div",{class:"text-h6"},"今日搜索排行",-1)])]),_:1}),(0,o.createVNode)(Y,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(W,{data:M.value.today,loading:t.value,stripe:"",border:""},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(O,{type:"seq",title:"序号",width:"60"}),(0,o.createVNode)(O,{field:"Keywords",title:"关键词"},{default:(0,o.withCtx)(({row:e})=>[(0,o.createElementVNode)("a",{href:`/search/${e.Keywords}`,target:"_blank",class:"keyword-link"},(0,o.toDisplayString)(e.Keywords),9,E)]),_:1}),(0,o.createVNode)(O,{field:"Count",title:"搜索次数",width:"120"})]),_:1},8,["data","loading"])]),_:1})]),_:1})])):(0,o.createCommentVNode)("",!0)]),(0,o.createElementVNode)("div",q,[M.value.wish_month&&M.value.wish_month.length>0?((0,o.openBlock)(),(0,o.createElementBlock)("div",R,[(0,o.createVNode)(J,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(Y,{class:"text-center"},{default:(0,o.withCtx)(()=>[...a[11]||(a[11]=[(0,o.createElementVNode)("div",{class:"text-h6"},"月度搜索排行",-1),(0,o.createElementVNode)("div",{class:"text-caption text-grey-6"},"(搜索结果为0的热词)",-1)])]),_:1}),(0,o.createVNode)(Y,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(W,{data:M.value.wish_month,loading:t.value,stripe:"",border:""},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(O,{type:"seq",title:"序号",width:"60"}),(0,o.createVNode)(O,{field:"Keywords",title:"关键词"},{default:(0,o.withCtx)(({row:e})=>[(0,o.createElementVNode)("a",{href:`/search/${e.Keywords}`,target:"_blank",class:"keyword-link"},(0,o.toDisplayString)(e.Keywords),9,A)]),_:1}),(0,o.createVNode)(O,{field:"Count",title:"搜索次数",width:"120"})]),_:1},8,["data","loading"])]),_:1})]),_:1})])):(0,o.createCommentVNode)("",!0),M.value.wish_week&&M.value.wish_week.length>0?((0,o.openBlock)(),(0,o.createElementBlock)("div",D,[(0,o.createVNode)(J,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(Y,{class:"text-center"},{default:(0,o.withCtx)(()=>[...a[12]||(a[12]=[(0,o.createElementVNode)("div",{class:"text-h6"},"本周搜索排行",-1),(0,o.createElementVNode)("div",{class:"text-caption text-grey-6"},"(搜索结果为0的热词)",-1)])]),_:1}),(0,o.createVNode)(Y,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(W,{data:M.value.wish_week,loading:t.value,stripe:"",border:""},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(O,{type:"seq",title:"序号",width:"60"}),(0,o.createVNode)(O,{field:"Keywords",title:"关键词"},{default:(0,o.withCtx)(({row:e})=>[(0,o.createElementVNode)("a",{href:`/search/${e.Keywords}`,target:"_blank",class:"keyword-link"},(0,o.toDisplayString)(e.Keywords),9,P)]),_:1}),(0,o.createVNode)(O,{field:"Count",title:"搜索次数",width:"120"})]),_:1},8,["data","loading"])]),_:1})]),_:1})])):(0,o.createCommentVNode)("",!0),M.value.wish_today&&M.value.wish_today.length>0?((0,o.openBlock)(),(0,o.createElementBlock)("div",K,[(0,o.createVNode)(J,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(Y,{class:"text-center"},{default:(0,o.withCtx)(()=>[...a[13]||(a[13]=[(0,o.createElementVNode)("div",{class:"text-h6"},"今日搜索排行",-1),(0,o.createElementVNode)("div",{class:"text-caption text-grey-6"},"(搜索结果为0的热词)",-1)])]),_:1}),(0,o.createVNode)(Y,null,{default:(0,o.withCtx)(()=>[(0,o.createVNode)(W,{data:M.value.wish_today,loading:t.value,stripe:"",border:""},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(O,{type:"seq",title:"序号",width:"60"}),(0,o.createVNode)(O,{field:"Keywords",title:"关键词"},{default:(0,o.withCtx)(({row:e})=>[(0,o.createElementVNode)("a",{href:`/search/${e.Keywords}`,target:"_blank",class:"keyword-link"},(0,o.toDisplayString)(e.Keywords),9,S)]),_:1}),(0,o.createVNode)(O,{field:"Count",title:"搜索次数",width:"120"})]),_:1},8,["data","loading"])]),_:1})]),_:1})])):(0,o.createCommentVNode)("",!0)])])])}}}),T=a(1317),M=a(3663),Q=a(7180),I=a(407),$=a(8622),O=a(4503),j=a(6997),U=a(4854),z=a(1248),L=a(4183),H=a(975),Y=a(9754),F=a(1375),J=a(515),G=a(2110),W=a.n(G);const X=(0,T.A)(B,[["__scopeId","data-v-25bbc403"]]);var Z=X;W()(B,"components",{QCard:M.A,QCardSection:Q.A,QBtn:I.A,QInput:$.A,QIcon:O.A,QTooltip:j.A,QPopupProxy:U.A,QCardActions:z.A,QPagination:L.A,QSelect:H.A,QTable:Y.A,QDialog:F.A}),W()(B,"directives",{ClosePopup:J.A})}}]);
(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[470],{13986:function(e,a,o){"use strict";var t=o(74413),l=o(27454),s=o.n(l),n=o(76661),i=o(57695);const r=t.A.create({baseURL:n.c.baseURL,timeout:n.c.timeOut});r.interceptors.request.use(e=>{const a=sessionStorage.getItem("access_token");if(a&&(e.headers.Authorization="Bearer "+a),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=s().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),r.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&i.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return i.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:i.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:i.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:i.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:i.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:i.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:i.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:i.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:i.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:i.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:i.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),a.A=r},42634:function(){},61005:function(e,a,o){"use strict";o.r(a),o.d(a,{default:function(){return Y}});var t=o(74220),l=o(97700),s=o(46732),n=o(57695),i=o(88828),r=o.n(i),u=o(13986);const c={class:"donate-list-container"},d={class:"q-mt-md"},m={class:"q-mt-md flex justify-center items-center"},p={class:"text-h6"},b={class:"row justify-end q-gutter-sm"};var k=(0,t.pM)({__name:"index",setup(e){const a=(0,s.KR)(!1),o=(0,s.KR)(!1),i=(0,s.KR)(!1),k=(0,s.KR)([]),v=(0,s.KR)({page:1,rowsPerPage:10,total:0}),f=(0,s.KR)(!1),g=(0,s.KR)({Id:0,NickName:"",DonateTime:"",Amount:"",Via:"",Email:"",QQorWechat:""}),F=async()=>{a.value=!0;try{const e={page:v.value.page,size:v.value.rowsPerPage},a=await u.A.post("/donate/getpagedata",null,{params:e});a&&(k.value=a.Data||[],v.value.total=a.TotalCount||0)}catch(e){n.oR.error("加载数据失败",{autoClose:2e3,position:"top-center"})}finally{a.value=!1}},h=()=>{v.value.page=1,F()},C=(e=null)=>{e?(g.value={...e},e.DonateTime&&(g.value.DonateTime=r()(e.DonateTime).format("YYYY-MM-DD HH:mm:ss"))):g.value={Id:null,NickName:"",DonateTime:r()().format("YYYY-MM-DD HH:mm:ss"),Amount:"",Via:"",Email:"",QQorWechat:""},f.value=!0},V=()=>{f.value=!1,g.value={Id:null,NickName:"",DonateTime:"",Amount:"",Via:"",Email:"",QQorWechat:""}},w=async()=>{o.value=!0;try{const e=await u.A.post("/donate/save",g.value);e?.Success?(n.oR.success(e.Message||"保存成功",{autoClose:2e3,position:"top-center"}),V(),await F()):n.oR.error(e?.Message||"保存失败",{autoClose:2e3,position:"top-center"})}catch(e){n.oR.error("保存失败",{autoClose:2e3,position:"top-center"})}finally{o.value=!1}},A=async e=>{i.value=!0;try{const a=await u.A.post(`/donate/delete/${e}`);n.oR.success(a?.Message||"删除成功",{autoClose:2e3,position:"top-center"}),await F()}catch(a){n.oR.error("删除失败",{autoClose:2e3,position:"top-center"})}finally{i.value=!1}};return(0,t.sV)(()=>{F()}),(e,n)=>{const i=(0,t.g2)("q-btn"),u=(0,t.g2)("q-btn-group"),R=(0,t.g2)("vxe-column"),y=(0,t.g2)("q-tooltip"),Q=(0,t.g2)("q-icon"),_=(0,t.g2)("q-card-section"),D=(0,t.g2)("q-card-actions"),q=(0,t.g2)("q-card"),x=(0,t.g2)("q-popup-proxy"),T=(0,t.g2)("vxe-table"),P=(0,t.g2)("q-pagination"),M=(0,t.g2)("q-select"),N=(0,t.g2)("q-space"),Y=(0,t.g2)("q-input"),U=(0,t.g2)("q-date"),E=(0,t.g2)("q-dialog"),W=(0,t.gN)("close-popup");return(0,t.uX)(),(0,t.CE)("div",c,[(0,t.bF)(q,null,{default:(0,t.k6)(()=>[(0,t.bF)(_,null,{default:(0,t.k6)(()=>[(0,t.bF)(u,{push:""},{default:(0,t.k6)(()=>[(0,t.bF)(i,{color:"primary",icon:"add",onClick:n[0]||(n[0]=e=>C())},{default:(0,t.k6)(()=>[...n[11]||(n[11]=[(0,t.eW)(" 添加打赏记录 ",-1)])]),_:1}),(0,t.bF)(i,{color:"info",icon:"refresh",onClick:F,loading:a.value},{default:(0,t.k6)(()=>[...n[12]||(n[12]=[(0,t.eW)(" 刷新 ",-1)])]),_:1},8,["loading"])]),_:1}),(0,t.Lk)("div",d,[(0,t.bF)(T,{data:k.value,loading:a.value,stripe:"",border:""},{default:(0,t.k6)(()=>[(0,t.bF)(R,{field:"DonateTime",title:"打赏时间",width:"140",fixed:"left"},{default:(0,t.k6)(({row:e})=>[(0,t.eW)((0,l.v_)((0,s.R1)(r())(e.DonateTime).format("YYYY-MM-DD")),1)]),_:1}),(0,t.bF)(R,{field:"NickName",title:"昵称","min-width":"120"}),(0,t.bF)(R,{field:"Amount",title:"金额",width:"100"}),(0,t.bF)(R,{field:"Via",title:"打赏方式",width:"120"}),(0,t.bF)(R,{field:"Email",title:"Email","min-width":"180"}),(0,t.bF)(R,{field:"QQorWechat",title:"QQ或微信",width:"140"}),(0,t.bF)(R,{title:"操作",width:"110",fixed:"right"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(i,{dense:"",flat:"",color:"primary",icon:"edit",onClick:a=>C(e),class:"q-mr-xs"},{default:(0,t.k6)(()=>[(0,t.bF)(y,null,{default:(0,t.k6)(()=>[...n[13]||(n[13]=[(0,t.eW)("编辑",-1)])]),_:1})]),_:1},8,["onClick"]),(0,t.bF)(i,{dense:"",flat:"",color:"negative",icon:"delete"},{default:(0,t.k6)(()=>[(0,t.bF)(y,null,{default:(0,t.k6)(()=>[...n[14]||(n[14]=[(0,t.eW)("删除",-1)])]),_:1}),(0,t.bF)(x,{"transition-show":"scale","transition-hide":"scale"},{default:(0,t.k6)(()=>[(0,t.bF)(q,null,{default:(0,t.k6)(()=>[(0,t.bF)(_,{class:"row items-center"},{default:(0,t.k6)(()=>[(0,t.bF)(Q,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),n[15]||(n[15]=(0,t.Lk)("div",null,[(0,t.Lk)("div",{class:"text-h6"},"确认删除"),(0,t.Lk)("div",{class:"text-subtitle2"},"确认删除这条打赏记录吗？")],-1))]),_:1}),(0,t.bF)(D,{align:"right"},{default:(0,t.k6)(()=>[(0,t.bo)((0,t.bF)(i,{flat:"",label:"确认",color:"negative",onClick:a=>A(e.Id)},null,8,["onClick"]),[[W]]),(0,t.bo)((0,t.bF)(i,{flat:"",label:"取消",color:"primary"},null,512),[[W]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data","loading"]),(0,t.Lk)("div",m,[(0,t.bF)(P,{"max-pages":"6",modelValue:v.value.page,"onUpdate:modelValue":[n[1]||(n[1]=e=>v.value.page=e),F],max:Math.ceil(v.value.total/v.value.rowsPerPage),"direction-links":""},null,8,["modelValue","max"]),(0,t.bF)(M,{modelValue:v.value.rowsPerPage,"onUpdate:modelValue":[n[2]||(n[2]=e=>v.value.rowsPerPage=e),h],options:[10,15,20,30,50,100],dense:"",outlined:"",style:{width:"80px"},class:"q-ml-md"},null,8,["modelValue"])])])]),_:1})]),_:1}),(0,t.bF)(E,{modelValue:f.value,"onUpdate:modelValue":n[10]||(n[10]=e=>f.value=e),persistent:""},{default:(0,t.k6)(()=>[(0,t.bF)(q,{style:{"min-width":"500px"}},{default:(0,t.k6)(()=>[(0,t.bF)(_,{class:"row items-center q-pb-none"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",p,(0,l.v_)(g.value?.Id?"编辑打赏记录":"添加打赏记录"),1),(0,t.bF)(N),(0,t.bF)(i,{icon:"close",flat:"",round:"",dense:"",onClick:V})]),_:1}),(0,t.bF)(_,null,{default:(0,t.k6)(()=>[(0,t.bF)(Y,{modelValue:g.value.NickName,"onUpdate:modelValue":n[3]||(n[3]=e=>g.value.NickName=e),label:"昵称",outlined:"",rules:[e=>!!e||"请输入昵称"]},null,8,["modelValue","rules"]),(0,t.bF)(Y,{modelValue:g.value.DonateTime,"onUpdate:modelValue":n[5]||(n[5]=e=>g.value.DonateTime=e),label:"打赏时间",outlined:"",readonly:"",rules:[e=>!!e||"请选择打赏时间"]},{append:(0,t.k6)(()=>[(0,t.bF)(Q,{name:"event",class:"cursor-pointer"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,t.k6)(()=>[(0,t.bo)((0,t.bF)(U,{modelValue:g.value.DonateTime,"onUpdate:modelValue":n[4]||(n[4]=e=>g.value.DonateTime=e),mask:"YYYY-MM-DD"},null,8,["modelValue"]),[[W]])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"]),(0,t.bF)(Y,{modelValue:g.value.Amount,"onUpdate:modelValue":n[6]||(n[6]=e=>g.value.Amount=e),label:"打赏金额",outlined:"",type:"number",step:"0.01",rules:[e=>!!e||"请输入金额"]},null,8,["modelValue","rules"]),(0,t.bF)(Y,{modelValue:g.value.Via,"onUpdate:modelValue":n[7]||(n[7]=e=>g.value.Via=e),label:"打赏方式",outlined:"",rules:[e=>!!e||"请输入打赏方式"]},null,8,["modelValue","rules"]),(0,t.bF)(Y,{modelValue:g.value.Email,"onUpdate:modelValue":n[8]||(n[8]=e=>g.value.Email=e),label:"Email",outlined:"",type:"email"},null,8,["modelValue"]),(0,t.bF)(Y,{modelValue:g.value.QQorWechat,"onUpdate:modelValue":n[9]||(n[9]=e=>g.value.QQorWechat=e),label:"QQ或微信",outlined:""},null,8,["modelValue"]),(0,t.Lk)("div",b,[(0,t.bF)(i,{label:"取消",color:"grey",onClick:V}),(0,t.bF)(i,{label:"保存",type:"submit",color:"primary",loading:o.value,onClick:w},null,8,["loading"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),v=o(1317),f=o(63663),g=o(17180),F=o(10258),h=o(20407),C=o(76997),V=o(34854),w=o(64503),A=o(71248),R=o(74183),y=o(40975),Q=o(51375),_=o(25915),D=o(38622),q=o(9341),x=o(45855),T=o(60515),P=o(22110),M=o.n(P);const N=(0,v.A)(k,[["__scopeId","data-v-32d9c6d0"]]);var Y=N;M()(k,"components",{QCard:f.A,QCardSection:g.A,QBtnGroup:F.A,QBtn:h.A,QTooltip:C.A,QPopupProxy:V.A,QIcon:w.A,QCardActions:A.A,QPagination:R.A,QSelect:y.A,QDialog:Q.A,QSpace:_.A,QInput:D.A,QDate:q.A,QField:x.A}),M()(k,"directives",{ClosePopup:T.A})}}]);
(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[308],{13986:function(e,t,o){"use strict";var a=o(13719),r=o.n(a),l=o(27454),n=o.n(l),s=o(76661),i=o(57695);const c=r().create({baseURL:s.c.baseURL,timeout:s.c.timeOut});c.interceptors.request.use(e=>{const t=sessionStorage.getItem("access_token");if(t&&(e.headers.Authorization="Bearer "+t),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=n().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),c.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&i.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return i.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:i.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:i.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:i.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:i.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:i.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:i.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:i.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:i.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:i.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:i.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),t.A=c},17099:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return S}});var a=o(74061),r=o(57695),l=o(13986);const n={class:"share-page"},s={class:"q-mb-md"},i=["href"],c={class:"text-subtitle2"},u={class:"text-h6"};var d=(0,a.defineComponent)({__name:"share",setup(e){const t=(0,a.ref)(!1),o=(0,a.ref)(!1),d=(0,a.ref)([]),p=(0,a.ref)(!1),m=(0,a.ref)(!1),v=(0,a.ref)({Title:"",Link:"",Sort:0}),C=(0,a.ref)(null),f=(0,a.ref)(null),h=e=>{try{const t=new URL(e);return!!t}catch{return!1}},V=async()=>{t.value=!0;const e=await l.A.get("/share");e&&(d.value=e.Data||[],d.value.sort((e,t)=>(e.Sort||0)-(t.Sort||0))),t.value=!1},g=async e=>{const t=await l.A.delete(`/share/${e.Id}`);t?.Success?(r.oR.success(t.Message||"删除成功",{autoClose:2e3,position:"top-center"}),await V()):r.oR.error(t?.Message||"删除失败",{autoClose:2e3,position:"top-center"})},w=e=>{v.value={...e},m.value=!0,p.value=!0,(0,a.nextTick)(()=>{f.value?.focus()})},N=async()=>{if(!v.value.Title.trim())return void r.oR.error("标题不能为空",{autoClose:2e3,position:"top-center"});o.value=!0;const e=await l.A.post(m.value?"/share/update":"/share/add",v.value);e?.Success?(r.oR.success(e.Message||"保存成功",{autoClose:2e3,position:"top-center"}),b(),await V()):r.oR.error(e?.Message||"保存失败",{autoClose:2e3,position:"top-center"}),o.value=!1},b=()=>{p.value=!1,m.value=!1,v.value={Title:"",Link:"",Sort:0}};return(0,a.onMounted)(()=>{V()}),(e,r)=>{const l=(0,a.resolveComponent)("q-btn"),k=(0,a.resolveComponent)("q-btn-group"),x=(0,a.resolveComponent)("vxe-column"),R=(0,a.resolveComponent)("q-tooltip"),_=(0,a.resolveComponent)("q-icon"),y=(0,a.resolveComponent)("q-card-section"),A=(0,a.resolveComponent)("q-card-actions"),S=(0,a.resolveComponent)("q-card"),q=(0,a.resolveComponent)("q-popup-proxy"),T=(0,a.resolveComponent)("vxe-table"),L=(0,a.resolveComponent)("q-input"),Q=(0,a.resolveComponent)("q-dialog"),D=(0,a.resolveComponent)("q-spinner"),U=(0,a.resolveComponent)("q-inner-loading"),E=(0,a.resolveDirective)("close-popup");return(0,a.openBlock)(),(0,a.createElementBlock)("div",n,[(0,a.createVNode)(S,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(y,null,{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",s,[(0,a.createVNode)(k,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(l,{color:"negative",icon:"add",label:"添加分享",onClick:r[0]||(r[0]=e=>p.value=!0),loading:t.value},null,8,["loading"]),(0,a.createVNode)(l,{color:"info",icon:"refresh",label:"刷新",onClick:V,loading:t.value},null,8,["loading"])]),_:1})]),(0,a.createVNode)(T,{ref_key:"tableRef",ref:C,data:d.value,loading:t.value,stripe:"",border:"",height:"600",class:"limited-row-height"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(x,{field:"Title",title:"标题"}),(0,a.createVNode)(x,{field:"Link",title:"链接"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createElementVNode)("a",{href:e.Link,target:"_blank",class:"text-primary"},(0,a.toDisplayString)(e.Link),9,i)]),_:1}),(0,a.createVNode)(x,{field:"Sort",title:"排序",width:"70",sortable:""},{default:(0,a.withCtx)(({row:e})=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.Sort),1)]),_:1}),(0,a.createVNode)(x,{title:"操作",width:"80"},{default:(0,a.withCtx)(({row:e})=>[(0,a.createVNode)(l,{flat:"",size:"md",color:"primary",icon:"edit",dense:"",onClick:t=>w(e)},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(R,{class:"bg-primary"},{default:(0,a.withCtx)(()=>[...r[5]||(r[5]=[(0,a.createTextVNode)("编辑",-1)])]),_:1})]),_:1},8,["onClick"]),(0,a.createVNode)(l,{flat:"",size:"md",color:"negative",icon:"delete",dense:""},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(R,{class:"bg-negative"},{default:(0,a.withCtx)(()=>[...r[6]||(r[6]=[(0,a.createTextVNode)("删除",-1)])]),_:1}),(0,a.createVNode)(q,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(S,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(y,{class:"row items-center"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(_,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),(0,a.createElementVNode)("div",null,[r[7]||(r[7]=(0,a.createElementVNode)("div",{class:"text-h6"},"确认删除",-1)),(0,a.createElementVNode)("div",c,"确认删除分享【"+(0,a.toDisplayString)(e.Title)+"】吗？",1)])]),_:2},1024),(0,a.createVNode)(A,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.withDirectives)((0,a.createVNode)(l,{label:"确认",color:"negative",onClick:t=>g(e)},null,8,["onClick"]),[[E]]),(0,a.withDirectives)((0,a.createVNode)(l,{label:"取消",color:"primary"},null,512),[[E]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data","loading"])]),_:1})]),_:1}),(0,a.createVNode)(Q,{modelValue:p.value,"onUpdate:modelValue":r[4]||(r[4]=e=>p.value=e),persistent:""},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(S,{style:{"min-width":"600px"}},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(y,null,{default:(0,a.withCtx)(()=>[(0,a.createElementVNode)("div",u,(0,a.toDisplayString)(m.value?"编辑分享":"添加分享"),1)]),_:1}),(0,a.createVNode)(y,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(L,{dense:"",autogrow:"",modelValue:v.value.Title,"onUpdate:modelValue":r[1]||(r[1]=e=>v.value.Title=e),outlined:"",label:"标题",rules:[e=>!!e||"标题不能为空"],ref_key:"titleInputRef",ref:f},null,8,["modelValue","rules"]),(0,a.createVNode)(L,{dense:"",autogrow:"",modelValue:v.value.Link,"onUpdate:modelValue":r[2]||(r[2]=e=>v.value.Link=e),outlined:"",label:"URL",rules:[e=>!!e||"URL不能为空",e=>h(e)||"请输入有效的URL"]},null,8,["modelValue","rules"]),(0,a.createVNode)(L,{modelValue:v.value.Sort,"onUpdate:modelValue":r[3]||(r[3]=e=>v.value.Sort=e),modelModifiers:{number:!0},outlined:"",type:"number",label:"排序号",hint:"数字越小排序越靠前",rules:[e=>e>=0||"排序号不能为负数"]},null,8,["modelValue","rules"])]),_:1}),(0,a.createVNode)(A,{align:"right"},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(l,{label:"确定",color:"primary",onClick:N,loading:o.value},null,8,["loading"]),(0,a.createVNode)(l,{label:"取消",color:"negative",onClick:b})]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,a.createVNode)(U,{showing:t.value},{default:(0,a.withCtx)(()=>[(0,a.createVNode)(D,{color:"primary",size:"56px"})]),_:1},8,["showing"])])}}}),p=o(1317),m=o(63663),v=o(17180),C=o(10258),f=o(20407),h=o(76997),V=o(34854),g=o(64503),w=o(71248),N=o(51375),b=o(38622),k=o(49010),x=o(25485),R=o(60515),_=o(22110),y=o.n(_);const A=(0,p.A)(d,[["__scopeId","data-v-1316118c"]]);var S=A;y()(d,"components",{QCard:m.A,QCardSection:v.A,QBtnGroup:C.A,QBtn:f.A,QTooltip:h.A,QPopupProxy:V.A,QIcon:g.A,QCardActions:w.A,QDialog:N.A,QInput:b.A,QInnerLoading:k.A,QSpinner:x.A}),y()(d,"directives",{ClosePopup:R.A})},42634:function(){}}]);
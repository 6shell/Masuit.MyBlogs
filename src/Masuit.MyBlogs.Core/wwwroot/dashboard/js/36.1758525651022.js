(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[36],{13986:function(e,o,t){"use strict";var a=t(74413),s=t(27454),r=t.n(s),l=t(76661),n=t(57695);const i=a.A.create({baseURL:l.c.baseURL,timeout:l.c.timeOut});i.interceptors.request.use(e=>{const o=sessionStorage.getItem("access_token");if(o&&(e.headers.Authorization="Bearer "+o),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=r().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&n.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return n.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:n.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:n.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:n.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:n.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:n.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:n.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:n.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:n.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:n.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:n.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),o.A=i},42634:function(){},65987:function(e,o,t){"use strict";t.r(o),t.d(o,{default:function(){return $}});var a=t(74220),s=t(97700),r=t(46732),l=t(57695),n=t(75220),i=t(13986);const c={class:"merge-compare-container"},u={class:"q-mb-lg"},d={class:"q-gutter-md"},p={style:{width:"400px"}},b={class:"text-h6"},k={class:"row q-col-gutter-md"},v={class:"col-md-6 col-12"},m={key:0},g={class:"text-center q-mb-md"},f={class:"text-h6"},h=["innerHTML"],C={class:"col-md-6 col-12"},F={key:0},R={class:"text-center q-mb-md"},L={class:"text-h6"},w=["innerHTML"];var _=(0,a.pM)({__name:"compare",setup(e){const o=(0,n.rd)(),t=(0,n.lq)(),_=(0,r.KR)(!1),q=(0,r.KR)(null),y=(0,r.KR)(null),A=(0,r.KR)(""),x=async()=>{_.value=!0;try{if(A.value=t.query.id,!A.value)return void l.oR.error("缺少合并ID参数",{autoClose:2e3,position:"top-center"});const e=await i.A.get(`/merge/compare/${A.value}`);e?.Data&&(q.value=e.Data.old,y.value=e.Data.newer)}catch(e){l.oR.error("加载对比数据失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading compare data:",e)}finally{_.value=!1}},M=async()=>{_.value=!0;const e=await i.A.post(`/merge/${A.value}`);l.oR.success(e?.Message||"合并成功",{autoClose:2e3,position:"top-center"}),o.push("/posts/merge"),_.value=!1},Q=(0,r.KR)(""),T=async()=>{if(!Q.value.trim())return void l.oR.error("请填写拒绝理由！",{autoClose:2e3,position:"top-center"});_.value=!0;const e=await i.A.post(`/merge/reject/${A.value}`,{reason:Q.value});l.oR.success(e?.Message||"已拒绝合并",{autoClose:2e3,position:"top-center"}),o.push("/posts/merge"),_.value=!1},O=async()=>{_.value=!0;const e=await i.A.post(`/merge/block/${A.value}`);l.oR.success(e?.Message||"已标记为恶意修改",{autoClose:2e3,position:"top-center"}),o.push("/posts/merge"),_.value=!1};return(0,a.sV)(()=>{x()}),(e,o)=>{const t=(0,a.g2)("q-icon"),r=(0,a.g2)("q-card-section"),l=(0,a.g2)("q-btn"),n=(0,a.g2)("q-card-actions"),i=(0,a.g2)("q-card"),x=(0,a.g2)("q-popup-proxy"),E=(0,a.g2)("q-input"),P=(0,a.g2)("q-spinner"),j=(0,a.g2)("q-inner-loading"),D=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",u,[(0,a.Lk)("div",d,[(0,a.bF)(l,{color:"info",label:"接受合并",loading:_.value},{default:(0,a.k6)(()=>[(0,a.bF)(x,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(()=>[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"row items-center"},{default:(0,a.k6)(()=>[(0,a.bF)(t,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),o[1]||(o[1]=(0,a.Lk)("div",null,[(0,a.Lk)("div",{class:"text-h6"},"确认操作"),(0,a.Lk)("div",{class:"text-subtitle2"},"此操作将直接合并该修改，是否继续？")],-1))]),_:1}),(0,a.bF)(n,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bo)((0,a.bF)(l,{flat:"",label:"确认",color:"negative",onClick:M},null,512),[[D]]),(0,a.bo)((0,a.bF)(l,{flat:"",label:"取消",color:"primary"},null,512),[[D]])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"]),(0,a.bF)(l,{color:"positive",label:"编辑并合并",to:`/posts/merge/edit?id=${A.value}`},null,8,["to"]),(0,a.bF)(l,{color:"negative",label:"拒绝合并",loading:_.value},{default:(0,a.k6)(()=>[(0,a.bF)(x,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(()=>[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"row items-center"},{default:(0,a.k6)(()=>[(0,a.Lk)("div",p,[(0,a.Lk)("div",b,[(0,a.bF)(t,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),o[2]||(o[2]=(0,a.eW)("拒绝合并理由：",-1))]),(0,a.bF)(E,{dense:"",autogrow:"",outlined:"",modelValue:Q.value,"onUpdate:modelValue":o[0]||(o[0]=e=>Q.value=e),placeholder:"请填写拒绝理由"},null,8,["modelValue"])])]),_:1}),(0,a.bF)(n,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bo)((0,a.bF)(l,{flat:"",label:"确认",disabled:!Q.value,color:"negative",onClick:T},null,8,["disabled"]),[[D]]),(0,a.bo)((0,a.bF)(l,{flat:"",label:"取消",color:"primary"},null,512),[[D]])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"]),(0,a.bF)(l,{color:"warning",label:"标记为恶意修改",loading:_.value},{default:(0,a.k6)(()=>[(0,a.bF)(x,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(()=>[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"row items-center"},{default:(0,a.k6)(()=>[(0,a.bF)(t,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),o[3]||(o[3]=(0,a.Lk)("div",null,[(0,a.Lk)("div",{class:"text-h6"},"确认操作"),(0,a.Lk)("div",{class:"text-subtitle2"},"此操作将标记该修改为恶意修改，是否继续？")],-1))]),_:1}),(0,a.bF)(n,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bo)((0,a.bF)(l,{flat:"",label:"确认",color:"negative",onClick:O},null,512),[[D]]),(0,a.bo)((0,a.bF)(l,{flat:"",label:"取消",color:"primary"},null,512),[[D]])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])])]),(0,a.Lk)("div",k,[(0,a.Lk)("div",v,[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,null,{default:(0,a.k6)(()=>[o[4]||(o[4]=(0,a.Lk)("h3",{class:"text-h5 q-mb-md"},"原文：",-1)),q.value?((0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("div",g,[(0,a.Lk)("h4",f,(0,s.v_)(q.value.Title),1)]),(0,a.Lk)("div",{class:"article-content",innerHTML:q.value.Content},null,8,h)])):(0,a.Q3)("",!0)]),_:1})]),_:1})]),(0,a.Lk)("div",C,[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)(r,null,{default:(0,a.k6)(()=>[o[5]||(o[5]=(0,a.Lk)("h3",{class:"text-h5 q-mb-md"},"修改后：",-1)),y.value?((0,a.uX)(),(0,a.CE)("div",F,[(0,a.Lk)("div",R,[(0,a.Lk)("h4",L,(0,s.v_)(y.value.Title),1)]),(0,a.Lk)("div",{class:"article-content",innerHTML:y.value.Content},null,8,w)])):(0,a.Q3)("",!0)]),_:1})]),_:1})])]),(0,a.bF)(j,{showing:_.value},{default:(0,a.k6)(()=>[(0,a.bF)(P,{color:"primary",size:"100px"})]),_:1},8,["showing"])])}}}),q=t(1317),y=t(20407),A=t(34854),x=t(63663),M=t(17180),Q=t(64503),T=t(71248),O=t(38622),E=t(49010),P=t(25485),j=t(60515),D=t(22110),I=t.n(D);const S=(0,q.A)(_,[["__scopeId","data-v-68fb4316"]]);var $=S;I()(_,"components",{QBtn:y.A,QPopupProxy:A.A,QCard:x.A,QCardSection:M.A,QIcon:Q.A,QCardActions:T.A,QInput:O.A,QInnerLoading:E.A,QSpinner:P.A}),I()(_,"directives",{ClosePopup:j.A})}}]);
(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[443],{5222:function(e,o,l){"use strict";l.r(o),l.d(o,{default:function(){return $}});var a=l(74220),t=l(97700),r=l(46732),s=l(57695),n=l(13986),i=l(88828),u=l.n(i);const c={class:"links-container"},d={class:"row q-mb-md"},p={class:"text-h6"},m={class:"col"},k={class:"col-4 text-right"},b={key:0,class:"text-center q-pa-xl text-grey-6"},g=["href"],v=["href"],f=["href"],h={class:"q-gutter-xs"},w={class:"text-subtitle2"},F={key:2,class:"row justify-center q-mt-md"},C={class:"q-gutter-md"};var R=(0,a.pM)({__name:"links",setup(e){const o=(0,r.KR)([]),l=(0,r.KR)(!1),i=(0,r.KR)(!1),R=(0,r.KR)(1),y=(0,r.KR)(15),U=(0,r.KR)(""),_=(0,r.KR)(!1),V=(0,r.KR)({Id:0,Name:"",Url:"",UrlBase:"",Loopbacks:0,UpdateTime:"",Except:!1,Recommend:!1,Status:0}),x=(0,r.KR)(),q=(0,r.KR)(new Map),A=(0,a.EW)(()=>o.value.filter(e=>e.Name?.includes(U.value)||e.Url?.includes(U.value)||e.UrlBase?.includes(U.value))),E=(0,a.EW)(()=>Math.ceil(A.value.length/y.value)),L=(0,a.EW)(()=>{const e=(R.value-1)*y.value,o=e+y.value;return A.value.slice(e,o)}),N=e=>{R.value=e},B=async()=>{l.value=!0;try{const e=await n.A.get("/links/get");e?.Success&&e.Data?o.value=e.Data:o.value=[]}catch(e){s.oR.error("加载友情链接失败",{autoClose:2e3,position:"top-center"}),console.error("Error loading links:",e),o.value=[]}finally{l.value=!1}},M=()=>{V.value={Name:"",Url:"",UrlBase:"",Id:0,Loopbacks:0,UpdateTime:"",Except:!1,Recommend:!1,Status:0},_.value=!0},Q=()=>{_.value=!1},S=async()=>{if(V.value.Name&&V.value.Url&&V.value.UrlBase){i.value=!0;try{const e=await n.A.post("/links/save",V.value);e?.Success?(s.oR.success(e.Message||"保存成功",{autoClose:2e3,position:"top-center"}),Q(),B()):s.oR.error(e?.Message||"保存失败",{autoClose:2e3,position:"top-center"})}catch(e){s.oR.error("保存失败",{autoClose:2e3,position:"top-center"}),console.error("Error adding link:",e)}finally{i.value=!1}}else s.oR.warning("请填写完整的链接信息",{autoClose:2e3,position:"top-center"})},T=async(e,o)=>{const l=await n.A.post("/links/save",e);l?.Success?(s.oR.success(l.Message||"修改成功",{autoClose:2e3,position:"top-center"}),o.clearEdit(),q.value.set(e.Id,{...e})):s.oR.error(l?.Message||"修改失败",{autoClose:2e3,position:"top-center"})},W=(e,o)=>{const l=q.value.get(e.Id);l&&Object.assign(e,l),o.clearEdit()},I=async e=>{const o=await n.A.post(`/links/delete/${e.Id}`);o?.Success?(s.oR.success(o.Message||"删除成功",{autoClose:2e3,position:"top-center"}),B()):s.oR.error(o?.Message||"删除失败",{autoClose:2e3,position:"top-center"})},K=async e=>{try{s.oR.success("正在检查链接 "+e.Name,{autoClose:5e3,position:"top-center"});const o=await n.A.post("/links/check",{link:e.Url});o?.Message&&s.oR.success(o.Message,{autoClose:5e3,position:"top-center"})}catch(o){s.oR.error("检查链接失败: "+e.Name,{autoClose:2e3,position:"top-center"}),console.error("Error checking link:",o)}},O=async e=>{try{await n.A.post(`/links/ToggleWhitelist/${e.Id}`)}catch(o){e.Except=!e.Except,s.oR.error("切换白名单状态失败",{autoClose:2e3,position:"top-center"}),console.error("Error toggling whitelist:",o)}},$=async e=>{try{await n.A.post(`/links/ToggleRecommend/${e.Id}`)}catch(o){e.Recommend=!e.Recommend,s.oR.error("切换推荐状态失败",{autoClose:2e3,position:"top-center"}),console.error("Error toggling recommend:",o)}},z=async e=>{try{await n.A.post(`/links/Toggle/${e.Id}`),e.Status=1===e.Status?0:1}catch(o){s.oR.error("切换可用状态失败",{autoClose:2e3,position:"top-center"}),console.error("Error toggling status:",o)}},P=e=>u()(e).format("YYYY-MM-DD HH:mm:ss");return(0,a.sV)(()=>{B(),x.value&&x.value.$on("edit-actived",({row:e})=>{q.value.set(e.Id,{...e})})}),(e,r)=>{const s=(0,a.g2)("q-icon"),n=(0,a.g2)("q-chip"),u=(0,a.g2)("q-btn"),y=(0,a.g2)("q-btn-group"),q=(0,a.g2)("q-input"),X=(0,a.g2)("vxe-column"),j=(0,a.g2)("q-toggle"),D=(0,a.g2)("q-tooltip"),Y=(0,a.g2)("q-card-section"),H=(0,a.g2)("q-card-actions"),G=(0,a.g2)("q-card"),J=(0,a.g2)("q-popup-proxy"),Z=(0,a.g2)("vxe-table"),ee=(0,a.g2)("q-pagination"),oe=(0,a.g2)("q-space"),le=(0,a.g2)("q-dialog"),ae=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",d,[(0,a.Lk)("div",p,[(0,a.bF)(s,{name:"link",class:"q-mr-sm"}),r[7]||(r[7]=(0,a.eW)(" 友情链接列表 ",-1)),o.value.length>0?((0,a.uX)(),(0,a.Wv)(n,{key:0,color:"primary","text-color":"white",label:`共 ${o.value.length} 个链接`,class:"q-ml-sm"},null,8,["label"])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",m,[(0,a.bF)(y,null,{default:(0,a.k6)(()=>[(0,a.bF)(u,{color:"primary",icon:"refresh",label:"刷新",onClick:B,loading:l.value},null,8,["loading"]),(0,a.bF)(u,{color:"positive",icon:"add",label:"添加链接",onClick:M})]),_:1})]),(0,a.Lk)("div",k,[(0,a.bF)(q,{autofocus:"",modelValue:U.value,"onUpdate:modelValue":r[1]||(r[1]=e=>U.value=e),dense:"",outlined:"",placeholder:"搜索名称、链接地址",debounce:"100"},{prepend:(0,a.k6)(()=>[(0,a.bF)(s,{name:"search",class:"cursor-pointer"})]),append:(0,a.k6)(()=>[U.value?((0,a.uX)(),(0,a.Wv)(s,{key:0,name:"close",class:"cursor-pointer",onClick:r[0]||(r[0]=e=>U.value="")})):(0,a.Q3)("",!0)]),_:1},8,["modelValue"])])]),(0,a.bF)(G,{flat:"",bordered:""},{default:(0,a.k6)(()=>[(0,a.bF)(Y,null,{default:(0,a.k6)(()=>[0!==A.value.length||l.value?((0,a.uX)(),(0,a.Wv)(Z,{key:1,ref_key:"tableRef",ref:x,data:L.value,stripe:"",border:"","show-header-overflow":"","show-overflow":"",loading:l.value,"edit-config":{trigger:"click",mode:"row"}},{default:(0,a.k6)(()=>[(0,a.bF)(X,{field:"Name",title:"名称",width:"150",sortable:"","edit-render":{}},{default:(0,a.k6)(({row:e})=>[(0,a.Lk)("a",{href:`https://www.baidu.com/s?wd=${e.Name}`,target:"_blank",class:"text-primary text-weight-bold"},(0,t.v_)(e.Name),9,g)]),edit:(0,a.k6)(({row:e})=>[(0,a.bF)(q,{modelValue:e.Name,"onUpdate:modelValue":o=>e.Name=o,dense:"",outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),(0,a.bF)(X,{field:"Url",title:"链接地址","min-width":"200",sortable:"","edit-render":{}},{default:(0,a.k6)(({row:e})=>[(0,a.Lk)("a",{href:e.Url,target:"_blank",class:"text-primary"},(0,t.v_)(e.Url),9,v)]),edit:(0,a.k6)(({row:e})=>[(0,a.bF)(q,{modelValue:e.Url,"onUpdate:modelValue":o=>e.Url=o,dense:"",outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),(0,a.bF)(X,{field:"UrlBase",title:"主页地址","min-width":"200","edit-render":{}},{default:(0,a.k6)(({row:e})=>[(0,a.Lk)("a",{href:e.UrlBase,target:"_blank",class:"text-primary"},(0,t.v_)(e.UrlBase),9,f)]),edit:(0,a.k6)(({row:e})=>[(0,a.bF)(q,{modelValue:e.UrlBase,"onUpdate:modelValue":o=>e.UrlBase=o,dense:"",outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),(0,a.bF)(X,{field:"Loopbacks",title:"最近来源次数",width:"120",sortable:"",align:"center"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(n,{color:e.Loopbacks>0?"positive":"grey","text-color":"white",label:e.Loopbacks},null,8,["color","label"])]),_:1}),(0,a.bF)(X,{field:"UpdateTime",title:"更新时间",width:"160",sortable:""},{default:(0,a.k6)(({row:e})=>[(0,a.eW)((0,t.v_)(P(e.UpdateTime)),1)]),_:1}),(0,a.bF)(X,{field:"Except",title:"白名单",width:"80",align:"center"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(j,{modelValue:e.Except,"onUpdate:modelValue":[o=>e.Except=o,o=>O(e)],color:"positive"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),(0,a.bF)(X,{field:"Recommend",title:"推荐",width:"80",align:"center"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(j,{modelValue:e.Recommend,"onUpdate:modelValue":[o=>e.Recommend=o,o=>$(e)],color:"warning"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),(0,a.bF)(X,{field:"Status",title:"可用状态",width:"90",align:"center"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(j,{"model-value":1===e.Status,color:"primary","onUpdate:modelValue":o=>z(e)},null,8,["model-value","onUpdate:modelValue"])]),_:1}),(0,a.bF)(X,{title:"操作",width:"100",align:"center"},{default:(0,a.k6)(({row:e,$table:o})=>[(0,a.Lk)("div",h,[o.isEditByRow(e)?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.bF)(u,{color:"primary",icon:"check",size:"sm",dense:"",flat:"",onClick:l=>T(e,o)},{default:(0,a.k6)(()=>[(0,a.bF)(D,null,{default:(0,a.k6)(()=>[...r[10]||(r[10]=[(0,a.eW)("保存",-1)])]),_:1})]),_:1},8,["onClick"]),(0,a.bF)(u,{color:"grey",icon:"close",size:"sm",dense:"",flat:"",onClick:l=>W(e,o)},{default:(0,a.k6)(()=>[(0,a.bF)(D,null,{default:(0,a.k6)(()=>[...r[11]||(r[11]=[(0,a.eW)("取消",-1)])]),_:1})]),_:1},8,["onClick"])],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.bF)(u,{color:"info",icon:"edit",size:"sm",dense:"",flat:"",onClick:l=>o.setEditRow(e)},{default:(0,a.k6)(()=>[(0,a.bF)(D,null,{default:(0,a.k6)(()=>[...r[12]||(r[12]=[(0,a.eW)("编辑",-1)])]),_:1})]),_:1},8,["onClick"]),(0,a.bF)(u,{color:"negative",icon:"delete",size:"sm",dense:"",flat:""},{default:(0,a.k6)(()=>[(0,a.bF)(D,null,{default:(0,a.k6)(()=>[...r[13]||(r[13]=[(0,a.eW)("删除",-1)])]),_:1}),(0,a.bF)(J,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(()=>[(0,a.bF)(G,null,{default:(0,a.k6)(()=>[(0,a.bF)(Y,{class:"row items-center"},{default:(0,a.k6)(()=>[(0,a.bF)(s,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),(0,a.Lk)("div",null,[r[14]||(r[14]=(0,a.Lk)("div",{class:"text-h6"},"确认删除",-1)),(0,a.Lk)("div",w,"确认删除该友情链接 "+(0,t.v_)(e.Name)+" 吗？",1)])]),_:2},1024),(0,a.bF)(H,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bo)((0,a.bF)(u,{flat:"",label:"确认",color:"negative",onClick:o=>I(e)},null,8,["onClick"]),[[ae]]),(0,a.bo)((0,a.bF)(u,{flat:"",label:"取消",color:"primary"},null,512),[[ae]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,a.bF)(u,{color:"primary",icon:"link",size:"sm",dense:"",flat:"",onClick:o=>K(e)},{default:(0,a.k6)(()=>[(0,a.bF)(D,null,{default:(0,a.k6)(()=>[...r[15]||(r[15]=[(0,a.eW)("检查链接",-1)])]),_:1})]),_:1},8,["onClick"])],64))])]),_:1})]),_:1},8,["data","loading"])):((0,a.uX)(),(0,a.CE)("div",b,[(0,a.bF)(s,{name:"link_off",size:"64px",class:"q-mb-md"}),r[8]||(r[8]=(0,a.Lk)("div",{class:"text-h6"},"暂无友情链接",-1)),r[9]||(r[9]=(0,a.Lk)("div",{class:"text-body2 q-mt-sm"},'点击上方"添加链接"按钮添加第一个友情链接',-1))])),E.value>1?((0,a.uX)(),(0,a.CE)("div",F,[(0,a.bF)(ee,{modelValue:R.value,"onUpdate:modelValue":[r[2]||(r[2]=e=>R.value=e),N],max:E.value,"max-pages":6,"direction-links":"","boundary-links":"",color:"primary"},null,8,["modelValue","max"])])):(0,a.Q3)("",!0)]),_:1})]),_:1}),(0,a.bF)(le,{modelValue:_.value,"onUpdate:modelValue":r[6]||(r[6]=e=>_.value=e),persistent:""},{default:(0,a.k6)(()=>[(0,a.bF)(G,{style:{"min-width":"500px"}},{default:(0,a.k6)(()=>[(0,a.bF)(Y,{class:"row items-center q-pb-none"},{default:(0,a.k6)(()=>[r[16]||(r[16]=(0,a.Lk)("div",{class:"text-h6"},"添加友情链接",-1)),(0,a.bF)(oe),(0,a.bF)(u,{icon:"close",flat:"",round:"",dense:"",onClick:Q})]),_:1}),(0,a.bF)(Y,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",C,[(0,a.bF)(q,{modelValue:V.value.Name,"onUpdate:modelValue":r[3]||(r[3]=e=>V.value.Name=e),label:"链接名称",placeholder:"请输入链接名称",dense:"",outlined:"",required:"",rules:[e=>!!e||"请输入链接名称"]},null,8,["modelValue","rules"]),(0,a.bF)(q,{modelValue:V.value.Url,"onUpdate:modelValue":r[4]||(r[4]=e=>V.value.Url=e),label:"链接地址",placeholder:"请输入完整的链接地址",dense:"",outlined:"",required:"",rules:[e=>!!e||"请输入链接地址"]},null,8,["modelValue","rules"]),(0,a.bF)(q,{modelValue:V.value.UrlBase,"onUpdate:modelValue":r[5]||(r[5]=e=>V.value.UrlBase=e),label:"主页地址",placeholder:"请输入主页地址",dense:"",outlined:"",required:"",rules:[e=>!!e||"请输入主页地址"]},null,8,["modelValue","rules"])])]),_:1}),(0,a.bF)(H,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(u,{flat:"",label:"取消",onClick:Q}),(0,a.bF)(u,{color:"primary",label:"添加",onClick:S,loading:i.value,disable:!V.value.Name||!V.value.Url||!V.value.UrlBase},null,8,["loading","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),y=l(1317),U=l(64503),_=l(97491),V=l(10258),x=l(20407),q=l(38622),A=l(63663),E=l(17180),L=l(91343),N=l(76997),B=l(34854),M=l(71248),Q=l(74183),S=l(51375),T=l(25915),W=l(60515),I=l(22110),K=l.n(I);const O=(0,y.A)(R,[["__scopeId","data-v-b2e51d34"]]);var $=O;K()(R,"components",{QIcon:U.A,QChip:_.A,QBtnGroup:V.A,QBtn:x.A,QInput:q.A,QCard:A.A,QCardSection:E.A,QToggle:L.A,QTooltip:N.A,QPopupProxy:B.A,QCardActions:M.A,QPagination:Q.A,QDialog:S.A,QSpace:T.A}),K()(R,"directives",{ClosePopup:W.A})},13986:function(e,o,l){"use strict";var a=l(74413),t=l(27454),r=l.n(t),s=l(76661),n=l(57695);const i=a.A.create({baseURL:s.c.baseURL,timeout:s.c.timeOut});i.interceptors.request.use(e=>{const o=sessionStorage.getItem("access_token");if(o&&(e.headers.Authorization="Bearer "+o),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=r().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&n.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return n.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:n.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:n.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:n.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:n.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:n.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:n.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:n.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:n.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:n.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:n.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),o.A=i},42634:function(){}}]);
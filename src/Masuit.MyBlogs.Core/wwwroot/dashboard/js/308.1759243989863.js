(self["webpackChunkcimo"]=self["webpackChunkcimo"]||[]).push([[308],{13986:function(e,o,t){"use strict";var a=t(74413),l=t(27454),r=t.n(l),s=t(76661),n=t(57695);const i=a.A.create({baseURL:s.c.baseURL,timeout:s.c.timeOut});i.interceptors.request.use(e=>{const o=sessionStorage.getItem("access_token");if(o&&(e.headers.Authorization="Bearer "+o),e.type)switch(e.type){case"FORM-DATA":e.transformRequest=[e=>"args="+JSON.stringify(e)];break;case"FORM":e.headers["Content-Type"]="application/x-www-form-urlencoded",e.data=r().stringify(e.data);break;default:break}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>("object"==typeof e.data&&Object.keys(e.data).includes("Success")&&!0!==e.data.Success&&n.oR.error(e.data.Message||`请求失败:${e.request.responseURL}`,{autoClose:3e3,position:"top-center"}),e.data),e=>{if("ECONNABORTED"===e.code||e.message&&-1!==e.message.indexOf("timeout")||"Network Error"===e.message)return n.oR.error("网络异常",{autoClose:3e3,position:"top-center"}),Promise.reject(e);if(e.response)switch(e.response.status){case 400:n.oR.error("请求错误:"+e.response.data.Message||0,{autoClose:3e3,position:"top-center"});break;case 403:n.oR.error("拒绝访问(403)",{autoClose:3e3,position:"top-center"});break;case 404:n.oR.error("资源不存在(404)",{autoClose:3e3,position:"top-center"});break;case 408:n.oR.error("请求超时(408)",{autoClose:3e3,position:"top-center"});break;case 500:n.oR.error("服务器错误(500)",{autoClose:3e3,position:"top-center"});break;case 501:n.oR.error("服务未实现(501)",{autoClose:3e3,position:"top-center"});break;case 502:n.oR.error("网络错误(502)",{autoClose:3e3,position:"top-center"});break;case 503:n.oR.error("服务不可用(503)",{autoClose:3e3,position:"top-center"});break;case 504:n.oR.error("网络超时(504)",{autoClose:3e3,position:"top-center"});break;case 505:n.oR.error("HTTP版本不受支持(505)",{autoClose:3e3,position:"top-center"});break;default:break}return Promise.reject(e)}),o.A=i},17099:function(e,o,t){"use strict";t.r(o),t.d(o,{default:function(){return V}});var a=t(74220),l=t(97700),r=t(46732),s=t(57695),n=t(13986);const i={class:"share-page"},u={class:"q-mb-md"},c=["href"],d={class:"text-subtitle2"},p={class:"text-h6"};var b=(0,a.pM)({__name:"share",setup(e){const o=(0,r.KR)(!1),t=(0,r.KR)(!1),b=(0,r.KR)([]),k=(0,r.KR)(!1),g=(0,r.KR)(!1),f=(0,r.KR)({Title:"",Link:"",Sort:0}),v=(0,r.KR)(null),m=(0,r.KR)(null),R=e=>{try{const o=new URL(e);return!!o}catch{return!1}},F=async()=>{o.value=!0;const e=await n.A.get("/share");e&&(b.value=e.Data||[],b.value.sort((e,o)=>(e.Sort||0)-(o.Sort||0))),o.value=!1},h=async e=>{const o=await n.A.delete(`/share/${e.Id}`);o?.Success?(s.oR.success(o.Message||"删除成功",{autoClose:2e3,position:"top-center"}),await F()):s.oR.error(o?.Message||"删除失败",{autoClose:2e3,position:"top-center"})},C=e=>{f.value={...e},g.value=!0,k.value=!0,(0,a.dY)(()=>{m.value?.focus()})},_=async()=>{if(!f.value.Title.trim())return void s.oR.error("标题不能为空",{autoClose:2e3,position:"top-center"});t.value=!0;const e=await n.A.post(g.value?"/share/update":"/share/add",f.value);e?.Success?(s.oR.success(e.Message||"保存成功",{autoClose:2e3,position:"top-center"}),w(),await F()):s.oR.error(e?.Message||"保存失败",{autoClose:2e3,position:"top-center"}),t.value=!1},w=()=>{k.value=!1,g.value=!1,f.value={Title:"",Link:"",Sort:0}};return(0,a.sV)(()=>{F()}),(e,r)=>{const s=(0,a.g2)("q-btn"),n=(0,a.g2)("q-btn-group"),A=(0,a.g2)("vxe-column"),y=(0,a.g2)("q-tooltip"),L=(0,a.g2)("q-icon"),q=(0,a.g2)("q-card-section"),S=(0,a.g2)("q-card-actions"),T=(0,a.g2)("q-card"),V=(0,a.g2)("q-popup-proxy"),x=(0,a.g2)("vxe-table"),Q=(0,a.g2)("q-input"),U=(0,a.g2)("q-dialog"),M=(0,a.g2)("q-spinner"),K=(0,a.g2)("q-inner-loading"),O=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(T,null,{default:(0,a.k6)(()=>[(0,a.bF)(q,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",u,[(0,a.bF)(n,null,{default:(0,a.k6)(()=>[(0,a.bF)(s,{color:"negative",icon:"add",label:"添加分享",onClick:r[0]||(r[0]=e=>k.value=!0),loading:o.value},null,8,["loading"]),(0,a.bF)(s,{color:"info",icon:"refresh",label:"刷新",onClick:F,loading:o.value},null,8,["loading"])]),_:1})]),(0,a.bF)(x,{ref_key:"tableRef",ref:v,data:b.value,loading:o.value,stripe:"",border:"",height:"600",class:"limited-row-height"},{default:(0,a.k6)(()=>[(0,a.bF)(A,{field:"Title",title:"标题"}),(0,a.bF)(A,{field:"Link",title:"链接"},{default:(0,a.k6)(({row:e})=>[(0,a.Lk)("a",{href:e.Link,target:"_blank",class:"text-primary"},(0,l.v_)(e.Link),9,c)]),_:1}),(0,a.bF)(A,{field:"Sort",title:"排序",width:"70",sortable:""},{default:(0,a.k6)(({row:e})=>[(0,a.eW)((0,l.v_)(e.Sort),1)]),_:1}),(0,a.bF)(A,{title:"操作",width:"80"},{default:(0,a.k6)(({row:e})=>[(0,a.bF)(s,{flat:"",size:"md",color:"primary",icon:"edit",dense:"",onClick:o=>C(e)},{default:(0,a.k6)(()=>[(0,a.bF)(y,{class:"bg-primary"},{default:(0,a.k6)(()=>[...r[5]||(r[5]=[(0,a.eW)("编辑",-1)])]),_:1})]),_:1},8,["onClick"]),(0,a.bF)(s,{flat:"",size:"md",color:"negative",icon:"delete",dense:""},{default:(0,a.k6)(()=>[(0,a.bF)(y,{class:"bg-negative"},{default:(0,a.k6)(()=>[...r[6]||(r[6]=[(0,a.eW)("删除",-1)])]),_:1}),(0,a.bF)(V,{"transition-show":"scale","transition-hide":"scale"},{default:(0,a.k6)(()=>[(0,a.bF)(T,null,{default:(0,a.k6)(()=>[(0,a.bF)(q,{class:"row items-center"},{default:(0,a.k6)(()=>[(0,a.bF)(L,{name:"warning",color:"red",size:"2rem",class:"q-mr-sm"}),(0,a.Lk)("div",null,[r[7]||(r[7]=(0,a.Lk)("div",{class:"text-h6"},"确认删除",-1)),(0,a.Lk)("div",d,"确认删除分享【"+(0,l.v_)(e.Title)+"】吗？",1)])]),_:2},1024),(0,a.bF)(S,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bo)((0,a.bF)(s,{label:"确认",color:"negative",onClick:o=>h(e)},null,8,["onClick"]),[[O]]),(0,a.bo)((0,a.bF)(s,{label:"取消",color:"primary"},null,512),[[O]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data","loading"])]),_:1})]),_:1}),(0,a.bF)(U,{modelValue:k.value,"onUpdate:modelValue":r[4]||(r[4]=e=>k.value=e),persistent:""},{default:(0,a.k6)(()=>[(0,a.bF)(T,{style:{"min-width":"600px"}},{default:(0,a.k6)(()=>[(0,a.bF)(q,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",p,(0,l.v_)(g.value?"编辑分享":"添加分享"),1)]),_:1}),(0,a.bF)(q,null,{default:(0,a.k6)(()=>[(0,a.bF)(Q,{dense:"",autogrow:"",modelValue:f.value.Title,"onUpdate:modelValue":r[1]||(r[1]=e=>f.value.Title=e),outlined:"",label:"标题",rules:[e=>!!e||"标题不能为空"],ref_key:"titleInputRef",ref:m},null,8,["modelValue","rules"]),(0,a.bF)(Q,{dense:"",autogrow:"",modelValue:f.value.Link,"onUpdate:modelValue":r[2]||(r[2]=e=>f.value.Link=e),outlined:"",label:"URL",rules:[e=>!!e||"URL不能为空",e=>R(e)||"请输入有效的URL"]},null,8,["modelValue","rules"]),(0,a.bF)(Q,{modelValue:f.value.Sort,"onUpdate:modelValue":r[3]||(r[3]=e=>f.value.Sort=e),modelModifiers:{number:!0},outlined:"",type:"number",label:"排序号",hint:"数字越小排序越靠前",rules:[e=>e>=0||"排序号不能为负数"]},null,8,["modelValue","rules"])]),_:1}),(0,a.bF)(S,{align:"right"},{default:(0,a.k6)(()=>[(0,a.bF)(s,{label:"确定",color:"primary",onClick:_,loading:t.value},null,8,["loading"]),(0,a.bF)(s,{label:"取消",color:"negative",onClick:w})]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,a.bF)(K,{showing:o.value},{default:(0,a.k6)(()=>[(0,a.bF)(M,{color:"primary",size:"56px"})]),_:1},8,["showing"])])}}}),k=t(1317),g=t(63663),f=t(17180),v=t(10258),m=t(20407),R=t(76997),F=t(34854),h=t(64503),C=t(71248),_=t(51375),w=t(38622),A=t(49010),y=t(25485),L=t(60515),q=t(22110),S=t.n(q);const T=(0,k.A)(b,[["__scopeId","data-v-1316118c"]]);var V=T;S()(b,"components",{QCard:g.A,QCardSection:f.A,QBtnGroup:v.A,QBtn:m.A,QTooltip:R.A,QPopupProxy:F.A,QIcon:h.A,QCardActions:C.A,QDialog:_.A,QInput:w.A,QInnerLoading:A.A,QSpinner:y.A}),S()(b,"directives",{ClosePopup:L.A})},42634:function(){}}]);
@using Masuit.MyBlogs.Core.Infrastructure.Services.Interface
@using Masuit.Tools.Core.AspNetCore
@model Masuit.MyBlogs.Core.Models.ViewModel.HomePageViewModel
@inject IPostService PostService
<div class="animated article-list fadeIn">
  @if (Model.Posts.Data.Any()) {
    var rnd = new Random().Next(Model.Posts.CurrentCount > 2 ? 2 : 0, Model.Posts.CurrentCount);
    for (var index = 0; index < Model.Posts.CurrentCount; index++) {
      if (rnd > 2 && rnd == index && Model.ListAdvertisement != null) {
        await Html.RenderPartialAsync("_ArticleListAdvertisement", Model.ListAdvertisement);
      }

      var post = Model.Posts.Data[index];
      await Html.RenderPartialAsync("_ArticleListItem", post);
    }
  } else {
    var list = Model.PostsQueryable.OrderByRandom().Take(5).ToList();
    if (list.Any()) {
      if (Model.Posts.CurrentPage == 1) {
        <div class="page-header">
          <h3>
            Oops！抱歉~没有找到相关的文章或资源！如果您有相关的结果，您可以
            <a asp-action="Publish" asp-controller="Post" class="btn btn-info btn-lg">点击这里</a> 投稿哦！以下是一些随机推荐：
          </h3>
        </div>
      }

      PostService.SolvePostsCategory(list);
      foreach (var post in list) {
        await Html.RenderPartialAsync("_ArticleListItem", post);
      }
    }
  }
  @{ await Html.RenderPartialAsync("_Pagination", Model.PageParams); }
</div>